<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=prev href=gltf.html><link rel=next href=lib_renderproducts.html><link rel=icon href=../../../../img/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>lib - ayon-maya</title><link rel=stylesheet href=../../../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.ab4e12ef.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../css/custom.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#client.ayon_maya.api.lib class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../../index.html title=ayon-maya class="md-header__button md-logo" aria-label=ayon-maya data-md-component=logo> <img src=../../../../img/ay-symbol-blackw-full.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ayon-maya </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> lib </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ynput/ayon-maya title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../../index.html title=ayon-maya class="md-nav__button md-logo" aria-label=ayon-maya data-md-component=logo> <img src=../../../../img/ay-symbol-blackw-full.png alt=logo> </a> ayon-maya </label> <div class=md-nav__source> <a href=https://github.com/ynput/ayon-maya title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../../../license.html class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1 checked> <label class=md-nav__link for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class=md-ellipsis> client </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> client </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1 checked> <label class=md-nav__link for=__nav_3_1_1 id=__nav_3_1_1_label tabindex=0> <span class=md-ellipsis> ayon_maya </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_1_1_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1> <span class="md-nav__icon md-icon"></span> ayon_maya </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../addon.html class=md-nav__link> <span class=md-ellipsis> addon </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_1_1_2 checked> <label class=md-nav__link for=__nav_3_1_1_2 id=__nav_3_1_1_2_label tabindex=0> <span class=md-ellipsis> api </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_1_1_2_label aria-expanded=true> <label class=md-nav__title for=__nav_3_1_1_2> <span class="md-nav__icon md-icon"></span> api </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=action.html class=md-nav__link> <span class=md-ellipsis> action </span> </a> </li> <li class=md-nav__item> <a href=alembic.html class=md-nav__link> <span class=md-ellipsis> alembic </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=chasers/export_filter_properties.html class=md-nav__link> <span class=md-ellipsis> chasers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=commands.html class=md-nav__link> <span class=md-ellipsis> commands </span> </a> </li> <li class=md-nav__item> <a href=customize.html class=md-nav__link> <span class=md-ellipsis> customize </span> </a> </li> <li class=md-nav__item> <a href=fbx.html class=md-nav__link> <span class=md-ellipsis> fbx </span> </a> </li> <li class=md-nav__item> <a href=gltf.html class=md-nav__link> <span class=md-ellipsis> gltf </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> lib </span> <span class="md-nav__icon md-icon"></span> </label> <a href=lib.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> lib </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib class=md-nav__link> <span class=md-ellipsis> lib </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.CameraInstanceCreationError class=md-nav__link> <span class=md-ellipsis> CameraInstanceCreationError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.RigSetsNotExistError class=md-nav__link> <span class=md-ellipsis> RigSetsNotExistError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.delete_after class=md-nav__link> <span class=md-ellipsis> delete_after </span> </a> <nav class=md-nav aria-label=delete_after> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.delete_after--cube-deleted class=md-nav__link> <span class=md-ellipsis> cube deleted </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.apply_attributes class=md-nav__link> <span class=md-ellipsis> apply_attributes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.apply_connections class=md-nav__link> <span class=md-ellipsis> apply_connections </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.apply_shaders class=md-nav__link> <span class=md-ellipsis> apply_shaders </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.assign_look class=md-nav__link> <span class=md-ellipsis> assign_look </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.assign_look_by_version class=md-nav__link> <span class=md-ellipsis> assign_look_by_version </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.attribute_values class=md-nav__link> <span class=md-ellipsis> attribute_values </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.bake class=md-nav__link> <span class=md-ellipsis> bake </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.bake_to_world_space class=md-nav__link> <span class=md-ellipsis> bake_to_world_space </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.collect_animation_defs class=md-nav__link> <span class=md-ellipsis> collect_animation_defs </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.convert_to_maya_fps class=md-nav__link> <span class=md-ellipsis> convert_to_maya_fps </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.create_camera_instance class=md-nav__link> <span class=md-ellipsis> create_camera_instance </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.create_rig_animation_instance class=md-nav__link> <span class=md-ellipsis> create_rig_animation_instance </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.displaySmoothness class=md-nav__link> <span class=md-ellipsis> displaySmoothness </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.empty_sets class=md-nav__link> <span class=md-ellipsis> empty_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.evaluation class=md-nav__link> <span class=md-ellipsis> evaluation </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.fix_incompatible_containers class=md-nav__link> <span class=md-ellipsis> fix_incompatible_containers </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.force_shader_assignments_to_faces class=md-nav__link> <span class=md-ellipsis> force_shader_assignments_to_faces </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.generate_capture_preset class=md-nav__link> <span class=md-ellipsis> generate_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.generate_ids class=md-nav__link> <span class=md-ellipsis> generate_ids </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_all_children class=md-nav__link> <span class=md-ellipsis> get_all_children </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_attr_in_layer class=md-nav__link> <span class=md-ellipsis> get_attr_in_layer </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_attribute class=md-nav__link> <span class=md-ellipsis> get_attribute </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_capture_preset class=md-nav__link> <span class=md-ellipsis> get_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_color_management_preferences class=md-nav__link> <span class=md-ellipsis> get_color_management_preferences </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_container_members class=md-nav__link> <span class=md-ellipsis> get_container_members </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_container_transforms class=md-nav__link> <span class=md-ellipsis> get_container_transforms </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_creator_identifier class=md-nav__link> <span class=md-ellipsis> get_creator_identifier </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace class=md-nav__link> <span class=md-ellipsis> get_custom_namespace </span> </a> <nav class=md-nav aria-label=get_custom_namespace> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace--myspace_01_ class=md-nav__link> <span class=md-ellipsis> myspace_01_ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace--_01_myspace class=md-nav__link> <span class=md-ellipsis> _01_myspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace--myspace01 class=md-nav__link> <span class=md-ellipsis> myspace01 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_fps_for_current_context class=md-nav__link> <span class=md-ellipsis> get_fps_for_current_context </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_frame_range class=md-nav__link> <span class=md-ellipsis> get_frame_range </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_highest_in_hierarchy class=md-nav__link> <span class=md-ellipsis> get_highest_in_hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_id class=md-nav__link> <span class=md-ellipsis> get_id </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_id_from_sibling class=md-nav__link> <span class=md-ellipsis> get_id_from_sibling </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_id_required_nodes class=md-nav__link> <span class=md-ellipsis> get_id_required_nodes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_isolate_view_sets class=md-nav__link> <span class=md-ellipsis> get_isolate_view_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_main_window class=md-nav__link> <span class=md-ellipsis> get_main_window </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_namespace class=md-nav__link> <span class=md-ellipsis> get_namespace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_node_index_under_parent class=md-nav__link> <span class=md-ellipsis> get_node_index_under_parent </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_node_name class=md-nav__link> <span class=md-ellipsis> get_node_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_node_parent class=md-nav__link> <span class=md-ellipsis> get_node_parent </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_reference_node class=md-nav__link> <span class=md-ellipsis> get_reference_node </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_reference_node_parents class=md-nav__link> <span class=md-ellipsis> get_reference_node_parents </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_related_sets class=md-nav__link> <span class=md-ellipsis> get_related_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_representation_path_by_project class=md-nav__link> <span class=md-ellipsis> get_representation_path_by_project </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_scene_units_settings class=md-nav__link> <span class=md-ellipsis> get_scene_units_settings </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_sequence class=md-nav__link> <span class=md-ellipsis> get_sequence </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_shader_assignments_from_shapes class=md-nav__link> <span class=md-ellipsis> get_shader_assignments_from_shapes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.guess_colorspace class=md-nav__link> <span class=md-ellipsis> guess_colorspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.image_info class=md-nav__link> <span class=md-ellipsis> image_info </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.imprint class=md-nav__link> <span class=md-ellipsis> imprint </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.is_valid_reference_node class=md-nav__link> <span class=md-ellipsis> is_valid_reference_node </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.is_visible class=md-nav__link> <span class=md-ellipsis> is_visible </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.iter_parents class=md-nav__link> <span class=md-ellipsis> iter_parents </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.iter_shader_edits class=md-nav__link> <span class=md-ellipsis> iter_shader_edits </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.iter_visible_nodes_in_range class=md-nav__link> <span class=md-ellipsis> iter_visible_nodes_in_range </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.keytangent_default class=md-nav__link> <span class=md-ellipsis> keytangent_default </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.len_flattened class=md-nav__link> <span class=md-ellipsis> len_flattened </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.list_looks class=md-nav__link> <span class=md-ellipsis> list_looks </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.load_capture_preset class=md-nav__link> <span class=md-ellipsis> load_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattr class=md-nav__link> <span class=md-ellipsis> lsattr </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattrs class=md-nav__link> <span class=md-ellipsis> lsattrs </span> </a> <nav class=md-nav aria-label=lsattrs> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattrs--return-nodes-with-an-age-of-five class=md-nav__link> <span class=md-ellipsis> Return nodes with an age of five. </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattrs--return-nodes-with-both-age-and-color-of-five-and-blue class=md-nav__link> <span class=md-ellipsis> Return nodes with both age and color of five and blue. </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.maintained_selection class=md-nav__link> <span class=md-ellipsis> maintained_selection </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.maintained_selection_api class=md-nav__link> <span class=md-ellipsis> maintained_selection_api </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.material_loading_mode class=md-nav__link> <span class=md-ellipsis> material_loading_mode </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.matrix_equals class=md-nav__link> <span class=md-ellipsis> matrix_equals </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.namespaced class=md-nav__link> <span class=md-ellipsis> namespaced </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.no_display_layers class=md-nav__link> <span class=md-ellipsis> no_display_layers </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.no_undo class=md-nav__link> <span class=md-ellipsis> no_undo </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.nodetype_exists class=md-nav__link> <span class=md-ellipsis> nodetype_exists </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.pairwise class=md-nav__link> <span class=md-ellipsis> pairwise </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.panel_camera class=md-nav__link> <span class=md-ellipsis> panel_camera </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.parent_nodes class=md-nav__link> <span class=md-ellipsis> parent_nodes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.polyConstraint class=md-nav__link> <span class=md-ellipsis> polyConstraint </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.prompt_reset_context class=md-nav__link> <span class=md-ellipsis> prompt_reset_context </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.read class=md-nav__link> <span class=md-ellipsis> read </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reload_all_udim_tile_previews class=md-nav__link> <span class=md-ellipsis> reload_all_udim_tile_previews </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.remove_other_uv_sets class=md-nav__link> <span class=md-ellipsis> remove_other_uv_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.render_capture_preset class=md-nav__link> <span class=md-ellipsis> render_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.renderlayer class=md-nav__link> <span class=md-ellipsis> renderlayer </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reset_frame_range class=md-nav__link> <span class=md-ellipsis> reset_frame_range </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reset_polySelectConstraint class=md-nav__link> <span class=md-ellipsis> reset_polySelectConstraint </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reset_scene_resolution class=md-nav__link> <span class=md-ellipsis> reset_scene_resolution </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.search_textures class=md-nav__link> <span class=md-ellipsis> search_textures </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_attribute class=md-nav__link> <span class=md-ellipsis> set_attribute </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_colorspace class=md-nav__link> <span class=md-ellipsis> set_colorspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_context_settings class=md-nav__link> <span class=md-ellipsis> set_context_settings </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_id class=md-nav__link> <span class=md-ellipsis> set_id </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_scene_fps class=md-nav__link> <span class=md-ellipsis> set_scene_fps </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_scene_resolution class=md-nav__link> <span class=md-ellipsis> set_scene_resolution </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_scene_units class=md-nav__link> <span class=md-ellipsis> set_scene_units </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.shader class=md-nav__link> <span class=md-ellipsis> shader </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.strip_namespace class=md-nav__link> <span class=md-ellipsis> strip_namespace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.suspended_refresh class=md-nav__link> <span class=md-ellipsis> suspended_refresh </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.tool class=md-nav__link> <span class=md-ellipsis> tool </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.undo_chunk class=md-nav__link> <span class=md-ellipsis> undo_chunk </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace class=md-nav__link> <span class=md-ellipsis> unique_namespace </span> </a> <nav class=md-nav aria-label=unique_namespace> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace--bar01 class=md-nav__link> <span class=md-ellipsis> bar01 </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace--hello01 class=md-nav__link> <span class=md-ellipsis> :hello01 </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace--bar01_ns class=md-nav__link> <span class=md-ellipsis> bar01_NS: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unlocked class=md-nav__link> <span class=md-ellipsis> unlocked </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.update_content_on_context_change class=md-nav__link> <span class=md-ellipsis> update_content_on_context_change </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.validate_fps class=md-nav__link> <span class=md-ellipsis> validate_fps </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.validate_scene_units class=md-nav__link> <span class=md-ellipsis> validate_scene_units </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.viewport_default_options class=md-nav__link> <span class=md-ellipsis> viewport_default_options </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.write_xgen_file class=md-nav__link> <span class=md-ellipsis> write_xgen_file </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=lib_renderproducts.html class=md-nav__link> <span class=md-ellipsis> lib_renderproducts </span> </a> </li> <li class=md-nav__item> <a href=lib_rendersettings.html class=md-nav__link> <span class=md-ellipsis> lib_rendersettings </span> </a> </li> <li class=md-nav__item> <a href=lib_rendersetup.html class=md-nav__link> <span class=md-ellipsis> lib_rendersetup </span> </a> </li> <li class=md-nav__item> <a href=menu.html class=md-nav__link> <span class=md-ellipsis> menu </span> </a> </li> <li class=md-nav__item> <a href=pipeline.html class=md-nav__link> <span class=md-ellipsis> pipeline </span> </a> </li> <li class=md-nav__item> <a href=plugin.html class=md-nav__link> <span class=md-ellipsis> plugin </span> </a> </li> <li class=md-nav__item> <a href=render_setup_tools.html class=md-nav__link> <span class=md-ellipsis> render_setup_tools </span> </a> </li> <li class=md-nav__item> <a href=setdress.html class=md-nav__link> <span class=md-ellipsis> setdress </span> </a> </li> <li class=md-nav__item> <a href=workfile_template_builder.html class=md-nav__link> <span class=md-ellipsis> workfile_template_builder </span> </a> </li> <li class=md-nav__item> <a href=workio.html class=md-nav__link> <span class=md-ellipsis> workio </span> </a> </li> <li class=md-nav__item> <a href=yeti.html class=md-nav__link> <span class=md-ellipsis> yeti </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../hooks/pre_auto_load_plugins.html class=md-nav__link> <span class=md-ellipsis> hooks </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../lib.html class=md-nav__link> <span class=md-ellipsis> lib </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../plugins/create/convert_legacy.html class=md-nav__link> <span class=md-ellipsis> plugins </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../startup/userSetup.html class=md-nav__link> <span class=md-ellipsis> startup </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../tools/mayalookassigner/alembic.html class=md-nav__link> <span class=md-ellipsis> tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../vendor/python/capture.html class=md-nav__link> <span class=md-ellipsis> vendor </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../version.html class=md-nav__link> <span class=md-ellipsis> version </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../server/settings/conversion.html class=md-nav__link> <span class=md-ellipsis> server </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib class=md-nav__link> <span class=md-ellipsis> lib </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.CameraInstanceCreationError class=md-nav__link> <span class=md-ellipsis> CameraInstanceCreationError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.RigSetsNotExistError class=md-nav__link> <span class=md-ellipsis> RigSetsNotExistError </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.delete_after class=md-nav__link> <span class=md-ellipsis> delete_after </span> </a> <nav class=md-nav aria-label=delete_after> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.delete_after--cube-deleted class=md-nav__link> <span class=md-ellipsis> cube deleted </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.apply_attributes class=md-nav__link> <span class=md-ellipsis> apply_attributes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.apply_connections class=md-nav__link> <span class=md-ellipsis> apply_connections </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.apply_shaders class=md-nav__link> <span class=md-ellipsis> apply_shaders </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.assign_look class=md-nav__link> <span class=md-ellipsis> assign_look </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.assign_look_by_version class=md-nav__link> <span class=md-ellipsis> assign_look_by_version </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.attribute_values class=md-nav__link> <span class=md-ellipsis> attribute_values </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.bake class=md-nav__link> <span class=md-ellipsis> bake </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.bake_to_world_space class=md-nav__link> <span class=md-ellipsis> bake_to_world_space </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.collect_animation_defs class=md-nav__link> <span class=md-ellipsis> collect_animation_defs </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.convert_to_maya_fps class=md-nav__link> <span class=md-ellipsis> convert_to_maya_fps </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.create_camera_instance class=md-nav__link> <span class=md-ellipsis> create_camera_instance </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.create_rig_animation_instance class=md-nav__link> <span class=md-ellipsis> create_rig_animation_instance </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.displaySmoothness class=md-nav__link> <span class=md-ellipsis> displaySmoothness </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.empty_sets class=md-nav__link> <span class=md-ellipsis> empty_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.evaluation class=md-nav__link> <span class=md-ellipsis> evaluation </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.fix_incompatible_containers class=md-nav__link> <span class=md-ellipsis> fix_incompatible_containers </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.force_shader_assignments_to_faces class=md-nav__link> <span class=md-ellipsis> force_shader_assignments_to_faces </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.generate_capture_preset class=md-nav__link> <span class=md-ellipsis> generate_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.generate_ids class=md-nav__link> <span class=md-ellipsis> generate_ids </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_all_children class=md-nav__link> <span class=md-ellipsis> get_all_children </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_attr_in_layer class=md-nav__link> <span class=md-ellipsis> get_attr_in_layer </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_attribute class=md-nav__link> <span class=md-ellipsis> get_attribute </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_capture_preset class=md-nav__link> <span class=md-ellipsis> get_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_color_management_preferences class=md-nav__link> <span class=md-ellipsis> get_color_management_preferences </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_container_members class=md-nav__link> <span class=md-ellipsis> get_container_members </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_container_transforms class=md-nav__link> <span class=md-ellipsis> get_container_transforms </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_creator_identifier class=md-nav__link> <span class=md-ellipsis> get_creator_identifier </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace class=md-nav__link> <span class=md-ellipsis> get_custom_namespace </span> </a> <nav class=md-nav aria-label=get_custom_namespace> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace--myspace_01_ class=md-nav__link> <span class=md-ellipsis> myspace_01_ </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace--_01_myspace class=md-nav__link> <span class=md-ellipsis> _01_myspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_custom_namespace--myspace01 class=md-nav__link> <span class=md-ellipsis> myspace01 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_fps_for_current_context class=md-nav__link> <span class=md-ellipsis> get_fps_for_current_context </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_frame_range class=md-nav__link> <span class=md-ellipsis> get_frame_range </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_highest_in_hierarchy class=md-nav__link> <span class=md-ellipsis> get_highest_in_hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_id class=md-nav__link> <span class=md-ellipsis> get_id </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_id_from_sibling class=md-nav__link> <span class=md-ellipsis> get_id_from_sibling </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_id_required_nodes class=md-nav__link> <span class=md-ellipsis> get_id_required_nodes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_isolate_view_sets class=md-nav__link> <span class=md-ellipsis> get_isolate_view_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_main_window class=md-nav__link> <span class=md-ellipsis> get_main_window </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_namespace class=md-nav__link> <span class=md-ellipsis> get_namespace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_node_index_under_parent class=md-nav__link> <span class=md-ellipsis> get_node_index_under_parent </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_node_name class=md-nav__link> <span class=md-ellipsis> get_node_name </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_node_parent class=md-nav__link> <span class=md-ellipsis> get_node_parent </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_reference_node class=md-nav__link> <span class=md-ellipsis> get_reference_node </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_reference_node_parents class=md-nav__link> <span class=md-ellipsis> get_reference_node_parents </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_related_sets class=md-nav__link> <span class=md-ellipsis> get_related_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_representation_path_by_project class=md-nav__link> <span class=md-ellipsis> get_representation_path_by_project </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_scene_units_settings class=md-nav__link> <span class=md-ellipsis> get_scene_units_settings </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_sequence class=md-nav__link> <span class=md-ellipsis> get_sequence </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.get_shader_assignments_from_shapes class=md-nav__link> <span class=md-ellipsis> get_shader_assignments_from_shapes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.guess_colorspace class=md-nav__link> <span class=md-ellipsis> guess_colorspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.image_info class=md-nav__link> <span class=md-ellipsis> image_info </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.imprint class=md-nav__link> <span class=md-ellipsis> imprint </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.is_valid_reference_node class=md-nav__link> <span class=md-ellipsis> is_valid_reference_node </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.is_visible class=md-nav__link> <span class=md-ellipsis> is_visible </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.iter_parents class=md-nav__link> <span class=md-ellipsis> iter_parents </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.iter_shader_edits class=md-nav__link> <span class=md-ellipsis> iter_shader_edits </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.iter_visible_nodes_in_range class=md-nav__link> <span class=md-ellipsis> iter_visible_nodes_in_range </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.keytangent_default class=md-nav__link> <span class=md-ellipsis> keytangent_default </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.len_flattened class=md-nav__link> <span class=md-ellipsis> len_flattened </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.list_looks class=md-nav__link> <span class=md-ellipsis> list_looks </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.load_capture_preset class=md-nav__link> <span class=md-ellipsis> load_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattr class=md-nav__link> <span class=md-ellipsis> lsattr </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattrs class=md-nav__link> <span class=md-ellipsis> lsattrs </span> </a> <nav class=md-nav aria-label=lsattrs> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattrs--return-nodes-with-an-age-of-five class=md-nav__link> <span class=md-ellipsis> Return nodes with an age of five. </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.lsattrs--return-nodes-with-both-age-and-color-of-five-and-blue class=md-nav__link> <span class=md-ellipsis> Return nodes with both age and color of five and blue. </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.maintained_selection class=md-nav__link> <span class=md-ellipsis> maintained_selection </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.maintained_selection_api class=md-nav__link> <span class=md-ellipsis> maintained_selection_api </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.material_loading_mode class=md-nav__link> <span class=md-ellipsis> material_loading_mode </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.matrix_equals class=md-nav__link> <span class=md-ellipsis> matrix_equals </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.namespaced class=md-nav__link> <span class=md-ellipsis> namespaced </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.no_display_layers class=md-nav__link> <span class=md-ellipsis> no_display_layers </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.no_undo class=md-nav__link> <span class=md-ellipsis> no_undo </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.nodetype_exists class=md-nav__link> <span class=md-ellipsis> nodetype_exists </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.pairwise class=md-nav__link> <span class=md-ellipsis> pairwise </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.panel_camera class=md-nav__link> <span class=md-ellipsis> panel_camera </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.parent_nodes class=md-nav__link> <span class=md-ellipsis> parent_nodes </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.polyConstraint class=md-nav__link> <span class=md-ellipsis> polyConstraint </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.prompt_reset_context class=md-nav__link> <span class=md-ellipsis> prompt_reset_context </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.read class=md-nav__link> <span class=md-ellipsis> read </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reload_all_udim_tile_previews class=md-nav__link> <span class=md-ellipsis> reload_all_udim_tile_previews </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.remove_other_uv_sets class=md-nav__link> <span class=md-ellipsis> remove_other_uv_sets </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.render_capture_preset class=md-nav__link> <span class=md-ellipsis> render_capture_preset </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.renderlayer class=md-nav__link> <span class=md-ellipsis> renderlayer </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reset_frame_range class=md-nav__link> <span class=md-ellipsis> reset_frame_range </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reset_polySelectConstraint class=md-nav__link> <span class=md-ellipsis> reset_polySelectConstraint </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.reset_scene_resolution class=md-nav__link> <span class=md-ellipsis> reset_scene_resolution </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.search_textures class=md-nav__link> <span class=md-ellipsis> search_textures </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_attribute class=md-nav__link> <span class=md-ellipsis> set_attribute </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_colorspace class=md-nav__link> <span class=md-ellipsis> set_colorspace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_context_settings class=md-nav__link> <span class=md-ellipsis> set_context_settings </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_id class=md-nav__link> <span class=md-ellipsis> set_id </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_scene_fps class=md-nav__link> <span class=md-ellipsis> set_scene_fps </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_scene_resolution class=md-nav__link> <span class=md-ellipsis> set_scene_resolution </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.set_scene_units class=md-nav__link> <span class=md-ellipsis> set_scene_units </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.shader class=md-nav__link> <span class=md-ellipsis> shader </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.strip_namespace class=md-nav__link> <span class=md-ellipsis> strip_namespace </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.suspended_refresh class=md-nav__link> <span class=md-ellipsis> suspended_refresh </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.tool class=md-nav__link> <span class=md-ellipsis> tool </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.undo_chunk class=md-nav__link> <span class=md-ellipsis> undo_chunk </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace class=md-nav__link> <span class=md-ellipsis> unique_namespace </span> </a> <nav class=md-nav aria-label=unique_namespace> <ul class=md-nav__list> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace--bar01 class=md-nav__link> <span class=md-ellipsis> bar01 </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace--hello01 class=md-nav__link> <span class=md-ellipsis> :hello01 </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unique_namespace--bar01_ns class=md-nav__link> <span class=md-ellipsis> bar01_NS: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.unlocked class=md-nav__link> <span class=md-ellipsis> unlocked </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.update_content_on_context_change class=md-nav__link> <span class=md-ellipsis> update_content_on_context_change </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.validate_fps class=md-nav__link> <span class=md-ellipsis> validate_fps </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.validate_scene_units class=md-nav__link> <span class=md-ellipsis> validate_scene_units </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.viewport_default_options class=md-nav__link> <span class=md-ellipsis> viewport_default_options </span> </a> </li> <li class=md-nav__item> <a href=#client.ayon_maya.api.lib.write_xgen_file class=md-nav__link> <span class=md-ellipsis> write_xgen_file </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../../../../index.html class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=../addon.html class=md-path__link> <span class=md-ellipsis> Reference </span> </a> </li> <li class=md-path__item> <a href=../addon.html class=md-path__link> <span class=md-ellipsis> client </span> </a> </li> <li class=md-path__item> <a href=../addon.html class=md-path__link> <span class=md-ellipsis> ayon_maya </span> </a> </li> <li class=md-path__item> <a href=action.html class=md-path__link> <span class=md-ellipsis> api </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <h1>lib</h1> <div class="doc doc-object doc-module"> <a id=client.ayon_maya.api.lib></a> <div class="doc doc-contents first"> <p>Standalone helper functions</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=client.ayon_maya.api.lib.CameraInstanceCreationError class="doc doc-heading"> <code>CameraInstanceCreationError</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=RuntimeError>RuntimeError</span></code></p> <p>Raised when camera instance creation fails.</p> <p>This is raised from <code>create_camera_instance</code> when the required camera nodes are missing or invalid.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>CameraInstanceCreationError</span><span class=p>(</span><span class=ne>RuntimeError</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Raised when camera instance creation fails.</span>

<span class=sd>    This is raised from `create_camera_instance` when the required</span>
<span class=sd>    camera nodes are missing or invalid.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>pass</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_maya.api.lib.RigSetsNotExistError class="doc doc-heading"> <code>RigSetsNotExistError</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=RuntimeError>RuntimeError</span></code></p> <p>Raised when required rig sets for animation instance are missing.</p> <p>This is raised from <code>create_rig_animation_instance</code> when the required <code>out_SET</code> or <code>controls_SET</code> are missing.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>85</span>
<span class=normal>86</span>
<span class=normal>87</span>
<span class=normal>88</span>
<span class=normal>89</span>
<span class=normal>90</span>
<span class=normal>91</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>RigSetsNotExistError</span><span class=p>(</span><span class=ne>RuntimeError</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Raised when required rig sets for animation instance are missing.</span>

<span class=sd>    This is raised from `create_rig_animation_instance` when the required</span>
<span class=sd>    `out_SET` or `controls_SET` are missing.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>pass</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-class"> <h2 id=client.ayon_maya.api.lib.delete_after class="doc doc-heading"> <code>delete_after</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=object>object</span></code></p> <p>Context Manager that will delete collected nodes after exit.</p> <p>This allows to ensure the nodes added to the context are deleted afterwards. This is useful if you want to ensure nodes are deleted even if an error is raised.</p> <p><span class=doc-section-title>Examples:</span></p> <p>with delete_after() as delete_bin: cube = maya.cmds.polyCube() delete_bin.extend(cube) # cube exists</p> <h3 id=client.ayon_maya.api.lib.delete_after--cube-deleted>cube deleted</h3> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>951</span>
<span class=normal>952</span>
<span class=normal>953</span>
<span class=normal>954</span>
<span class=normal>955</span>
<span class=normal>956</span>
<span class=normal>957</span>
<span class=normal>958</span>
<span class=normal>959</span>
<span class=normal>960</span>
<span class=normal>961</span>
<span class=normal>962</span>
<span class=normal>963</span>
<span class=normal>964</span>
<span class=normal>965</span>
<span class=normal>966</span>
<span class=normal>967</span>
<span class=normal>968</span>
<span class=normal>969</span>
<span class=normal>970</span>
<span class=normal>971</span>
<span class=normal>972</span>
<span class=normal>973</span>
<span class=normal>974</span>
<span class=normal>975</span>
<span class=normal>976</span>
<span class=normal>977</span>
<span class=normal>978</span>
<span class=normal>979</span>
<span class=normal>980</span>
<span class=normal>981</span>
<span class=normal>982</span>
<span class=normal>983</span>
<span class=normal>984</span>
<span class=normal>985</span>
<span class=normal>986</span>
<span class=normal>987</span>
<span class=normal>988</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>delete_after</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Context Manager that will delete collected nodes after exit.</span>

<span class=sd>    This allows to ensure the nodes added to the context are deleted</span>
<span class=sd>    afterwards. This is useful if you want to ensure nodes are deleted</span>
<span class=sd>    even if an error is raised.</span>

<span class=sd>    Examples:</span>
<span class=sd>        with delete_after() as delete_bin:</span>
<span class=sd>            cube = maya.cmds.polyCube()</span>
<span class=sd>            delete_bin.extend(cube)</span>
<span class=sd>            # cube exists</span>
<span class=sd>        # cube deleted</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>nodes</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>

        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>

        <span class=k>if</span> <span class=n>nodes</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>append</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>node</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>extend</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>nodes</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=nb>iter</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__enter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=k>return</span> <span class=bp>self</span>

    <span class=k>def</span><span class=w> </span><span class=fm>__exit__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>type</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>traceback</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_nodes</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.apply_attributes class="doc doc-heading"> <code class="highlight language-python"><span class=n>apply_attributes</span><span class=p>(</span><span class=n>attributes</span><span class=p>,</span> <span class=n>nodes_by_id</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Alter the attributes to match the state when publishing</p> <p>Apply attribute settings from the publish to the node in the scene based on the UUID which is stored in the cbId attribute.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attributes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>list of dictionaries</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>nodes_by_id</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>collection of nodes based on UUID {uuid: [node, node]}</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1790</span>
<span class=normal>1791</span>
<span class=normal>1792</span>
<span class=normal>1793</span>
<span class=normal>1794</span>
<span class=normal>1795</span>
<span class=normal>1796</span>
<span class=normal>1797</span>
<span class=normal>1798</span>
<span class=normal>1799</span>
<span class=normal>1800</span>
<span class=normal>1801</span>
<span class=normal>1802</span>
<span class=normal>1803</span>
<span class=normal>1804</span>
<span class=normal>1805</span>
<span class=normal>1806</span>
<span class=normal>1807</span>
<span class=normal>1808</span>
<span class=normal>1809</span>
<span class=normal>1810</span>
<span class=normal>1811</span>
<span class=normal>1812</span>
<span class=normal>1813</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>apply_attributes</span><span class=p>(</span><span class=n>attributes</span><span class=p>,</span> <span class=n>nodes_by_id</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Alter the attributes to match the state when publishing</span>

<span class=sd>    Apply attribute settings from the publish to the node in the scene based</span>
<span class=sd>    on the UUID which is stored in the cbId attribute.</span>

<span class=sd>    Args:</span>
<span class=sd>        attributes (list): list of dictionaries</span>
<span class=sd>        nodes_by_id (dict): collection of nodes based on UUID</span>
<span class=sd>                           {uuid: [node, node]}</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>for</span> <span class=n>attr_data</span> <span class=ow>in</span> <span class=n>attributes</span><span class=p>:</span>
        <span class=n>nodes</span> <span class=o>=</span> <span class=n>nodes_by_id</span><span class=p>[</span><span class=n>attr_data</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]]</span>
        <span class=n>attr_value</span> <span class=o>=</span> <span class=n>attr_data</span><span class=p>[</span><span class=s2>&quot;attributes&quot;</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
            <span class=k>for</span> <span class=n>attr</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>attr_value</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
                <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                    <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                        <span class=sa>f</span><span class=s2>&quot;Skipping setting </span><span class=si>{</span><span class=n>node</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>attr</span><span class=si>}</span><span class=s2> with value &#39;None&#39;&quot;</span><span class=p>)</span>
                    <span class=k>continue</span>

                <span class=n>set_attribute</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>node</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.apply_connections class="doc doc-heading"> <code class="highlight language-python"><span class=n>apply_connections</span><span class=p>(</span><span class=n>connections</span><span class=p>,</span> <span class=n>target_nodes_by_id</span><span class=p>,</span> <span class=n>source_nodes_by_id</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Connect texture reference object nodes to the target object nodes if there is one.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>connections</code> </td> <td> <code><span title=list>list</span>[<span title=dict>dict</span>[<span title=str>str</span>, <span title=Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <p>list of texture reference</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>target_nodes_by_id</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=list>list</span>[<span title=str>str</span>]]</code> </td> <td> <div class=doc-md-description> <p>The dict with target shape node ids</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>source_nodes_by_id</code> </td> <td> <code><span title=dict>dict</span>[<span title=str>str</span>, <span title=list>list</span>[<span title=str>str</span>]]</code> </td> <td> <div class=doc-md-description> <p>The dict with texture reference node ids.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4773</span>
<span class=normal>4774</span>
<span class=normal>4775</span>
<span class=normal>4776</span>
<span class=normal>4777</span>
<span class=normal>4778</span>
<span class=normal>4779</span>
<span class=normal>4780</span>
<span class=normal>4781</span>
<span class=normal>4782</span>
<span class=normal>4783</span>
<span class=normal>4784</span>
<span class=normal>4785</span>
<span class=normal>4786</span>
<span class=normal>4787</span>
<span class=normal>4788</span>
<span class=normal>4789</span>
<span class=normal>4790</span>
<span class=normal>4791</span>
<span class=normal>4792</span>
<span class=normal>4793</span>
<span class=normal>4794</span>
<span class=normal>4795</span>
<span class=normal>4796</span>
<span class=normal>4797</span>
<span class=normal>4798</span>
<span class=normal>4799</span>
<span class=normal>4800</span>
<span class=normal>4801</span>
<span class=normal>4802</span>
<span class=normal>4803</span>
<span class=normal>4804</span>
<span class=normal>4805</span>
<span class=normal>4806</span>
<span class=normal>4807</span>
<span class=normal>4808</span>
<span class=normal>4809</span>
<span class=normal>4810</span>
<span class=normal>4811</span>
<span class=normal>4812</span>
<span class=normal>4813</span>
<span class=normal>4814</span>
<span class=normal>4815</span>
<span class=normal>4816</span>
<span class=normal>4817</span>
<span class=normal>4818</span>
<span class=normal>4819</span>
<span class=normal>4820</span>
<span class=normal>4821</span>
<span class=normal>4822</span>
<span class=normal>4823</span>
<span class=normal>4824</span>
<span class=normal>4825</span>
<span class=normal>4826</span>
<span class=normal>4827</span>
<span class=normal>4828</span>
<span class=normal>4829</span>
<span class=normal>4830</span>
<span class=normal>4831</span>
<span class=normal>4832</span>
<span class=normal>4833</span>
<span class=normal>4834</span>
<span class=normal>4835</span>
<span class=normal>4836</span>
<span class=normal>4837</span>
<span class=normal>4838</span>
<span class=normal>4839</span>
<span class=normal>4840</span>
<span class=normal>4841</span>
<span class=normal>4842</span>
<span class=normal>4843</span>
<span class=normal>4844</span>
<span class=normal>4845</span>
<span class=normal>4846</span>
<span class=normal>4847</span>
<span class=normal>4848</span>
<span class=normal>4849</span>
<span class=normal>4850</span>
<span class=normal>4851</span>
<span class=normal>4852</span>
<span class=normal>4853</span>
<span class=normal>4854</span>
<span class=normal>4855</span>
<span class=normal>4856</span>
<span class=normal>4857</span>
<span class=normal>4858</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>apply_connections</span><span class=p>(</span><span class=n>connections</span><span class=p>,</span> <span class=n>target_nodes_by_id</span><span class=p>,</span> <span class=n>source_nodes_by_id</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Connect texture reference object nodes to the target object</span>
<span class=sd>    nodes if there is one.</span>

<span class=sd>    Args:</span>
<span class=sd>        connections (list[dict[str, Any]]): list of texture reference</span>
<span class=sd>        objects connection data</span>
<span class=sd>        target_nodes_by_id (dict[str, list[str]]): The dict with target shape node ids</span>
<span class=sd>        source_nodes_by_id (dict[str, list[str]]): The dict with texture reference node ids.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># Compare loaded connections to scene.</span>
    <span class=k>for</span> <span class=n>connection</span> <span class=ow>in</span> <span class=n>connections</span><span class=p>:</span>
        <span class=n>source_node</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span>
            <span class=nb>iter</span><span class=p>(</span><span class=n>source_nodes_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
            <span class=n>connection</span><span class=p>[</span><span class=s2>&quot;sourceID&quot;</span><span class=p>],</span> <span class=p>[])</span>
            <span class=p>),</span> <span class=kc>None</span>
        <span class=p>)</span>

        <span class=n>target_nodes</span> <span class=o>=</span> <span class=n>target_nodes_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>connection</span><span class=p>[</span><span class=s2>&quot;destinationID&quot;</span><span class=p>],</span> <span class=p>[])</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>source_node</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>target_nodes</span><span class=p>:</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                <span class=s2>&quot;Could not find nodes for reference input:</span><span class=se>\n</span><span class=s2>&quot;</span> <span class=o>+</span>
                <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>connection</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>sort_keys</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=p>)</span>
            <span class=k>continue</span>

        <span class=n>source_attr</span><span class=p>,</span> <span class=n>target_attr</span> <span class=o>=</span> <span class=n>connection</span><span class=p>[</span><span class=s2>&quot;connections&quot;</span><span class=p>]</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span>
            <span class=n>source_attr</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>source_node</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>):</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                <span class=s2>&quot;Could not find attribute </span><span class=si>{}</span><span class=s2> on node </span><span class=si>{}</span><span class=s2> for &quot;</span>
                <span class=s2>&quot;reference input:</span><span class=se>\n</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=n>source_attr</span><span class=p>,</span>
                    <span class=n>source_node</span><span class=p>,</span>
                    <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span>
                        <span class=n>connection</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>sort_keys</span><span class=o>=</span><span class=kc>True</span>
                    <span class=p>)</span>
                <span class=p>)</span>
            <span class=p>)</span>
            <span class=k>continue</span>

        <span class=k>for</span> <span class=n>target_node</span> <span class=ow>in</span> <span class=n>target_nodes</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>target_node</span> <span class=o>==</span> <span class=n>source_node</span><span class=p>:</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;Skipping connection to itself for </span><span class=si>{</span><span class=n>source_node</span><span class=si>}</span><span class=s2> &quot;</span>
                    <span class=sa>f</span><span class=s2>&quot;connection </span><span class=si>{</span><span class=n>source_attr</span><span class=si>}</span><span class=s2>-&gt;</span><span class=si>{</span><span class=n>target_attr</span><span class=si>}</span><span class=s2>.&quot;</span>
                <span class=p>)</span>
                <span class=k>continue</span>

            <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span>
                <span class=n>target_attr</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>target_node</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span>
            <span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                    <span class=s2>&quot;Could not find attribute </span><span class=si>{}</span><span class=s2> on node </span><span class=si>{}</span><span class=s2> for &quot;</span>
                    <span class=s2>&quot;reference input:</span><span class=se>\n</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                        <span class=n>target_attr</span><span class=p>,</span>
                        <span class=n>target_node</span><span class=p>,</span>
                        <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span>
                            <span class=n>connection</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>sort_keys</span><span class=o>=</span><span class=kc>True</span>
                        <span class=p>)</span>
                    <span class=p>)</span>
                <span class=p>)</span>
                <span class=k>continue</span>

            <span class=n>source_plug</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>source_node</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>source_attr</span><span class=si>}</span><span class=s2>&quot;</span>
            <span class=n>target_plug</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>target_node</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>target_attr</span><span class=si>}</span><span class=s2>&quot;</span>

            <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>isConnected</span><span class=p>(</span>
                <span class=n>source_plug</span><span class=p>,</span> <span class=n>target_plug</span><span class=p>,</span> <span class=n>ignoreUnitConversion</span><span class=o>=</span><span class=kc>True</span>
            <span class=p>):</span>
                <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                    <span class=s2>&quot;Connection already exists: </span><span class=si>{}</span><span class=s2> -&gt; </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                        <span class=n>source_plug</span><span class=p>,</span> <span class=n>target_plug</span>
                    <span class=p>)</span>
                <span class=p>)</span>
                <span class=k>continue</span>

            <span class=n>cmds</span><span class=o>.</span><span class=n>connectAttr</span><span class=p>(</span><span class=n>source_plug</span><span class=p>,</span> <span class=n>target_plug</span><span class=p>,</span> <span class=n>force</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                <span class=s2>&quot;Connected attributes: </span><span class=si>{}</span><span class=s2> -&gt; </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=n>source_plug</span><span class=p>,</span> <span class=n>target_plug</span>
                <span class=p>)</span>
            <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.apply_shaders class="doc doc-heading"> <code class="highlight language-python"><span class=n>apply_shaders</span><span class=p>(</span><span class=n>relationships</span><span class=p>,</span> <span class=n>shadernodes</span><span class=p>,</span> <span class=n>nodes</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Link shadingEngine to the right nodes based on relationship data</p> <p>Relationship data is constructed of a collection of <code>sets</code> and <code>attributes</code> <code>sets</code> corresponds with the shaderEngines found in the lookdev. Each set has the keys <code>name</code>, <code>members</code> and <code>uuid</code>, the <code>members</code> hold a collection of node information <code>name</code> and <code>uuid</code>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>relationships</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>relationship data</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>shadernodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>list of nodes of the shading objectSets (includes</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>list of nodes to apply shader to</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2075</span>
<span class=normal>2076</span>
<span class=normal>2077</span>
<span class=normal>2078</span>
<span class=normal>2079</span>
<span class=normal>2080</span>
<span class=normal>2081</span>
<span class=normal>2082</span>
<span class=normal>2083</span>
<span class=normal>2084</span>
<span class=normal>2085</span>
<span class=normal>2086</span>
<span class=normal>2087</span>
<span class=normal>2088</span>
<span class=normal>2089</span>
<span class=normal>2090</span>
<span class=normal>2091</span>
<span class=normal>2092</span>
<span class=normal>2093</span>
<span class=normal>2094</span>
<span class=normal>2095</span>
<span class=normal>2096</span>
<span class=normal>2097</span>
<span class=normal>2098</span>
<span class=normal>2099</span>
<span class=normal>2100</span>
<span class=normal>2101</span>
<span class=normal>2102</span>
<span class=normal>2103</span>
<span class=normal>2104</span>
<span class=normal>2105</span>
<span class=normal>2106</span>
<span class=normal>2107</span>
<span class=normal>2108</span>
<span class=normal>2109</span>
<span class=normal>2110</span>
<span class=normal>2111</span>
<span class=normal>2112</span>
<span class=normal>2113</span>
<span class=normal>2114</span>
<span class=normal>2115</span>
<span class=normal>2116</span>
<span class=normal>2117</span>
<span class=normal>2118</span>
<span class=normal>2119</span>
<span class=normal>2120</span>
<span class=normal>2121</span>
<span class=normal>2122</span>
<span class=normal>2123</span>
<span class=normal>2124</span>
<span class=normal>2125</span>
<span class=normal>2126</span>
<span class=normal>2127</span>
<span class=normal>2128</span>
<span class=normal>2129</span>
<span class=normal>2130</span>
<span class=normal>2131</span>
<span class=normal>2132</span>
<span class=normal>2133</span>
<span class=normal>2134</span>
<span class=normal>2135</span>
<span class=normal>2136</span>
<span class=normal>2137</span>
<span class=normal>2138</span>
<span class=normal>2139</span>
<span class=normal>2140</span>
<span class=normal>2141</span>
<span class=normal>2142</span>
<span class=normal>2143</span>
<span class=normal>2144</span>
<span class=normal>2145</span>
<span class=normal>2146</span>
<span class=normal>2147</span>
<span class=normal>2148</span>
<span class=normal>2149</span>
<span class=normal>2150</span>
<span class=normal>2151</span>
<span class=normal>2152</span>
<span class=normal>2153</span>
<span class=normal>2154</span>
<span class=normal>2155</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>apply_shaders</span><span class=p>(</span><span class=n>relationships</span><span class=p>,</span> <span class=n>shadernodes</span><span class=p>,</span> <span class=n>nodes</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Link shadingEngine to the right nodes based on relationship data</span>

<span class=sd>    Relationship data is constructed of a collection of `sets` and `attributes`</span>
<span class=sd>    `sets` corresponds with the shaderEngines found in the lookdev.</span>
<span class=sd>    Each set has the keys `name`, `members` and `uuid`, the `members`</span>
<span class=sd>    hold a collection of node information `name` and `uuid`.</span>

<span class=sd>    Args:</span>
<span class=sd>        relationships (dict): relationship data</span>
<span class=sd>        shadernodes (list): list of nodes of the shading objectSets (includes</span>
<span class=sd>        VRayObjectProperties and shadingEngines)</span>
<span class=sd>        nodes (list): list of nodes to apply shader to</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>attributes</span> <span class=o>=</span> <span class=n>relationships</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;attributes&quot;</span><span class=p>,</span> <span class=p>[])</span>
    <span class=n>shader_data</span> <span class=o>=</span> <span class=n>relationships</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;relationships&quot;</span><span class=p>,</span> <span class=p>{})</span>

    <span class=n>shading_engines</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>shadernodes</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;objectSet&quot;</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>assert</span> <span class=n>shading_engines</span><span class=p>,</span> <span class=s2>&quot;Error in retrieving objectSets from reference&quot;</span>

    <span class=n>shader_mesh_nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>shadernodes</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;mesh&quot;</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=c1># region compute lookup</span>
    <span class=n>nodes_by_id</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=n>nodes_by_id</span><span class=p>[</span><span class=n>get_id</span><span class=p>(</span><span class=n>node</span><span class=p>)]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

    <span class=n>shading_engines_by_id</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>shad</span> <span class=ow>in</span> <span class=n>shading_engines</span><span class=p>:</span>
        <span class=n>shading_engines_by_id</span><span class=p>[</span><span class=n>get_id</span><span class=p>(</span><span class=n>shad</span><span class=p>)]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>shad</span><span class=p>)</span>

    <span class=n>texture_nodes_by_id</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>mesh_node</span> <span class=ow>in</span> <span class=n>shader_mesh_nodes</span><span class=p>:</span>
        <span class=n>texture_nodes_by_id</span><span class=p>[</span><span class=n>get_id</span><span class=p>(</span><span class=n>mesh_node</span><span class=p>)]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mesh_node</span><span class=p>)</span>

    <span class=c1># endregion</span>

    <span class=c1># region assign shading engines and other sets</span>
    <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>shader_data</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
        <span class=c1># collect all unique IDs of the set members</span>
        <span class=n>shader_uuid</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
        <span class=n>member_uuids</span> <span class=o>=</span> <span class=p>[</span><span class=n>member</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span> <span class=k>for</span> <span class=n>member</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;members&quot;</span><span class=p>]]</span>

        <span class=n>filtered_nodes</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>m_uuid</span> <span class=ow>in</span> <span class=n>member_uuids</span><span class=p>:</span>
            <span class=n>filtered_nodes</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>nodes_by_id</span><span class=p>[</span><span class=n>m_uuid</span><span class=p>])</span>

        <span class=n>id_shading_engines</span> <span class=o>=</span> <span class=n>shading_engines_by_id</span><span class=p>[</span><span class=n>shader_uuid</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>id_shading_engines</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;No shader found with cbId &quot;</span>
                      <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>shader_uuid</span><span class=p>))</span>
            <span class=k>continue</span>
        <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=n>id_shading_engines</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;Skipping shader assignment. &quot;</span>
                      <span class=s2>&quot;More than one shader found with cbId &quot;</span>
                      <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39;. (found: </span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>shader_uuid</span><span class=p>,</span>
                                                 <span class=n>id_shading_engines</span><span class=p>))</span>
            <span class=k>continue</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>filtered_nodes</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No nodes found for shading engine &quot;</span>
                        <span class=s2>&quot;&#39;</span><span class=si>{0}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>id_shading_engines</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
            <span class=k>continue</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>filtered_nodes</span><span class=p>,</span> <span class=n>forceElement</span><span class=o>=</span><span class=n>id_shading_engines</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
        <span class=k>except</span> <span class=ne>RuntimeError</span> <span class=k>as</span> <span class=n>rte</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;Error during shader assignment: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>rte</span><span class=p>))</span>

    <span class=c1># check if there is texture references input and connect the texture</span>
    <span class=c1># reference back to the nodes</span>
    <span class=n>texture_references_input</span> <span class=o>=</span> <span class=n>relationships</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;connections&quot;</span><span class=p>,</span> <span class=p>[])</span>
    <span class=n>apply_connections</span><span class=p>(</span>
        <span class=n>texture_references_input</span><span class=p>,</span> <span class=n>nodes_by_id</span><span class=p>,</span> <span class=n>texture_nodes_by_id</span>
    <span class=p>)</span>

    <span class=c1># endregion</span>

    <span class=n>apply_attributes</span><span class=p>(</span><span class=n>attributes</span><span class=p>,</span> <span class=n>nodes_by_id</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.assign_look class="doc doc-heading"> <code class="highlight language-python"><span class=n>assign_look</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>product_name</span><span class=o>=</span><span class=s1>&#39;lookMain&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Assigns a look to a node.</p> <p>Optimizes the nodes by grouping by folder id and finding related product by name.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>all nodes to assign the look to</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>product_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name of the product to find</p> </div> </td> <td> <code>&#39;lookMain&#39;</code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2007</span>
<span class=normal>2008</span>
<span class=normal>2009</span>
<span class=normal>2010</span>
<span class=normal>2011</span>
<span class=normal>2012</span>
<span class=normal>2013</span>
<span class=normal>2014</span>
<span class=normal>2015</span>
<span class=normal>2016</span>
<span class=normal>2017</span>
<span class=normal>2018</span>
<span class=normal>2019</span>
<span class=normal>2020</span>
<span class=normal>2021</span>
<span class=normal>2022</span>
<span class=normal>2023</span>
<span class=normal>2024</span>
<span class=normal>2025</span>
<span class=normal>2026</span>
<span class=normal>2027</span>
<span class=normal>2028</span>
<span class=normal>2029</span>
<span class=normal>2030</span>
<span class=normal>2031</span>
<span class=normal>2032</span>
<span class=normal>2033</span>
<span class=normal>2034</span>
<span class=normal>2035</span>
<span class=normal>2036</span>
<span class=normal>2037</span>
<span class=normal>2038</span>
<span class=normal>2039</span>
<span class=normal>2040</span>
<span class=normal>2041</span>
<span class=normal>2042</span>
<span class=normal>2043</span>
<span class=normal>2044</span>
<span class=normal>2045</span>
<span class=normal>2046</span>
<span class=normal>2047</span>
<span class=normal>2048</span>
<span class=normal>2049</span>
<span class=normal>2050</span>
<span class=normal>2051</span>
<span class=normal>2052</span>
<span class=normal>2053</span>
<span class=normal>2054</span>
<span class=normal>2055</span>
<span class=normal>2056</span>
<span class=normal>2057</span>
<span class=normal>2058</span>
<span class=normal>2059</span>
<span class=normal>2060</span>
<span class=normal>2061</span>
<span class=normal>2062</span>
<span class=normal>2063</span>
<span class=normal>2064</span>
<span class=normal>2065</span>
<span class=normal>2066</span>
<span class=normal>2067</span>
<span class=normal>2068</span>
<span class=normal>2069</span>
<span class=normal>2070</span>
<span class=normal>2071</span>
<span class=normal>2072</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>assign_look</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>product_name</span><span class=o>=</span><span class=s2>&quot;lookMain&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Assigns a look to a node.</span>

<span class=sd>    Optimizes the nodes by grouping by folder id and finding</span>
<span class=sd>    related product by name.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (list): all nodes to assign the look to</span>
<span class=sd>        product_name (str): name of the product to find</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Group all nodes per folder id</span>
    <span class=n>grouped</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=n>hash_id</span> <span class=o>=</span> <span class=n>get_id</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>hash_id</span><span class=p>:</span>
            <span class=k>continue</span>

        <span class=n>parts</span> <span class=o>=</span> <span class=n>hash_id</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>grouped</span><span class=p>[</span><span class=n>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

    <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
    <span class=n>product_entities</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>product_names</span><span class=o>=</span><span class=p>[</span><span class=n>product_name</span><span class=p>],</span> <span class=n>folder_ids</span><span class=o>=</span><span class=n>grouped</span><span class=o>.</span><span class=n>keys</span><span class=p>()</span>
    <span class=p>)</span>
    <span class=n>product_entities_by_folder_id</span> <span class=o>=</span> <span class=p>{</span>
        <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;folderId&quot;</span><span class=p>]:</span> <span class=n>product_entity</span>
        <span class=k>for</span> <span class=n>product_entity</span> <span class=ow>in</span> <span class=n>product_entities</span>
    <span class=p>}</span>
    <span class=n>product_ids</span> <span class=o>=</span> <span class=p>{</span>
        <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>product_entity</span> <span class=ow>in</span> <span class=n>product_entities_by_folder_id</span><span class=o>.</span><span class=n>values</span><span class=p>()</span>
    <span class=p>}</span>
    <span class=n>last_version_entities_by_product_id</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_last_versions</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span>
        <span class=n>product_ids</span>
    <span class=p>)</span>

    <span class=k>for</span> <span class=n>folder_id</span><span class=p>,</span> <span class=n>asset_nodes</span> <span class=ow>in</span> <span class=n>grouped</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=n>product_entity</span> <span class=o>=</span> <span class=n>product_entities_by_folder_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>folder_id</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>product_entity</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
                <span class=s2>&quot;No product &#39;</span><span class=si>{}</span><span class=s2>&#39; found for </span><span class=si>{}</span><span class=s2>&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>product_name</span><span class=p>,</span> <span class=n>folder_id</span><span class=p>))</span>
            <span class=k>continue</span>

        <span class=n>product_id</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
        <span class=n>last_version</span> <span class=o>=</span> <span class=n>last_version_entities_by_product_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>last_version</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
                <span class=s2>&quot;Not found last version for product &#39;</span><span class=si>{}</span><span class=s2>&#39; on folder with id </span><span class=si>{}</span><span class=s2>&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>product_name</span><span class=p>,</span> <span class=n>folder_id</span><span class=p>))</span>
            <span class=k>continue</span>

        <span class=n>families</span> <span class=o>=</span> <span class=n>last_version</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;attrib&quot;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;families&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
        <span class=k>if</span> <span class=s2>&quot;look&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>families</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span>
                <span class=s2>&quot;Last version for product &#39;</span><span class=si>{}</span><span class=s2>&#39; on folder with id </span><span class=si>{}</span><span class=s2>&quot;</span>
                <span class=s2>&quot; does not have look product type&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>product_name</span><span class=p>,</span> <span class=n>folder_id</span><span class=p>))</span>
            <span class=k>continue</span>

        <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Assigning look &#39;</span><span class=si>{}</span><span class=s2>&#39; &lt;v</span><span class=si>{:03d}</span><span class=s2>&gt;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>product_name</span><span class=p>,</span> <span class=n>last_version</span><span class=p>[</span><span class=s2>&quot;version&quot;</span><span class=p>]))</span>

        <span class=n>assign_look_by_version</span><span class=p>(</span><span class=n>asset_nodes</span><span class=p>,</span> <span class=n>last_version</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>])</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.assign_look_by_version class="doc doc-heading"> <code class="highlight language-python"><span class=n>assign_look_by_version</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>version_id</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Assign nodes a specific published look version by id.</p> <p>This assumes the nodes correspond with the asset.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>nodes to assign look to</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>version_id</code> </td> <td> <code><span title=bson.ObjectId>ObjectId</span></code> </td> <td> <div class=doc-md-description> <p>database id of the version</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1944</span>
<span class=normal>1945</span>
<span class=normal>1946</span>
<span class=normal>1947</span>
<span class=normal>1948</span>
<span class=normal>1949</span>
<span class=normal>1950</span>
<span class=normal>1951</span>
<span class=normal>1952</span>
<span class=normal>1953</span>
<span class=normal>1954</span>
<span class=normal>1955</span>
<span class=normal>1956</span>
<span class=normal>1957</span>
<span class=normal>1958</span>
<span class=normal>1959</span>
<span class=normal>1960</span>
<span class=normal>1961</span>
<span class=normal>1962</span>
<span class=normal>1963</span>
<span class=normal>1964</span>
<span class=normal>1965</span>
<span class=normal>1966</span>
<span class=normal>1967</span>
<span class=normal>1968</span>
<span class=normal>1969</span>
<span class=normal>1970</span>
<span class=normal>1971</span>
<span class=normal>1972</span>
<span class=normal>1973</span>
<span class=normal>1974</span>
<span class=normal>1975</span>
<span class=normal>1976</span>
<span class=normal>1977</span>
<span class=normal>1978</span>
<span class=normal>1979</span>
<span class=normal>1980</span>
<span class=normal>1981</span>
<span class=normal>1982</span>
<span class=normal>1983</span>
<span class=normal>1984</span>
<span class=normal>1985</span>
<span class=normal>1986</span>
<span class=normal>1987</span>
<span class=normal>1988</span>
<span class=normal>1989</span>
<span class=normal>1990</span>
<span class=normal>1991</span>
<span class=normal>1992</span>
<span class=normal>1993</span>
<span class=normal>1994</span>
<span class=normal>1995</span>
<span class=normal>1996</span>
<span class=normal>1997</span>
<span class=normal>1998</span>
<span class=normal>1999</span>
<span class=normal>2000</span>
<span class=normal>2001</span>
<span class=normal>2002</span>
<span class=normal>2003</span>
<span class=normal>2004</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>assign_look_by_version</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>version_id</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Assign nodes a specific published look version by id.</span>

<span class=sd>    This assumes the nodes correspond with the asset.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes(list): nodes to assign look to</span>
<span class=sd>        version_id (bson.ObjectId): database id of the version</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>

    <span class=c1># Get representations of shader file and relationships</span>
    <span class=n>representations</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_representations</span><span class=p>(</span>
        <span class=n>project_name</span><span class=o>=</span><span class=n>project_name</span><span class=p>,</span>
        <span class=n>representation_names</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;ma&quot;</span><span class=p>,</span> <span class=s2>&quot;json&quot;</span><span class=p>},</span>
        <span class=n>version_ids</span><span class=o>=</span><span class=p>[</span><span class=n>version_id</span><span class=p>]</span>
    <span class=p>))</span>
    <span class=n>look_representation</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span>
        <span class=n>repre</span> <span class=k>for</span> <span class=n>repre</span> <span class=ow>in</span> <span class=n>representations</span> <span class=k>if</span> <span class=n>repre</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;ma&quot;</span><span class=p>)</span>
    <span class=n>json_representation</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span>
        <span class=n>repre</span> <span class=k>for</span> <span class=n>repre</span> <span class=ow>in</span> <span class=n>representations</span> <span class=k>if</span> <span class=n>repre</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;json&quot;</span><span class=p>)</span>

    <span class=c1># See if representation is already loaded, if so reuse it.</span>
    <span class=n>host</span> <span class=o>=</span> <span class=n>registered_host</span><span class=p>()</span>
    <span class=n>representation_id</span> <span class=o>=</span> <span class=n>look_representation</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
    <span class=k>for</span> <span class=n>container</span> <span class=ow>in</span> <span class=n>host</span><span class=o>.</span><span class=n>ls</span><span class=p>():</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>container</span><span class=p>[</span><span class=s1>&#39;loader&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;LookLoader&quot;</span> <span class=ow>and</span>
                <span class=n>container</span><span class=p>[</span><span class=s1>&#39;representation&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>representation_id</span><span class=p>):</span>
            <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Reusing loaded look ..&quot;</span><span class=p>)</span>
            <span class=n>container_node</span> <span class=o>=</span> <span class=n>container</span><span class=p>[</span><span class=s1>&#39;objectName&#39;</span><span class=p>]</span>
            <span class=k>break</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Using look for the first time ..&quot;</span><span class=p>)</span>

        <span class=c1># Load file</span>
        <span class=n>_loaders</span> <span class=o>=</span> <span class=n>discover_loader_plugins</span><span class=p>()</span>
        <span class=n>loaders</span> <span class=o>=</span> <span class=n>loaders_from_representation</span><span class=p>(</span><span class=n>_loaders</span><span class=p>,</span> <span class=n>representation_id</span><span class=p>)</span>
        <span class=n>Loader</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>loaders</span> <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;LookLoader&quot;</span><span class=p>),</span> <span class=kc>None</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>Loader</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>RuntimeError</span><span class=p>(</span><span class=s2>&quot;Could not find LookLoader, this is a bug&quot;</span><span class=p>)</span>

        <span class=c1># Reference the look file</span>
        <span class=k>with</span> <span class=n>maintained_selection</span><span class=p>():</span>
            <span class=n>container_node</span> <span class=o>=</span> <span class=n>load_container</span><span class=p>(</span><span class=n>Loader</span><span class=p>,</span> <span class=n>look_representation</span><span class=p>)</span>

    <span class=c1># Get container members</span>
    <span class=n>shader_nodes</span> <span class=o>=</span> <span class=n>get_container_members</span><span class=p>(</span><span class=n>container_node</span><span class=p>)</span>

    <span class=c1># Load relationships</span>
    <span class=n>shader_relation</span> <span class=o>=</span> <span class=n>get_representation_path_by_project</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>json_representation</span>
    <span class=p>)</span>
    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>shader_relation</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=n>relationships</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>

    <span class=c1># Assign relationships</span>
    <span class=n>apply_shaders</span><span class=p>(</span><span class=n>relationships</span><span class=p>,</span> <span class=n>shader_nodes</span><span class=p>,</span> <span class=n>nodes</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.attribute_values class="doc doc-heading"> <code class="highlight language-python"><span class=n>attribute_values</span><span class=p>(</span><span class=n>attr_values</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Remaps node attributes to values during context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attr_values</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Dictionary with (attr, value)</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>812</span>
<span class=normal>813</span>
<span class=normal>814</span>
<span class=normal>815</span>
<span class=normal>816</span>
<span class=normal>817</span>
<span class=normal>818</span>
<span class=normal>819</span>
<span class=normal>820</span>
<span class=normal>821</span>
<span class=normal>822</span>
<span class=normal>823</span>
<span class=normal>824</span>
<span class=normal>825</span>
<span class=normal>826</span>
<span class=normal>827</span>
<span class=normal>828</span>
<span class=normal>829</span>
<span class=normal>830</span>
<span class=normal>831</span>
<span class=normal>832</span>
<span class=normal>833</span>
<span class=normal>834</span>
<span class=normal>835</span>
<span class=normal>836</span>
<span class=normal>837</span>
<span class=normal>838</span>
<span class=normal>839</span>
<span class=normal>840</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>attribute_values</span><span class=p>(</span><span class=n>attr_values</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remaps node attributes to values during context.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        attr_values (dict): Dictionary with (attr, value)</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>original</span> <span class=o>=</span> <span class=p>[(</span><span class=n>attr</span><span class=p>,</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>))</span> <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>attr_values</span><span class=p>]</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>attr</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>attr_values</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;string&quot;</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>attr</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>original</span><span class=p>:</span>
            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;string&quot;</span><span class=p>)</span>
            <span class=k>elif</span> <span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=o>==</span> <span class=s2>&quot;string&quot;</span><span class=p>:</span>
                <span class=c1># In some cases the maya.cmds.getAttr command returns None</span>
                <span class=c1># for string attributes but this value cannot assigned.</span>
                <span class=c1># Note: After setting it once to &quot;&quot; it will then return &quot;&quot;</span>
                <span class=c1>#       instead of None. So this would only happen once.</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;string&quot;</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.bake class="doc doc-heading"> <code class="highlight language-python"><span class=n>bake</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>frame_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span> <span class=n>simulation</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>preserve_outside_keys</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>disable_implicit_control</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Bake the given nodes over the time range.</p> <p>This will bake all attributes of the node, including custom attributes.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>Names of transform nodes, eg. camera, light.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>frame_range</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>frame range with start and end frame. or if None then takes timeSliderRange</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>simulation</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to perform a full simulation of the attributes over time.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>preserve_outside_keys</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Keep keys that are outside of the baked range.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>disable_implicit_control</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>When True will disable any constraints to the object.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>shape</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>When True also bake attributes on the children shapes.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>step</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>The step size to sample by.</p> </div> </td> <td> <code>1.0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2934</span>
<span class=normal>2935</span>
<span class=normal>2936</span>
<span class=normal>2937</span>
<span class=normal>2938</span>
<span class=normal>2939</span>
<span class=normal>2940</span>
<span class=normal>2941</span>
<span class=normal>2942</span>
<span class=normal>2943</span>
<span class=normal>2944</span>
<span class=normal>2945</span>
<span class=normal>2946</span>
<span class=normal>2947</span>
<span class=normal>2948</span>
<span class=normal>2949</span>
<span class=normal>2950</span>
<span class=normal>2951</span>
<span class=normal>2952</span>
<span class=normal>2953</span>
<span class=normal>2954</span>
<span class=normal>2955</span>
<span class=normal>2956</span>
<span class=normal>2957</span>
<span class=normal>2958</span>
<span class=normal>2959</span>
<span class=normal>2960</span>
<span class=normal>2961</span>
<span class=normal>2962</span>
<span class=normal>2963</span>
<span class=normal>2964</span>
<span class=normal>2965</span>
<span class=normal>2966</span>
<span class=normal>2967</span>
<span class=normal>2968</span>
<span class=normal>2969</span>
<span class=normal>2970</span>
<span class=normal>2971</span>
<span class=normal>2972</span>
<span class=normal>2973</span>
<span class=normal>2974</span>
<span class=normal>2975</span>
<span class=normal>2976</span>
<span class=normal>2977</span>
<span class=normal>2978</span>
<span class=normal>2979</span>
<span class=normal>2980</span>
<span class=normal>2981</span>
<span class=normal>2982</span>
<span class=normal>2983</span>
<span class=normal>2984</span>
<span class=normal>2985</span>
<span class=normal>2986</span>
<span class=normal>2987</span>
<span class=normal>2988</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>bake</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span>
         <span class=n>frame_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
         <span class=n>step</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
         <span class=n>simulation</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
         <span class=n>preserve_outside_keys</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
         <span class=n>disable_implicit_control</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
         <span class=n>shape</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Bake the given nodes over the time range.</span>

<span class=sd>    This will bake all attributes of the node, including custom attributes.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (list): Names of transform nodes, eg. camera, light.</span>
<span class=sd>        frame_range (list): frame range with start and end frame.</span>
<span class=sd>            or if None then takes timeSliderRange</span>
<span class=sd>        simulation (bool): Whether to perform a full simulation of the</span>
<span class=sd>            attributes over time.</span>
<span class=sd>        preserve_outside_keys (bool): Keep keys that are outside of the baked</span>
<span class=sd>            range.</span>
<span class=sd>        disable_implicit_control (bool): When True will disable any</span>
<span class=sd>            constraints to the object.</span>
<span class=sd>        shape (bool): When True also bake attributes on the children shapes.</span>
<span class=sd>        step (float): The step size to sample by.</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Parse inputs</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)),</span> <span class=s2>&quot;Nodes must be a list or tuple&quot;</span>

    <span class=c1># If frame range is None fall back to time slider playback time range</span>
    <span class=k>if</span> <span class=n>frame_range</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>frame_range</span> <span class=o>=</span> <span class=p>[</span><span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>minTime</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span>
                       <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>maxTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)]</span>

    <span class=c1># If frame range is single frame bake one frame more,</span>
    <span class=c1># otherwise maya.cmds.bakeResults gets confused</span>
    <span class=k>if</span> <span class=n>frame_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>frame_range</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span>
        <span class=n>frame_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>

    <span class=c1># Bake it</span>
    <span class=k>with</span> <span class=n>keytangent_default</span><span class=p>(</span><span class=n>in_tangent_type</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
                            <span class=n>out_tangent_type</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>):</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>bakeResults</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span>
                         <span class=n>simulation</span><span class=o>=</span><span class=n>simulation</span><span class=p>,</span>
                         <span class=n>preserveOutsideKeys</span><span class=o>=</span><span class=n>preserve_outside_keys</span><span class=p>,</span>
                         <span class=n>disableImplicitControl</span><span class=o>=</span><span class=n>disable_implicit_control</span><span class=p>,</span>
                         <span class=n>shape</span><span class=o>=</span><span class=n>shape</span><span class=p>,</span>
                         <span class=n>sampleBy</span><span class=o>=</span><span class=n>step</span><span class=p>,</span>
                         <span class=n>time</span><span class=o>=</span><span class=p>(</span><span class=n>frame_range</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>frame_range</span><span class=p>[</span><span class=mi>1</span><span class=p>]))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.bake_to_world_space class="doc doc-heading"> <code class="highlight language-python"><span class=n>bake_to_world_space</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>frame_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>simulation</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>preserve_outside_keys</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>disable_implicit_control</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>shape</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Bake the nodes to world space transformation (incl. other attributes)</p> <p>Bakes the transforms to world space (while maintaining all its animated attributes and settings) by duplicating the node. Then parents it to world and constrains to the original.</p> <p>Other attributes are also baked by connecting all attributes directly. Baking is then done using Maya's bakeResults command.</p> <p>See <code>bake</code> for the argument documentation.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>The newly created and baked node names.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2991</span>
<span class=normal>2992</span>
<span class=normal>2993</span>
<span class=normal>2994</span>
<span class=normal>2995</span>
<span class=normal>2996</span>
<span class=normal>2997</span>
<span class=normal>2998</span>
<span class=normal>2999</span>
<span class=normal>3000</span>
<span class=normal>3001</span>
<span class=normal>3002</span>
<span class=normal>3003</span>
<span class=normal>3004</span>
<span class=normal>3005</span>
<span class=normal>3006</span>
<span class=normal>3007</span>
<span class=normal>3008</span>
<span class=normal>3009</span>
<span class=normal>3010</span>
<span class=normal>3011</span>
<span class=normal>3012</span>
<span class=normal>3013</span>
<span class=normal>3014</span>
<span class=normal>3015</span>
<span class=normal>3016</span>
<span class=normal>3017</span>
<span class=normal>3018</span>
<span class=normal>3019</span>
<span class=normal>3020</span>
<span class=normal>3021</span>
<span class=normal>3022</span>
<span class=normal>3023</span>
<span class=normal>3024</span>
<span class=normal>3025</span>
<span class=normal>3026</span>
<span class=normal>3027</span>
<span class=normal>3028</span>
<span class=normal>3029</span>
<span class=normal>3030</span>
<span class=normal>3031</span>
<span class=normal>3032</span>
<span class=normal>3033</span>
<span class=normal>3034</span>
<span class=normal>3035</span>
<span class=normal>3036</span>
<span class=normal>3037</span>
<span class=normal>3038</span>
<span class=normal>3039</span>
<span class=normal>3040</span>
<span class=normal>3041</span>
<span class=normal>3042</span>
<span class=normal>3043</span>
<span class=normal>3044</span>
<span class=normal>3045</span>
<span class=normal>3046</span>
<span class=normal>3047</span>
<span class=normal>3048</span>
<span class=normal>3049</span>
<span class=normal>3050</span>
<span class=normal>3051</span>
<span class=normal>3052</span>
<span class=normal>3053</span>
<span class=normal>3054</span>
<span class=normal>3055</span>
<span class=normal>3056</span>
<span class=normal>3057</span>
<span class=normal>3058</span>
<span class=normal>3059</span>
<span class=normal>3060</span>
<span class=normal>3061</span>
<span class=normal>3062</span>
<span class=normal>3063</span>
<span class=normal>3064</span>
<span class=normal>3065</span>
<span class=normal>3066</span>
<span class=normal>3067</span>
<span class=normal>3068</span>
<span class=normal>3069</span>
<span class=normal>3070</span>
<span class=normal>3071</span>
<span class=normal>3072</span>
<span class=normal>3073</span>
<span class=normal>3074</span>
<span class=normal>3075</span>
<span class=normal>3076</span>
<span class=normal>3077</span>
<span class=normal>3078</span>
<span class=normal>3079</span>
<span class=normal>3080</span>
<span class=normal>3081</span>
<span class=normal>3082</span>
<span class=normal>3083</span>
<span class=normal>3084</span>
<span class=normal>3085</span>
<span class=normal>3086</span>
<span class=normal>3087</span>
<span class=normal>3088</span>
<span class=normal>3089</span>
<span class=normal>3090</span>
<span class=normal>3091</span>
<span class=normal>3092</span>
<span class=normal>3093</span>
<span class=normal>3094</span>
<span class=normal>3095</span>
<span class=normal>3096</span>
<span class=normal>3097</span>
<span class=normal>3098</span>
<span class=normal>3099</span>
<span class=normal>3100</span>
<span class=normal>3101</span>
<span class=normal>3102</span>
<span class=normal>3103</span>
<span class=normal>3104</span>
<span class=normal>3105</span>
<span class=normal>3106</span>
<span class=normal>3107</span>
<span class=normal>3108</span>
<span class=normal>3109</span>
<span class=normal>3110</span>
<span class=normal>3111</span>
<span class=normal>3112</span>
<span class=normal>3113</span>
<span class=normal>3114</span>
<span class=normal>3115</span>
<span class=normal>3116</span>
<span class=normal>3117</span>
<span class=normal>3118</span>
<span class=normal>3119</span>
<span class=normal>3120</span>
<span class=normal>3121</span>
<span class=normal>3122</span>
<span class=normal>3123</span>
<span class=normal>3124</span>
<span class=normal>3125</span>
<span class=normal>3126</span>
<span class=normal>3127</span>
<span class=normal>3128</span>
<span class=normal>3129</span>
<span class=normal>3130</span>
<span class=normal>3131</span>
<span class=normal>3132</span>
<span class=normal>3133</span>
<span class=normal>3134</span>
<span class=normal>3135</span>
<span class=normal>3136</span>
<span class=normal>3137</span>
<span class=normal>3138</span>
<span class=normal>3139</span>
<span class=normal>3140</span>
<span class=normal>3141</span>
<span class=normal>3142</span>
<span class=normal>3143</span>
<span class=normal>3144</span>
<span class=normal>3145</span>
<span class=normal>3146</span>
<span class=normal>3147</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>bake_to_world_space</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span>
                        <span class=n>frame_range</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
                        <span class=n>simulation</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                        <span class=n>preserve_outside_keys</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                        <span class=n>disable_implicit_control</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                        <span class=n>shape</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                        <span class=n>step</span><span class=o>=</span><span class=mf>1.0</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Bake the nodes to world space transformation (incl. other attributes)</span>

<span class=sd>    Bakes the transforms to world space (while maintaining all its animated</span>
<span class=sd>    attributes and settings) by duplicating the node. Then parents it to world</span>
<span class=sd>    and constrains to the original.</span>

<span class=sd>    Other attributes are also baked by connecting all attributes directly.</span>
<span class=sd>    Baking is then done using Maya&#39;s bakeResults command.</span>

<span class=sd>    See `bake` for the argument documentation.</span>

<span class=sd>    Returns:</span>
<span class=sd>         list: The newly created and baked node names.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_unlock_attr</span><span class=p>(</span><span class=n>attr</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Unlock attribute during context if it is locked&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>lock</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
            <span class=c1># If not locked, do nothing</span>
            <span class=k>yield</span>
            <span class=k>return</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>lock</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
            <span class=k>yield</span>
        <span class=k>finally</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>lock</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_get_attrs</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Workaround for buggy shape attribute listing with listAttr</span>

<span class=sd>        This will only return keyable settable attributes that have an</span>
<span class=sd>        incoming connections (those that have a reason to be baked).</span>

<span class=sd>        Technically this *may* fail to return attributes driven by complex</span>
<span class=sd>        expressions for which maya makes no connections, e.g. doing actual</span>
<span class=sd>        `setAttr` calls in expressions.</span>

<span class=sd>        Arguments:</span>
<span class=sd>            node (str): The node to list attributes for.</span>

<span class=sd>        Returns:</span>
<span class=sd>            list: Keyable attributes with incoming connections.</span>
<span class=sd>                The attribute may be locked.</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=n>attrs</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listAttr</span><span class=p>(</span><span class=n>node</span><span class=p>,</span>
                              <span class=n>write</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                              <span class=n>scalar</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                              <span class=n>settable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                              <span class=n>connectable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                              <span class=n>keyable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                              <span class=n>shortNames</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
        <span class=n>valid_attrs</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>attrs</span><span class=p>:</span>
            <span class=n>node_attr</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=si>{0}</span><span class=s1>.</span><span class=si>{1}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>

            <span class=c1># Sometimes Maya returns &#39;non-existent&#39; attributes for shapes</span>
            <span class=c1># so we filter those out</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
                <span class=k>continue</span>

            <span class=c1># We only need those that have a connection, just to be safe</span>
            <span class=c1># that it&#39;s actually keyable/connectable anyway.</span>
            <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>connectionInfo</span><span class=p>(</span><span class=n>node_attr</span><span class=p>,</span>
                                   <span class=n>isDestination</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
                <span class=n>valid_attrs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>attr</span><span class=p>)</span>

        <span class=k>return</span> <span class=n>valid_attrs</span>

    <span class=n>transform_attrs</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;t&quot;</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>,</span> <span class=s2>&quot;s&quot;</span><span class=p>,</span>
                       <span class=s2>&quot;tx&quot;</span><span class=p>,</span> <span class=s2>&quot;ty&quot;</span><span class=p>,</span> <span class=s2>&quot;tz&quot;</span><span class=p>,</span>
                       <span class=s2>&quot;rx&quot;</span><span class=p>,</span> <span class=s2>&quot;ry&quot;</span><span class=p>,</span> <span class=s2>&quot;rz&quot;</span><span class=p>,</span>
                       <span class=s2>&quot;sx&quot;</span><span class=p>,</span> <span class=s2>&quot;sy&quot;</span><span class=p>,</span> <span class=s2>&quot;sz&quot;</span><span class=p>}</span>

    <span class=n>world_space_nodes</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>with</span> <span class=n>contextlib</span><span class=o>.</span><span class=n>ExitStack</span><span class=p>()</span> <span class=k>as</span> <span class=n>stack</span><span class=p>:</span>
        <span class=n>delete_bin</span> <span class=o>=</span> <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>delete_after</span><span class=p>())</span>
        <span class=c1># Create the duplicate nodes that are in world-space connected to</span>
        <span class=c1># the originals</span>
        <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>

            <span class=c1># Duplicate the node</span>
            <span class=n>short_name</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
            <span class=n>new_name</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>_baked&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>short_name</span><span class=p>)</span>
            <span class=n>new_node</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>duplicate</span><span class=p>(</span><span class=n>node</span><span class=p>,</span>
                                      <span class=n>name</span><span class=o>=</span><span class=n>new_name</span><span class=p>,</span>
                                      <span class=n>renameChildren</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># noqa</span>

            <span class=c1># Parent new node to world</span>
            <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>new_node</span><span class=p>,</span> <span class=n>parent</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
                <span class=n>new_node</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>parent</span><span class=p>(</span><span class=n>new_node</span><span class=p>,</span> <span class=n>world</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

            <span class=c1># Temporarily unlock and passthrough connect all attributes</span>
            <span class=c1># so we can bake them over time</span>
            <span class=c1># Skip transform attributes because we will constrain them later</span>
            <span class=n>attrs</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>_get_attrs</span><span class=p>(</span><span class=n>node</span><span class=p>))</span> <span class=o>-</span> <span class=n>transform_attrs</span>
            <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>attrs</span><span class=p>:</span>
                <span class=n>orig_node_attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>
                <span class=n>new_node_attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>new_node</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>

                <span class=c1># unlock during context to avoid connection errors</span>
                <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>_unlock_attr</span><span class=p>(</span><span class=n>new_node_attr</span><span class=p>))</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>connectAttr</span><span class=p>(</span><span class=n>orig_node_attr</span><span class=p>,</span>
                                 <span class=n>new_node_attr</span><span class=p>,</span>
                                 <span class=n>force</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

            <span class=c1># If shapes are also baked then also temporarily unlock and</span>
            <span class=c1># passthrough connect all shape attributes for baking</span>
            <span class=k>if</span> <span class=n>shape</span><span class=p>:</span>
                <span class=n>children_shapes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>new_node</span><span class=p>,</span>
                                                     <span class=n>children</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                     <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                     <span class=n>shapes</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>children_shapes</span><span class=p>:</span>
                    <span class=n>orig_children_shapes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>node</span><span class=p>,</span>
                                                              <span class=n>children</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                              <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                              <span class=n>shapes</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                    <span class=k>for</span> <span class=n>orig_shape</span><span class=p>,</span> <span class=n>new_shape</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>orig_children_shapes</span><span class=p>,</span>
                                                     <span class=n>children_shapes</span><span class=p>):</span>
                        <span class=n>attrs</span> <span class=o>=</span> <span class=n>_get_attrs</span><span class=p>(</span><span class=n>orig_shape</span><span class=p>)</span>
                        <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>attrs</span><span class=p>:</span>
                            <span class=n>orig_node_attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>orig_shape</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>
                            <span class=n>new_node_attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>new_shape</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>

                            <span class=c1># unlock during context to avoid connection errors</span>
                            <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>_unlock_attr</span><span class=p>(</span><span class=n>new_node_attr</span><span class=p>))</span>
                            <span class=n>cmds</span><span class=o>.</span><span class=n>connectAttr</span><span class=p>(</span><span class=n>orig_node_attr</span><span class=p>,</span>
                                             <span class=n>new_node_attr</span><span class=p>,</span>
                                             <span class=n>force</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

            <span class=c1># Constraint transforms</span>
            <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>transform_attrs</span><span class=p>:</span>
                <span class=n>transform_attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>new_node</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>
                <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>_unlock_attr</span><span class=p>(</span><span class=n>transform_attr</span><span class=p>))</span>
            <span class=n>delete_bin</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>parentConstraint</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>new_node</span><span class=p>,</span> <span class=n>mo</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>
            <span class=n>delete_bin</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>scaleConstraint</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>new_node</span><span class=p>,</span> <span class=n>mo</span><span class=o>=</span><span class=kc>False</span><span class=p>))</span>

            <span class=n>world_space_nodes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>new_node</span><span class=p>)</span>

        <span class=n>bake</span><span class=p>(</span><span class=n>world_space_nodes</span><span class=p>,</span>
             <span class=n>frame_range</span><span class=o>=</span><span class=n>frame_range</span><span class=p>,</span>
             <span class=n>step</span><span class=o>=</span><span class=n>step</span><span class=p>,</span>
             <span class=n>simulation</span><span class=o>=</span><span class=n>simulation</span><span class=p>,</span>
             <span class=n>preserve_outside_keys</span><span class=o>=</span><span class=n>preserve_outside_keys</span><span class=p>,</span>
             <span class=n>disable_implicit_control</span><span class=o>=</span><span class=n>disable_implicit_control</span><span class=p>,</span>
             <span class=n>shape</span><span class=o>=</span><span class=n>shape</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>world_space_nodes</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.collect_animation_defs class="doc doc-heading"> <code class="highlight language-python"><span class=n>collect_animation_defs</span><span class=p>(</span><span class=n>fps</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>create_context</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the basic animation attribute definitions for the publisher.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>fps</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include <code>fps</code> attribute definition.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>create_context</code> </td> <td> <code><span title=ayon_core.pipeline.create.CreateContext>CreateContext</span> | None</code> </td> <td> <div class=doc-md-description> <p>When provided the context of publisher will be used to define the defaults for the attributes. Depending on project settings this may then use the entity's frame range and FPS instead of the current scene values.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>List[NumberDef]: List of number attribute definitions.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>603</span>
<span class=normal>604</span>
<span class=normal>605</span>
<span class=normal>606</span>
<span class=normal>607</span>
<span class=normal>608</span>
<span class=normal>609</span>
<span class=normal>610</span>
<span class=normal>611</span>
<span class=normal>612</span>
<span class=normal>613</span>
<span class=normal>614</span>
<span class=normal>615</span>
<span class=normal>616</span>
<span class=normal>617</span>
<span class=normal>618</span>
<span class=normal>619</span>
<span class=normal>620</span>
<span class=normal>621</span>
<span class=normal>622</span>
<span class=normal>623</span>
<span class=normal>624</span>
<span class=normal>625</span>
<span class=normal>626</span>
<span class=normal>627</span>
<span class=normal>628</span>
<span class=normal>629</span>
<span class=normal>630</span>
<span class=normal>631</span>
<span class=normal>632</span>
<span class=normal>633</span>
<span class=normal>634</span>
<span class=normal>635</span>
<span class=normal>636</span>
<span class=normal>637</span>
<span class=normal>638</span>
<span class=normal>639</span>
<span class=normal>640</span>
<span class=normal>641</span>
<span class=normal>642</span>
<span class=normal>643</span>
<span class=normal>644</span>
<span class=normal>645</span>
<span class=normal>646</span>
<span class=normal>647</span>
<span class=normal>648</span>
<span class=normal>649</span>
<span class=normal>650</span>
<span class=normal>651</span>
<span class=normal>652</span>
<span class=normal>653</span>
<span class=normal>654</span>
<span class=normal>655</span>
<span class=normal>656</span>
<span class=normal>657</span>
<span class=normal>658</span>
<span class=normal>659</span>
<span class=normal>660</span>
<span class=normal>661</span>
<span class=normal>662</span>
<span class=normal>663</span>
<span class=normal>664</span>
<span class=normal>665</span>
<span class=normal>666</span>
<span class=normal>667</span>
<span class=normal>668</span>
<span class=normal>669</span>
<span class=normal>670</span>
<span class=normal>671</span>
<span class=normal>672</span>
<span class=normal>673</span>
<span class=normal>674</span>
<span class=normal>675</span>
<span class=normal>676</span>
<span class=normal>677</span>
<span class=normal>678</span>
<span class=normal>679</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>collect_animation_defs</span><span class=p>(</span><span class=n>fps</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>create_context</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the basic animation attribute definitions for the publisher.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        fps (bool): Whether to include `fps` attribute definition.</span>
<span class=sd>        create_context (CreateContext | None): When provided the context of</span>
<span class=sd>            publisher will be used to define the defaults for the attributes.</span>
<span class=sd>            Depending on project settings this may then use the entity&#39;s frame</span>
<span class=sd>            range and FPS instead of the current scene values.</span>

<span class=sd>    Returns:</span>
<span class=sd>        List[NumberDef]: List of number attribute definitions.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>use_entity_frame_range</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=k>if</span> <span class=n>create_context</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>project_settings</span> <span class=o>=</span> <span class=n>create_context</span><span class=o>.</span><span class=n>get_current_project_settings</span><span class=p>()</span>
        <span class=n>use_entity_frame_range</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=n>project_settings</span><span class=p>[</span><span class=s2>&quot;maya&quot;</span><span class=p>][</span><span class=s2>&quot;create&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
            <span class=s2>&quot;use_entity_attributes_as_defaults&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>create_context</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=n>use_entity_frame_range</span><span class=p>:</span>
        <span class=n>task_entity</span> <span class=o>=</span> <span class=n>create_context</span><span class=o>.</span><span class=n>get_current_task_entity</span><span class=p>()</span>
        <span class=n>frame_start</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;frameStart&quot;</span><span class=p>]</span>
        <span class=n>frame_end</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>]</span>
        <span class=n>handle_start</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;handleStart&quot;</span><span class=p>]</span>
        <span class=n>handle_end</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;handleEnd&quot;</span><span class=p>]</span>
        <span class=n>default_fps</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;fps&quot;</span><span class=p>]</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># get scene values as defaults</span>
        <span class=n>frame_start</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>minTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>frame_end</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>maxTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>frame_start_handle</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>animationStartTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>frame_end_handle</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>animationEndTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=n>handle_start</span> <span class=o>=</span> <span class=n>frame_start</span> <span class=o>-</span> <span class=n>frame_start_handle</span>
        <span class=n>handle_end</span> <span class=o>=</span> <span class=n>frame_end_handle</span> <span class=o>-</span> <span class=n>frame_end</span>
        <span class=n>default_fps</span> <span class=o>=</span> <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;currentTimeUnitToFPS()&#39;</span><span class=p>)</span>

    <span class=c1># build attributes</span>
    <span class=n>defs</span> <span class=o>=</span> <span class=p>[</span>
        <span class=n>NumberDef</span><span class=p>(</span><span class=s2>&quot;frameStart&quot;</span><span class=p>,</span>
                  <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Frame Start&quot;</span><span class=p>,</span>
                  <span class=n>default</span><span class=o>=</span><span class=n>frame_start</span><span class=p>,</span>
                  <span class=n>decimals</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span>
        <span class=n>NumberDef</span><span class=p>(</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>,</span>
                  <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Frame End&quot;</span><span class=p>,</span>
                  <span class=n>default</span><span class=o>=</span><span class=n>frame_end</span><span class=p>,</span>
                  <span class=n>decimals</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span>
        <span class=n>NumberDef</span><span class=p>(</span><span class=s2>&quot;handleStart&quot;</span><span class=p>,</span>
                  <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Handle Start&quot;</span><span class=p>,</span>
                  <span class=n>default</span><span class=o>=</span><span class=n>handle_start</span><span class=p>,</span>
                  <span class=n>decimals</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span>
        <span class=n>NumberDef</span><span class=p>(</span><span class=s2>&quot;handleEnd&quot;</span><span class=p>,</span>
                  <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Handle End&quot;</span><span class=p>,</span>
                  <span class=n>default</span><span class=o>=</span><span class=n>handle_end</span><span class=p>,</span>
                  <span class=n>decimals</span><span class=o>=</span><span class=mi>0</span><span class=p>),</span>
        <span class=n>NumberDef</span><span class=p>(</span><span class=s2>&quot;step&quot;</span><span class=p>,</span>
                  <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Step size&quot;</span><span class=p>,</span>
                  <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;A smaller step size means more samples and larger &quot;</span>
                          <span class=s2>&quot;output files.</span><span class=se>\n</span><span class=s2>&quot;</span>
                          <span class=s2>&quot;A 1.0 step size is a single sample every frame.</span><span class=se>\n</span><span class=s2>&quot;</span>
                          <span class=s2>&quot;A 0.5 step size is two samples per frame.</span><span class=se>\n</span><span class=s2>&quot;</span>
                          <span class=s2>&quot;A 0.2 step size is five samples per frame.&quot;</span><span class=p>,</span>
                  <span class=n>default</span><span class=o>=</span><span class=mf>1.0</span><span class=p>,</span>
                  <span class=n>decimals</span><span class=o>=</span><span class=mi>3</span><span class=p>),</span>
    <span class=p>]</span>

    <span class=k>if</span> <span class=n>fps</span><span class=p>:</span>
        <span class=n>fps_def</span> <span class=o>=</span> <span class=n>NumberDef</span><span class=p>(</span>
            <span class=s2>&quot;fps&quot;</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s2>&quot;FPS&quot;</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>default_fps</span><span class=p>,</span> <span class=n>decimals</span><span class=o>=</span><span class=mi>5</span>
        <span class=p>)</span>
        <span class=n>defs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fps_def</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>defs</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.convert_to_maya_fps class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_to_maya_fps</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert any fps to supported Maya framerates.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3853</span>
<span class=normal>3854</span>
<span class=normal>3855</span>
<span class=normal>3856</span>
<span class=normal>3857</span>
<span class=normal>3858</span>
<span class=normal>3859</span>
<span class=normal>3860</span>
<span class=normal>3861</span>
<span class=normal>3862</span>
<span class=normal>3863</span>
<span class=normal>3864</span>
<span class=normal>3865</span>
<span class=normal>3866</span>
<span class=normal>3867</span>
<span class=normal>3868</span>
<span class=normal>3869</span>
<span class=normal>3870</span>
<span class=normal>3871</span>
<span class=normal>3872</span>
<span class=normal>3873</span>
<span class=normal>3874</span>
<span class=normal>3875</span>
<span class=normal>3876</span>
<span class=normal>3877</span>
<span class=normal>3878</span>
<span class=normal>3879</span>
<span class=normal>3880</span>
<span class=normal>3881</span>
<span class=normal>3882</span>
<span class=normal>3883</span>
<span class=normal>3884</span>
<span class=normal>3885</span>
<span class=normal>3886</span>
<span class=normal>3887</span>
<span class=normal>3888</span>
<span class=normal>3889</span>
<span class=normal>3890</span>
<span class=normal>3891</span>
<span class=normal>3892</span>
<span class=normal>3893</span>
<span class=normal>3894</span>
<span class=normal>3895</span>
<span class=normal>3896</span>
<span class=normal>3897</span>
<span class=normal>3898</span>
<span class=normal>3899</span>
<span class=normal>3900</span>
<span class=normal>3901</span>
<span class=normal>3902</span>
<span class=normal>3903</span>
<span class=normal>3904</span>
<span class=normal>3905</span>
<span class=normal>3906</span>
<span class=normal>3907</span>
<span class=normal>3908</span>
<span class=normal>3909</span>
<span class=normal>3910</span>
<span class=normal>3911</span>
<span class=normal>3912</span>
<span class=normal>3913</span>
<span class=normal>3914</span>
<span class=normal>3915</span>
<span class=normal>3916</span>
<span class=normal>3917</span>
<span class=normal>3918</span>
<span class=normal>3919</span>
<span class=normal>3920</span>
<span class=normal>3921</span>
<span class=normal>3922</span>
<span class=normal>3923</span>
<span class=normal>3924</span>
<span class=normal>3925</span>
<span class=normal>3926</span>
<span class=normal>3927</span>
<span class=normal>3928</span>
<span class=normal>3929</span>
<span class=normal>3930</span>
<span class=normal>3931</span>
<span class=normal>3932</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>convert_to_maya_fps</span><span class=p>(</span><span class=n>fps</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert any fps to supported Maya framerates.&quot;&quot;&quot;</span>
    <span class=n>float_framerates</span> <span class=o>=</span> <span class=p>[</span>
        <span class=mf>23.976023976023978</span><span class=p>,</span>
        <span class=c1># WTF is 29.97 df vs fps?</span>
        <span class=mf>29.97002997002997</span><span class=p>,</span>
        <span class=mf>47.952047952047955</span><span class=p>,</span>
        <span class=mf>59.94005994005994</span>
    <span class=p>]</span>
    <span class=c1># 44100 fps evaluates as 41000.0. Why? Omitting for now.</span>
    <span class=n>int_framerates</span> <span class=o>=</span> <span class=p>[</span>
        <span class=mi>2</span><span class=p>,</span>
        <span class=mi>3</span><span class=p>,</span>
        <span class=mi>4</span><span class=p>,</span>
        <span class=mi>5</span><span class=p>,</span>
        <span class=mi>6</span><span class=p>,</span>
        <span class=mi>8</span><span class=p>,</span>
        <span class=mi>10</span><span class=p>,</span>
        <span class=mi>12</span><span class=p>,</span>
        <span class=mi>15</span><span class=p>,</span>
        <span class=mi>16</span><span class=p>,</span>
        <span class=mi>20</span><span class=p>,</span>
        <span class=mi>24</span><span class=p>,</span>
        <span class=mi>25</span><span class=p>,</span>
        <span class=mi>30</span><span class=p>,</span>
        <span class=mi>40</span><span class=p>,</span>
        <span class=mi>48</span><span class=p>,</span>
        <span class=mi>50</span><span class=p>,</span>
        <span class=mi>60</span><span class=p>,</span>
        <span class=mi>75</span><span class=p>,</span>
        <span class=mi>80</span><span class=p>,</span>
        <span class=mi>90</span><span class=p>,</span>
        <span class=mi>100</span><span class=p>,</span>
        <span class=mi>120</span><span class=p>,</span>
        <span class=mi>125</span><span class=p>,</span>
        <span class=mi>150</span><span class=p>,</span>
        <span class=mi>200</span><span class=p>,</span>
        <span class=mi>240</span><span class=p>,</span>
        <span class=mi>250</span><span class=p>,</span>
        <span class=mi>300</span><span class=p>,</span>
        <span class=mi>375</span><span class=p>,</span>
        <span class=mi>400</span><span class=p>,</span>
        <span class=mi>500</span><span class=p>,</span>
        <span class=mi>600</span><span class=p>,</span>
        <span class=mi>750</span><span class=p>,</span>
        <span class=mi>1200</span><span class=p>,</span>
        <span class=mi>1500</span><span class=p>,</span>
        <span class=mi>2000</span><span class=p>,</span>
        <span class=mi>3000</span><span class=p>,</span>
        <span class=mi>6000</span><span class=p>,</span>
        <span class=mi>48000</span>
    <span class=p>]</span>

    <span class=c1># If input fps is a whole number we&#39;ll return.</span>
    <span class=k>if</span> <span class=nb>float</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span><span class=o>.</span><span class=n>is_integer</span><span class=p>():</span>
        <span class=c1># Validate fps is part of Maya&#39;s fps selection.</span>
        <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>int_framerates</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                <span class=s2>&quot;Framerate </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2> is not supported in Maya&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span>
            <span class=p>)</span>
        <span class=k>return</span> <span class=nb>int</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=c1># Differences to supported float frame rates.</span>
        <span class=n>differences</span> <span class=o>=</span> <span class=p>[]</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>float_framerates</span><span class=p>:</span>
            <span class=n>differences</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=n>fps</span><span class=p>))</span>

        <span class=c1># Validate difference does not stray too far from supported framerates.</span>
        <span class=n>min_difference</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>differences</span><span class=p>)</span>
        <span class=n>min_index</span> <span class=o>=</span> <span class=n>differences</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>min_difference</span><span class=p>)</span>
        <span class=n>supported_framerate</span> <span class=o>=</span> <span class=n>float_framerates</span><span class=p>[</span><span class=n>min_index</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>min_difference</span> <span class=o>&gt;</span> <span class=mf>0.1</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
                <span class=s2>&quot;Framerate </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2> strays too far from any supported framerate&quot;</span>
                <span class=s2>&quot; in Maya. Closest supported framerate is </span><span class=se>\&quot;</span><span class=si>{}</span><span class=se>\&quot;</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                    <span class=n>fps</span><span class=p>,</span> <span class=n>supported_framerate</span>
                <span class=p>)</span>
            <span class=p>)</span>

        <span class=k>return</span> <span class=n>supported_framerate</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.create_camera_instance class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_camera_instance</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>namespace</span><span class=p>,</span> <span class=n>options</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create a camera instance from the loaded camera nodes.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>The loaded camera nodes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>context</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Representation context of the camera container.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>namespace</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The namespace for the new camera instance.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>options</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Additional options for the camera instance.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>Logger to log to if provided.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4419</span>
<span class=normal>4420</span>
<span class=normal>4421</span>
<span class=normal>4422</span>
<span class=normal>4423</span>
<span class=normal>4424</span>
<span class=normal>4425</span>
<span class=normal>4426</span>
<span class=normal>4427</span>
<span class=normal>4428</span>
<span class=normal>4429</span>
<span class=normal>4430</span>
<span class=normal>4431</span>
<span class=normal>4432</span>
<span class=normal>4433</span>
<span class=normal>4434</span>
<span class=normal>4435</span>
<span class=normal>4436</span>
<span class=normal>4437</span>
<span class=normal>4438</span>
<span class=normal>4439</span>
<span class=normal>4440</span>
<span class=normal>4441</span>
<span class=normal>4442</span>
<span class=normal>4443</span>
<span class=normal>4444</span>
<span class=normal>4445</span>
<span class=normal>4446</span>
<span class=normal>4447</span>
<span class=normal>4448</span>
<span class=normal>4449</span>
<span class=normal>4450</span>
<span class=normal>4451</span>
<span class=normal>4452</span>
<span class=normal>4453</span>
<span class=normal>4454</span>
<span class=normal>4455</span>
<span class=normal>4456</span>
<span class=normal>4457</span>
<span class=normal>4458</span>
<span class=normal>4459</span>
<span class=normal>4460</span>
<span class=normal>4461</span>
<span class=normal>4462</span>
<span class=normal>4463</span>
<span class=normal>4464</span>
<span class=normal>4465</span>
<span class=normal>4466</span>
<span class=normal>4467</span>
<span class=normal>4468</span>
<span class=normal>4469</span>
<span class=normal>4470</span>
<span class=normal>4471</span>
<span class=normal>4472</span>
<span class=normal>4473</span>
<span class=normal>4474</span>
<span class=normal>4475</span>
<span class=normal>4476</span>
<span class=normal>4477</span>
<span class=normal>4478</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>create_camera_instance</span><span class=p>(</span>
        <span class=n>nodes</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>namespace</span><span class=p>,</span> <span class=n>options</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create a camera instance from the loaded camera nodes.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (list): The loaded camera nodes.</span>
<span class=sd>        context (dict): Representation context of the camera container.</span>
<span class=sd>        namespace (str): The namespace for the new camera instance.</span>
<span class=sd>        options (dict, optional): Additional options for the camera instance.</span>
<span class=sd>        log (logging.Logger, optional): Logger to log to if provided.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>options</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>options</span> <span class=o>=</span> <span class=p>{}</span>

    <span class=n>referenced_nodes</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
        <span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span> 
        <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>referenceQuery</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>isNodeReferenced</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=p>]</span>
    <span class=n>camera_nodes</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span>
        <span class=n>referenced_nodes</span><span class=p>,</span> <span class=n>children</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;camera&quot;</span><span class=p>,</span> <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span>
    <span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>

    <span class=n>folder_entity</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=n>context</span><span class=p>[</span><span class=s2>&quot;folder&quot;</span><span class=p>]</span>
    <span class=n>product_entity</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=n>context</span><span class=p>[</span><span class=s2>&quot;product&quot;</span><span class=p>]</span>
    <span class=n>product_type</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;productType&quot;</span><span class=p>]</span>
    <span class=n>product_name</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>

    <span class=n>custom_product_name</span> <span class=o>=</span> <span class=n>options</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;cameraProductName&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>custom_product_name</span><span class=p>:</span>
        <span class=n>formatting_data</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>
            <span class=p>},</span>
            <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=n>product_type</span><span class=p>,</span>
                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>product_name</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=s2>&quot;asset&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
            <span class=s2>&quot;subset&quot;</span><span class=p>:</span> <span class=n>product_name</span><span class=p>,</span>
            <span class=s2>&quot;family&quot;</span><span class=p>:</span> <span class=n>product_type</span>
        <span class=p>}</span>
        <span class=n>namespace</span> <span class=o>=</span> <span class=n>get_custom_namespace</span><span class=p>(</span>
            <span class=n>custom_product_name</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=n>formatting_data</span><span class=p>)</span>
        <span class=p>)</span>
    <span class=k>if</span> <span class=n>log</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Creating product: </span><span class=si>{</span><span class=n>namespace</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>

    <span class=c1># Fill creator identifier</span>
    <span class=n>creator_identifier</span> <span class=o>=</span> <span class=s2>&quot;io.openpype.creators.maya.camera&quot;</span>

    <span class=n>host</span> <span class=o>=</span> <span class=n>registered_host</span><span class=p>()</span>
    <span class=n>create_context</span> <span class=o>=</span> <span class=n>CreateContext</span><span class=p>(</span><span class=n>host</span><span class=p>)</span>
    <span class=k>with</span> <span class=n>maintained_selection</span><span class=p>():</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>camera_nodes</span><span class=p>,</span> <span class=n>noExpand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>create_context</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
            <span class=n>creator_identifier</span><span class=o>=</span><span class=n>creator_identifier</span><span class=p>,</span>
            <span class=n>variant</span><span class=o>=</span><span class=n>custom_product_name</span> <span class=k>if</span> <span class=n>custom_product_name</span> <span class=k>else</span> <span class=sa>f</span><span class=s2>&quot;_</span><span class=si>{</span><span class=n>product_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span>
            <span class=n>pre_create_data</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;use_selection&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.create_rig_animation_instance class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_rig_animation_instance</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>namespace</span><span class=p>,</span> <span class=n>options</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Create an animation publish instance for loaded rigs.</p> <p>See the RecreateRigAnimationInstance inventory action on how to use this for loaded rig containers.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>Member nodes of the rig instance.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>context</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Representation context of the rig container</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>namespace</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Namespace of the rig container</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>options</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Additional loader data</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>Logger to log to if provided</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4324</span>
<span class=normal>4325</span>
<span class=normal>4326</span>
<span class=normal>4327</span>
<span class=normal>4328</span>
<span class=normal>4329</span>
<span class=normal>4330</span>
<span class=normal>4331</span>
<span class=normal>4332</span>
<span class=normal>4333</span>
<span class=normal>4334</span>
<span class=normal>4335</span>
<span class=normal>4336</span>
<span class=normal>4337</span>
<span class=normal>4338</span>
<span class=normal>4339</span>
<span class=normal>4340</span>
<span class=normal>4341</span>
<span class=normal>4342</span>
<span class=normal>4343</span>
<span class=normal>4344</span>
<span class=normal>4345</span>
<span class=normal>4346</span>
<span class=normal>4347</span>
<span class=normal>4348</span>
<span class=normal>4349</span>
<span class=normal>4350</span>
<span class=normal>4351</span>
<span class=normal>4352</span>
<span class=normal>4353</span>
<span class=normal>4354</span>
<span class=normal>4355</span>
<span class=normal>4356</span>
<span class=normal>4357</span>
<span class=normal>4358</span>
<span class=normal>4359</span>
<span class=normal>4360</span>
<span class=normal>4361</span>
<span class=normal>4362</span>
<span class=normal>4363</span>
<span class=normal>4364</span>
<span class=normal>4365</span>
<span class=normal>4366</span>
<span class=normal>4367</span>
<span class=normal>4368</span>
<span class=normal>4369</span>
<span class=normal>4370</span>
<span class=normal>4371</span>
<span class=normal>4372</span>
<span class=normal>4373</span>
<span class=normal>4374</span>
<span class=normal>4375</span>
<span class=normal>4376</span>
<span class=normal>4377</span>
<span class=normal>4378</span>
<span class=normal>4379</span>
<span class=normal>4380</span>
<span class=normal>4381</span>
<span class=normal>4382</span>
<span class=normal>4383</span>
<span class=normal>4384</span>
<span class=normal>4385</span>
<span class=normal>4386</span>
<span class=normal>4387</span>
<span class=normal>4388</span>
<span class=normal>4389</span>
<span class=normal>4390</span>
<span class=normal>4391</span>
<span class=normal>4392</span>
<span class=normal>4393</span>
<span class=normal>4394</span>
<span class=normal>4395</span>
<span class=normal>4396</span>
<span class=normal>4397</span>
<span class=normal>4398</span>
<span class=normal>4399</span>
<span class=normal>4400</span>
<span class=normal>4401</span>
<span class=normal>4402</span>
<span class=normal>4403</span>
<span class=normal>4404</span>
<span class=normal>4405</span>
<span class=normal>4406</span>
<span class=normal>4407</span>
<span class=normal>4408</span>
<span class=normal>4409</span>
<span class=normal>4410</span>
<span class=normal>4411</span>
<span class=normal>4412</span>
<span class=normal>4413</span>
<span class=normal>4414</span>
<span class=normal>4415</span>
<span class=normal>4416</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>create_rig_animation_instance</span><span class=p>(</span>
    <span class=n>nodes</span><span class=p>,</span> <span class=n>context</span><span class=p>,</span> <span class=n>namespace</span><span class=p>,</span> <span class=n>options</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Create an animation publish instance for loaded rigs.</span>

<span class=sd>    See the RecreateRigAnimationInstance inventory action on how to use this</span>
<span class=sd>    for loaded rig containers.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        nodes (list): Member nodes of the rig instance.</span>
<span class=sd>        context (dict): Representation context of the rig container</span>
<span class=sd>        namespace (str): Namespace of the rig container</span>
<span class=sd>        options (dict, optional): Additional loader data</span>
<span class=sd>        log (logging.Logger, optional): Logger to log to if provided</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>options</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>options</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>name</span> <span class=o>=</span> <span class=n>context</span><span class=p>[</span><span class=s2>&quot;representation&quot;</span><span class=p>][</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>
    <span class=n>output</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span> <span class=k>if</span>
                   <span class=n>node</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;out_SET&quot;</span><span class=p>)),</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>controls</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span> <span class=k>if</span>
                     <span class=n>node</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;controls_SET&quot;</span><span class=p>)),</span> <span class=kc>None</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>name</span> <span class=o>!=</span> <span class=s2>&quot;fbx&quot;</span><span class=p>:</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>output</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>RigSetsNotExistError</span><span class=p>(</span>
                <span class=s2>&quot;No out_SET in rig. The loaded rig publish is lacking the &quot;</span>
                <span class=s2>&quot;out_SET required for animation instances.&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>controls</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>RigSetsNotExistError</span><span class=p>(</span>
                <span class=s2>&quot;No controls_SET in rig. The loaded rig publish is lacking &quot;</span>
                <span class=s2>&quot;the controls_SET required for animation instances.&quot;</span><span class=p>)</span>

    <span class=n>anim_skeleton</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span> <span class=k>if</span>
                          <span class=n>node</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;skeletonAnim_SET&quot;</span><span class=p>)),</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>skeleton_mesh</span> <span class=o>=</span> <span class=nb>next</span><span class=p>((</span><span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span> <span class=k>if</span>
                          <span class=n>node</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;skeletonMesh_SET&quot;</span><span class=p>)),</span> <span class=kc>None</span><span class=p>)</span>

    <span class=c1># Find the roots amongst the loaded nodes</span>
    <span class=n>roots</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>assemblies</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span>
        <span class=n>get_highest_in_hierarchy</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=k>assert</span> <span class=n>roots</span><span class=p>,</span> <span class=s2>&quot;No root nodes in rig, this is a bug.&quot;</span>

    <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>context</span><span class=p>[</span><span class=s2>&quot;folder&quot;</span><span class=p>]</span>
    <span class=n>product_entity</span> <span class=o>=</span> <span class=n>context</span><span class=p>[</span><span class=s2>&quot;product&quot;</span><span class=p>]</span>
    <span class=n>product_type</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;productType&quot;</span><span class=p>]</span>
    <span class=n>product_name</span> <span class=o>=</span> <span class=n>product_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>

    <span class=n>custom_product_name</span> <span class=o>=</span> <span class=n>options</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;animationProductName&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>custom_product_name</span><span class=p>:</span>
        <span class=n>formatting_data</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;folder&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]</span>
            <span class=p>},</span>
            <span class=s2>&quot;product&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=n>product_type</span><span class=p>,</span>
                <span class=s2>&quot;name&quot;</span><span class=p>:</span> <span class=n>product_name</span><span class=p>,</span>
            <span class=p>},</span>
            <span class=s2>&quot;asset&quot;</span><span class=p>:</span> <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
            <span class=s2>&quot;subset&quot;</span><span class=p>:</span> <span class=n>product_name</span><span class=p>,</span>
            <span class=s2>&quot;family&quot;</span><span class=p>:</span> <span class=n>product_type</span>
        <span class=p>}</span>
        <span class=n>namespace</span> <span class=o>=</span> <span class=n>get_custom_namespace</span><span class=p>(</span>
            <span class=n>custom_product_name</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=o>**</span><span class=n>formatting_data</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=k>if</span> <span class=n>log</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Creating product: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>namespace</span><span class=p>))</span>

    <span class=c1># Fill creator identifier</span>
    <span class=n>creator_identifier</span> <span class=o>=</span> <span class=s2>&quot;io.openpype.creators.maya.animation&quot;</span>

    <span class=n>host</span> <span class=o>=</span> <span class=n>registered_host</span><span class=p>()</span>
    <span class=n>create_context</span> <span class=o>=</span> <span class=n>CreateContext</span><span class=p>(</span><span class=n>host</span><span class=p>)</span>
    <span class=c1># Create the animation instance</span>
    <span class=n>rig_sets</span> <span class=o>=</span> <span class=p>[</span><span class=n>output</span><span class=p>,</span> <span class=n>controls</span><span class=p>,</span> <span class=n>anim_skeleton</span><span class=p>,</span> <span class=n>skeleton_mesh</span><span class=p>]</span>
    <span class=c1># Remove sets that this particular rig does not have</span>
    <span class=n>rig_sets</span> <span class=o>=</span> <span class=p>[</span><span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>rig_sets</span> <span class=k>if</span> <span class=n>s</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>]</span>
    <span class=k>with</span> <span class=n>maintained_selection</span><span class=p>():</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>rig_sets</span> <span class=o>+</span> <span class=n>roots</span><span class=p>,</span> <span class=n>noExpand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>create_context</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
            <span class=n>creator_identifier</span><span class=o>=</span><span class=n>creator_identifier</span><span class=p>,</span>
            <span class=n>variant</span><span class=o>=</span><span class=n>namespace</span><span class=p>,</span>
            <span class=n>pre_create_data</span><span class=o>=</span><span class=p>{</span>
                <span class=s2>&quot;use_selection&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
                <span class=s2>&quot;lock_instance&quot;</span><span class=p>:</span> <span class=n>options</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;lock_instance&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.displaySmoothness class="doc doc-heading"> <code class="highlight language-python"><span class=n>displaySmoothness</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>divisionsU</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>divisionsV</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>pointsWire</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>pointsShaded</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>polygonObject</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set the displaySmoothness during the context</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1118</span>
<span class=normal>1119</span>
<span class=normal>1120</span>
<span class=normal>1121</span>
<span class=normal>1122</span>
<span class=normal>1123</span>
<span class=normal>1124</span>
<span class=normal>1125</span>
<span class=normal>1126</span>
<span class=normal>1127</span>
<span class=normal>1128</span>
<span class=normal>1129</span>
<span class=normal>1130</span>
<span class=normal>1131</span>
<span class=normal>1132</span>
<span class=normal>1133</span>
<span class=normal>1134</span>
<span class=normal>1135</span>
<span class=normal>1136</span>
<span class=normal>1137</span>
<span class=normal>1138</span>
<span class=normal>1139</span>
<span class=normal>1140</span>
<span class=normal>1141</span>
<span class=normal>1142</span>
<span class=normal>1143</span>
<span class=normal>1144</span>
<span class=normal>1145</span>
<span class=normal>1146</span>
<span class=normal>1147</span>
<span class=normal>1148</span>
<span class=normal>1149</span>
<span class=normal>1150</span>
<span class=normal>1151</span>
<span class=normal>1152</span>
<span class=normal>1153</span>
<span class=normal>1154</span>
<span class=normal>1155</span>
<span class=normal>1156</span>
<span class=normal>1157</span>
<span class=normal>1158</span>
<span class=normal>1159</span>
<span class=normal>1160</span>
<span class=normal>1161</span>
<span class=normal>1162</span>
<span class=normal>1163</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>displaySmoothness</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span>
                      <span class=n>divisionsU</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                      <span class=n>divisionsV</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span>
                      <span class=n>pointsWire</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span>
                      <span class=n>pointsShaded</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
                      <span class=n>polygonObject</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the displaySmoothness during the context&quot;&quot;&quot;</span>

    <span class=c1># Ensure only non-intermediate shapes</span>
    <span class=n>nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span>
                    <span class=n>dag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
                    <span class=n>shapes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
                    <span class=n>long</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
                    <span class=n>noIntermediate</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>def</span><span class=w> </span><span class=nf>parse</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Parse the current state of a node&quot;&quot;&quot;</span>
        <span class=n>state</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&quot;divisionsU&quot;</span><span class=p>,</span>
                    <span class=s2>&quot;divisionsV&quot;</span><span class=p>,</span>
                    <span class=s2>&quot;pointsWire&quot;</span><span class=p>,</span>
                    <span class=s2>&quot;pointsShaded&quot;</span><span class=p>,</span>
                    <span class=s2>&quot;polygonObject&quot;</span><span class=p>]:</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>displaySmoothness</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=o>**</span><span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=kc>True</span><span class=p>})</span>
            <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>state</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=k>return</span> <span class=n>state</span>

    <span class=n>originals</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>((</span><span class=n>node</span><span class=p>,</span> <span class=n>parse</span><span class=p>(</span><span class=n>node</span><span class=p>))</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=c1># Apply current state</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>displaySmoothness</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span>
                               <span class=n>divisionsU</span><span class=o>=</span><span class=n>divisionsU</span><span class=p>,</span>
                               <span class=n>divisionsV</span><span class=o>=</span><span class=n>divisionsV</span><span class=p>,</span>
                               <span class=n>pointsWire</span><span class=o>=</span><span class=n>pointsWire</span><span class=p>,</span>
                               <span class=n>pointsShaded</span><span class=o>=</span><span class=n>pointsShaded</span><span class=p>,</span>
                               <span class=n>polygonObject</span><span class=o>=</span><span class=n>polygonObject</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=c1># Revert state</span>
        <span class=n>_iteritems</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>originals</span><span class=p>,</span> <span class=s2>&quot;iteritems&quot;</span><span class=p>,</span> <span class=n>originals</span><span class=o>.</span><span class=n>items</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>state</span> <span class=ow>in</span> <span class=n>_iteritems</span><span class=p>():</span>
            <span class=k>if</span> <span class=n>state</span><span class=p>:</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>displaySmoothness</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=o>**</span><span class=n>state</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.empty_sets class="doc doc-heading"> <code class="highlight language-python"><span class=n>empty_sets</span><span class=p>(</span><span class=n>sets</span><span class=p>,</span> <span class=n>force</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Remove all members of the sets during the context</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>890</span>
<span class=normal>891</span>
<span class=normal>892</span>
<span class=normal>893</span>
<span class=normal>894</span>
<span class=normal>895</span>
<span class=normal>896</span>
<span class=normal>897</span>
<span class=normal>898</span>
<span class=normal>899</span>
<span class=normal>900</span>
<span class=normal>901</span>
<span class=normal>902</span>
<span class=normal>903</span>
<span class=normal>904</span>
<span class=normal>905</span>
<span class=normal>906</span>
<span class=normal>907</span>
<span class=normal>908</span>
<span class=normal>909</span>
<span class=normal>910</span>
<span class=normal>911</span>
<span class=normal>912</span>
<span class=normal>913</span>
<span class=normal>914</span>
<span class=normal>915</span>
<span class=normal>916</span>
<span class=normal>917</span>
<span class=normal>918</span>
<span class=normal>919</span>
<span class=normal>920</span>
<span class=normal>921</span>
<span class=normal>922</span>
<span class=normal>923</span>
<span class=normal>924</span>
<span class=normal>925</span>
<span class=normal>926</span>
<span class=normal>927</span>
<span class=normal>928</span>
<span class=normal>929</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>empty_sets</span><span class=p>(</span><span class=n>sets</span><span class=p>,</span> <span class=n>force</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remove all members of the sets during the context&quot;&quot;&quot;</span>

    <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>sets</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>))</span>

    <span class=n>original</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
    <span class=n>original_connections</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=c1># Store original state</span>
    <span class=k>for</span> <span class=n>obj_set</span> <span class=ow>in</span> <span class=n>sets</span><span class=p>:</span>
        <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>obj_set</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>original</span><span class=p>[</span><span class=n>obj_set</span><span class=p>]</span> <span class=o>=</span> <span class=n>members</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>obj_set</span> <span class=ow>in</span> <span class=n>sets</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>clear</span><span class=o>=</span><span class=n>obj_set</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>force</span><span class=p>:</span>
                <span class=c1># Break all connections if force is enabled, this way we</span>
                <span class=c1># prevent Maya from exporting any reference nodes which are</span>
                <span class=c1># connected with placeHolder[x] attributes</span>
                <span class=n>plug</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>%s</span><span class=s2>.dagSetMembers&quot;</span> <span class=o>%</span> <span class=n>obj_set</span>
                <span class=n>connections</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span><span class=n>plug</span><span class=p>,</span>
                                                   <span class=n>source</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                   <span class=n>destination</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                                   <span class=n>plugs</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                   <span class=n>connections</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
                <span class=n>original_connections</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>connections</span><span class=p>)</span>
                <span class=k>for</span> <span class=n>dest</span><span class=p>,</span> <span class=n>src</span> <span class=ow>in</span> <span class=n>pairwise</span><span class=p>(</span><span class=n>connections</span><span class=p>):</span>
                    <span class=n>cmds</span><span class=o>.</span><span class=n>disconnectAttr</span><span class=p>(</span><span class=n>src</span><span class=p>,</span> <span class=n>dest</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>

        <span class=k>for</span> <span class=n>dest</span><span class=p>,</span> <span class=n>src</span> <span class=ow>in</span> <span class=n>pairwise</span><span class=p>(</span><span class=n>original_connections</span><span class=p>):</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>connectAttr</span><span class=p>(</span><span class=n>src</span><span class=p>,</span> <span class=n>dest</span><span class=p>)</span>

        <span class=c1># Restore original members</span>
        <span class=n>_iteritems</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>original</span><span class=p>,</span> <span class=s2>&quot;iteritems&quot;</span><span class=p>,</span> <span class=n>original</span><span class=o>.</span><span class=n>items</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>origin_set</span><span class=p>,</span> <span class=n>members</span> <span class=ow>in</span> <span class=n>_iteritems</span><span class=p>():</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>forceElement</span><span class=o>=</span><span class=n>origin_set</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.evaluation class="doc doc-heading"> <code class="highlight language-python"><span class=n>evaluation</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s1>&#39;off&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set the evaluation manager during context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>mode</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The mode to apply during context. "off": The standard DG evaluation (stable) "serial": A serial DG evaluation "parallel": The Maya 2016+ parallel evaluation</p> </div> </td> <td> <code>&#39;off&#39;</code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>870</span>
<span class=normal>871</span>
<span class=normal>872</span>
<span class=normal>873</span>
<span class=normal>874</span>
<span class=normal>875</span>
<span class=normal>876</span>
<span class=normal>877</span>
<span class=normal>878</span>
<span class=normal>879</span>
<span class=normal>880</span>
<span class=normal>881</span>
<span class=normal>882</span>
<span class=normal>883</span>
<span class=normal>884</span>
<span class=normal>885</span>
<span class=normal>886</span>
<span class=normal>887</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>evaluation</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;off&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the evaluation manager during context.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        mode (str): The mode to apply during context.</span>
<span class=sd>            &quot;off&quot;: The standard DG evaluation (stable)</span>
<span class=sd>            &quot;serial&quot;: A serial DG evaluation</span>
<span class=sd>            &quot;parallel&quot;: The Maya 2016+ parallel evaluation</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>evaluationManager</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>evaluationManager</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>mode</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>evaluationManager</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>original</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.fix_incompatible_containers class="doc doc-heading"> <code class="highlight language-python"><span class=n>fix_incompatible_containers</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Backwards compatibility: old containers to use new ReferenceLoader</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3358</span>
<span class=normal>3359</span>
<span class=normal>3360</span>
<span class=normal>3361</span>
<span class=normal>3362</span>
<span class=normal>3363</span>
<span class=normal>3364</span>
<span class=normal>3365</span>
<span class=normal>3366</span>
<span class=normal>3367</span>
<span class=normal>3368</span>
<span class=normal>3369</span>
<span class=normal>3370</span>
<span class=normal>3371</span>
<span class=normal>3372</span>
<span class=normal>3373</span>
<span class=normal>3374</span>
<span class=normal>3375</span>
<span class=normal>3376</span>
<span class=normal>3377</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>fix_incompatible_containers</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Backwards compatibility: old containers to use new ReferenceLoader&quot;&quot;&quot;</span>
    <span class=n>old_loaders</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;MayaAsciiLoader&quot;</span><span class=p>,</span>
        <span class=s2>&quot;AbcLoader&quot;</span><span class=p>,</span>
        <span class=s2>&quot;ModelLoader&quot;</span><span class=p>,</span>
        <span class=s2>&quot;CameraLoader&quot;</span><span class=p>,</span>
        <span class=s2>&quot;RigLoader&quot;</span><span class=p>,</span>
        <span class=s2>&quot;FBXLoader&quot;</span>
    <span class=p>}</span>
    <span class=n>host</span> <span class=o>=</span> <span class=n>registered_host</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>container</span> <span class=ow>in</span> <span class=n>host</span><span class=o>.</span><span class=n>ls</span><span class=p>():</span>
        <span class=n>loader</span> <span class=o>=</span> <span class=n>container</span><span class=p>[</span><span class=s1>&#39;loader&#39;</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>loader</span> <span class=ow>in</span> <span class=n>old_loaders</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
                <span class=s2>&quot;Converting legacy container loader </span><span class=si>{}</span><span class=s2> to &quot;</span>
                <span class=s2>&quot;ReferenceLoader: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>loader</span><span class=p>,</span> <span class=n>container</span><span class=p>[</span><span class=s2>&quot;objectName&quot;</span><span class=p>])</span>
            <span class=p>)</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>container</span><span class=p>[</span><span class=s2>&quot;objectName&quot;</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;.loader&quot;</span><span class=p>,</span>
                         <span class=s2>&quot;ReferenceLoader&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;string&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.force_shader_assignments_to_faces class="doc doc-heading"> <code class="highlight language-python"><span class=n>force_shader_assignments_to_faces</span><span class=p>(</span><span class=n>shapes</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Replaces any non-face shader assignments with shader assignments to the faces during the context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>shapes</code> </td> <td> <code><span title=List>List</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>The shapes to add into face sets for any component assignments of shading engine</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4589</span>
<span class=normal>4590</span>
<span class=normal>4591</span>
<span class=normal>4592</span>
<span class=normal>4593</span>
<span class=normal>4594</span>
<span class=normal>4595</span>
<span class=normal>4596</span>
<span class=normal>4597</span>
<span class=normal>4598</span>
<span class=normal>4599</span>
<span class=normal>4600</span>
<span class=normal>4601</span>
<span class=normal>4602</span>
<span class=normal>4603</span>
<span class=normal>4604</span>
<span class=normal>4605</span>
<span class=normal>4606</span>
<span class=normal>4607</span>
<span class=normal>4608</span>
<span class=normal>4609</span>
<span class=normal>4610</span>
<span class=normal>4611</span>
<span class=normal>4612</span>
<span class=normal>4613</span>
<span class=normal>4614</span>
<span class=normal>4615</span>
<span class=normal>4616</span>
<span class=normal>4617</span>
<span class=normal>4618</span>
<span class=normal>4619</span>
<span class=normal>4620</span>
<span class=normal>4621</span>
<span class=normal>4622</span>
<span class=normal>4623</span>
<span class=normal>4624</span>
<span class=normal>4625</span>
<span class=normal>4626</span>
<span class=normal>4627</span>
<span class=normal>4628</span>
<span class=normal>4629</span>
<span class=normal>4630</span>
<span class=normal>4631</span>
<span class=normal>4632</span>
<span class=normal>4633</span>
<span class=normal>4634</span>
<span class=normal>4635</span>
<span class=normal>4636</span>
<span class=normal>4637</span>
<span class=normal>4638</span>
<span class=normal>4639</span>
<span class=normal>4640</span>
<span class=normal>4641</span>
<span class=normal>4642</span>
<span class=normal>4643</span>
<span class=normal>4644</span>
<span class=normal>4645</span>
<span class=normal>4646</span>
<span class=normal>4647</span>
<span class=normal>4648</span>
<span class=normal>4649</span>
<span class=normal>4650</span>
<span class=normal>4651</span>
<span class=normal>4652</span>
<span class=normal>4653</span>
<span class=normal>4654</span>
<span class=normal>4655</span>
<span class=normal>4656</span>
<span class=normal>4657</span>
<span class=normal>4658</span>
<span class=normal>4659</span>
<span class=normal>4660</span>
<span class=normal>4661</span>
<span class=normal>4662</span>
<span class=normal>4663</span>
<span class=normal>4664</span>
<span class=normal>4665</span>
<span class=normal>4666</span>
<span class=normal>4667</span>
<span class=normal>4668</span>
<span class=normal>4669</span>
<span class=normal>4670</span>
<span class=normal>4671</span>
<span class=normal>4672</span>
<span class=normal>4673</span>
<span class=normal>4674</span>
<span class=normal>4675</span>
<span class=normal>4676</span>
<span class=normal>4677</span>
<span class=normal>4678</span>
<span class=normal>4679</span>
<span class=normal>4680</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>force_shader_assignments_to_faces</span><span class=p>(</span><span class=n>shapes</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Replaces any non-face shader assignments with shader assignments</span>
<span class=sd>    to the faces during the context.</span>

<span class=sd>    Args:</span>
<span class=sd>        shapes (List[str]): The shapes to add into face sets for any component</span>
<span class=sd>            assignments of shading engine</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>shapes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>shapes</span><span class=p>,</span> <span class=n>shapes</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;mesh&quot;</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>shapes</span><span class=p>:</span>
        <span class=c1># Do nothing</span>
        <span class=k>yield</span>
        <span class=k>return</span>

    <span class=n>all_render_sets</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>shape</span> <span class=ow>in</span> <span class=n>shapes</span><span class=p>:</span>
        <span class=n>render_sets</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listSets</span><span class=p>(</span><span class=nb>object</span><span class=o>=</span><span class=n>shape</span><span class=p>,</span> <span class=n>t</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>extendToShape</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>render_sets</span><span class=p>:</span>
            <span class=n>all_render_sets</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>render_sets</span><span class=p>)</span>

    <span class=n>shapes_lookup</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>shapes</span><span class=p>)</span>

    <span class=c1># Maya has the tendency to return component assignment using the transform</span>
    <span class=c1># name instead of the shape name, like `pCube1.f[1]` instead of</span>
    <span class=c1># `pCube1Shape.f[1]` so we need to take those into consideration as members</span>
    <span class=k>def</span><span class=w> </span><span class=nf>get_parent</span><span class=p>(</span><span class=n>_shape</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>_shape</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

    <span class=n>components_lookup</span> <span class=o>=</span> <span class=p>{</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>shape</span><span class=si>}</span><span class=s2>.&quot;</span> <span class=k>for</span> <span class=n>shape</span> <span class=ow>in</span> <span class=n>shapes</span><span class=p>}</span>
    <span class=n>components_lookup</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>get_parent</span><span class=p>(</span><span class=n>shape</span><span class=p>)</span><span class=si>}</span><span class=s2>.&quot;</span> <span class=k>for</span> <span class=n>shape</span> <span class=ow>in</span> <span class=n>shapes</span><span class=p>)</span>
    <span class=n>components_lookup</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>components_lookup</span><span class=p>)</span>  <span class=c1># support str.startswith</span>

    <span class=n>original_assignments</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=n>override_assignments</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>shading_engine</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>all_render_sets</span><span class=p>),</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;shadingEngine&quot;</span><span class=p>):</span>
        <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>shading_engine</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>members</span><span class=p>:</span>
            <span class=k>continue</span>

        <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=c1># Include ALL originals, even those not among our shapes</span>
        <span class=n>original_assignments</span><span class=p>[</span><span class=n>shading_engine</span><span class=p>]</span> <span class=o>=</span> <span class=n>members</span>

        <span class=n>has_conversions</span> <span class=o>=</span> <span class=kc>False</span>
        <span class=k>for</span> <span class=n>member</span> <span class=ow>in</span> <span class=n>members</span><span class=p>:</span>
            <span class=c1># Only consider shapes from our inputs</span>
            <span class=k>if</span> <span class=p>(</span>
                    <span class=n>member</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>shapes_lookup</span>
                    <span class=ow>and</span> <span class=ow>not</span> <span class=n>member</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>components_lookup</span><span class=p>)</span>
            <span class=p>):</span>
                <span class=k>continue</span>

            <span class=k>if</span> <span class=s2>&quot;.&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>member</span><span class=p>:</span>
                <span class=c1># Convert to face assignments</span>
                <span class=n>member</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>member</span><span class=si>}</span><span class=s2>.f[*]&quot;</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objExists</span><span class=p>(</span><span class=n>member</span><span class=p>):</span>
                    <span class=c1># It is possible for a mesh to have no faces at all</span>
                    <span class=c1># for which we cannot convert to face assignments anyway.</span>
                    <span class=c1># It is a `mesh` node type - it just would error on</span>
                    <span class=c1># &#39;No object matches name&#39; when trying to assign to the</span>
                    <span class=c1># faces. So we skip the conversion</span>
                    <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
                        <span class=s2>&quot;Skipping face assignment conversion because &quot;</span>
                        <span class=sa>f</span><span class=s2>&quot;no mesh faces were found: </span><span class=si>{</span><span class=n>member</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
                    <span class=k>continue</span>

                <span class=n>has_conversions</span> <span class=o>=</span> <span class=kc>True</span>
            <span class=n>override_assignments</span><span class=p>[</span><span class=n>shading_engine</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>member</span><span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>has_conversions</span><span class=p>:</span>
            <span class=c1># We can skip this shading engine completely because</span>
            <span class=c1># we have nothing to override</span>
            <span class=n>original_assignments</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>shading_engine</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=n>override_assignments</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>shading_engine</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=c1># Apply overrides</span>
        <span class=k>for</span> <span class=n>shading_engine</span><span class=p>,</span> <span class=n>override_members</span> <span class=ow>in</span> <span class=n>override_assignments</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=c1># We force remove the members because this allows maya to take</span>
            <span class=c1># out the mesh (also without the components)</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>clear</span><span class=o>=</span><span class=n>shading_engine</span><span class=p>)</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>override_members</span><span class=p>,</span> <span class=n>forceElement</span><span class=o>=</span><span class=n>shading_engine</span><span class=p>)</span>

        <span class=k>yield</span>

    <span class=k>finally</span><span class=p>:</span>
        <span class=c1># Revert to original assignments</span>
        <span class=k>for</span> <span class=n>shading_engine</span><span class=p>,</span> <span class=n>original_members</span> <span class=ow>in</span> <span class=n>original_assignments</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>clear</span><span class=o>=</span><span class=n>shading_engine</span><span class=p>)</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>original_members</span><span class=p>,</span> <span class=n>forceElement</span><span class=o>=</span><span class=n>shading_engine</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.generate_capture_preset class="doc doc-heading"> <code class="highlight language-python"><span class=n>generate_capture_preset</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>camera</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>capture_preset</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Function for getting all the data of preset options for playblast capturing</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>instance</code> </td> <td> <code><span title=pyblish.api.Instance>Instance</span></code> </td> <td> <div class=doc-md-description> <p>instance</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>camera</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>review camera</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>filepath</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>start</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>frameStart</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>end</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>frameEnd</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>capture_preset</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>capture preset</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>Resulting preset</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>246</span>
<span class=normal>247</span>
<span class=normal>248</span>
<span class=normal>249</span>
<span class=normal>250</span>
<span class=normal>251</span>
<span class=normal>252</span>
<span class=normal>253</span>
<span class=normal>254</span>
<span class=normal>255</span>
<span class=normal>256</span>
<span class=normal>257</span>
<span class=normal>258</span>
<span class=normal>259</span>
<span class=normal>260</span>
<span class=normal>261</span>
<span class=normal>262</span>
<span class=normal>263</span>
<span class=normal>264</span>
<span class=normal>265</span>
<span class=normal>266</span>
<span class=normal>267</span>
<span class=normal>268</span>
<span class=normal>269</span>
<span class=normal>270</span>
<span class=normal>271</span>
<span class=normal>272</span>
<span class=normal>273</span>
<span class=normal>274</span>
<span class=normal>275</span>
<span class=normal>276</span>
<span class=normal>277</span>
<span class=normal>278</span>
<span class=normal>279</span>
<span class=normal>280</span>
<span class=normal>281</span>
<span class=normal>282</span>
<span class=normal>283</span>
<span class=normal>284</span>
<span class=normal>285</span>
<span class=normal>286</span>
<span class=normal>287</span>
<span class=normal>288</span>
<span class=normal>289</span>
<span class=normal>290</span>
<span class=normal>291</span>
<span class=normal>292</span>
<span class=normal>293</span>
<span class=normal>294</span>
<span class=normal>295</span>
<span class=normal>296</span>
<span class=normal>297</span>
<span class=normal>298</span>
<span class=normal>299</span>
<span class=normal>300</span>
<span class=normal>301</span>
<span class=normal>302</span>
<span class=normal>303</span>
<span class=normal>304</span>
<span class=normal>305</span>
<span class=normal>306</span>
<span class=normal>307</span>
<span class=normal>308</span>
<span class=normal>309</span>
<span class=normal>310</span>
<span class=normal>311</span>
<span class=normal>312</span>
<span class=normal>313</span>
<span class=normal>314</span>
<span class=normal>315</span>
<span class=normal>316</span>
<span class=normal>317</span>
<span class=normal>318</span>
<span class=normal>319</span>
<span class=normal>320</span>
<span class=normal>321</span>
<span class=normal>322</span>
<span class=normal>323</span>
<span class=normal>324</span>
<span class=normal>325</span>
<span class=normal>326</span>
<span class=normal>327</span>
<span class=normal>328</span>
<span class=normal>329</span>
<span class=normal>330</span>
<span class=normal>331</span>
<span class=normal>332</span>
<span class=normal>333</span>
<span class=normal>334</span>
<span class=normal>335</span>
<span class=normal>336</span>
<span class=normal>337</span>
<span class=normal>338</span>
<span class=normal>339</span>
<span class=normal>340</span>
<span class=normal>341</span>
<span class=normal>342</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>generate_capture_preset</span><span class=p>(</span><span class=n>instance</span><span class=p>,</span> <span class=n>camera</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span>
                            <span class=n>start</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>capture_preset</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Function for getting all the data of preset options for</span>
<span class=sd>    playblast capturing</span>

<span class=sd>    Args:</span>
<span class=sd>        instance (pyblish.api.Instance): instance</span>
<span class=sd>        camera (str): review camera</span>
<span class=sd>        path (str): filepath</span>
<span class=sd>        start (int): frameStart</span>
<span class=sd>        end (int): frameEnd</span>
<span class=sd>        capture_preset (dict): capture preset</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: Resulting preset</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>preset</span> <span class=o>=</span> <span class=n>load_capture_preset</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>capture_preset</span><span class=p>)</span>

    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;camera&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>camera</span>
    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;start_frame&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>start</span>
    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;end_frame&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>end</span>
    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;filename&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>path</span>
    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;overwrite&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;panel&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;panel&quot;</span><span class=p>]</span>

    <span class=c1># Disable viewer since we use the rendering logic for publishing</span>
    <span class=c1># We don&#39;t want to open the generated playblast in a viewer directly.</span>
    <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;viewer&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>

    <span class=c1># &quot;isolate_view&quot; will already have been applied at creation, so we&#39;ll</span>
    <span class=c1># ignore it here.</span>
    <span class=n>preset</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;isolate_view&quot;</span><span class=p>)</span>

    <span class=c1># Set resolution variables from capture presets</span>
    <span class=n>width_preset</span> <span class=o>=</span> <span class=n>capture_preset</span><span class=p>[</span><span class=s2>&quot;Resolution&quot;</span><span class=p>][</span><span class=s2>&quot;width&quot;</span><span class=p>]</span>
    <span class=n>height_preset</span> <span class=o>=</span> <span class=n>capture_preset</span><span class=p>[</span><span class=s2>&quot;Resolution&quot;</span><span class=p>][</span><span class=s2>&quot;height&quot;</span><span class=p>]</span>

    <span class=c1># Set resolution variables from folder values</span>
    <span class=n>folder_attributes</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;folderEntity&quot;</span><span class=p>][</span><span class=s2>&quot;attrib&quot;</span><span class=p>]</span>
    <span class=n>folder_width</span> <span class=o>=</span> <span class=n>folder_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;resolutionWidth&quot;</span><span class=p>)</span>
    <span class=n>folder_height</span> <span class=o>=</span> <span class=n>folder_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;resolutionHeight&quot;</span><span class=p>)</span>
    <span class=n>review_instance_width</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;review_width&quot;</span><span class=p>)</span>
    <span class=n>review_instance_height</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;review_height&quot;</span><span class=p>)</span>

    <span class=c1># Use resolution from instance if review width/height is set</span>
    <span class=c1># Otherwise use the resolution from preset if it has non-zero values</span>
    <span class=c1># Otherwise fall back to folder width x height</span>
    <span class=c1># Else define no width, then `capture.capture` will use render resolution</span>
    <span class=k>if</span> <span class=n>review_instance_width</span> <span class=ow>and</span> <span class=n>review_instance_height</span><span class=p>:</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;width&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>review_instance_width</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;height&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>review_instance_height</span>
    <span class=k>elif</span> <span class=n>width_preset</span> <span class=ow>and</span> <span class=n>height_preset</span><span class=p>:</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;width&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>width_preset</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;height&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>height_preset</span>
    <span class=k>elif</span> <span class=n>folder_width</span> <span class=ow>and</span> <span class=n>folder_height</span><span class=p>:</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;width&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>folder_width</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;height&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>folder_height</span>

    <span class=c1># Isolate view is requested by having objects in the set besides a</span>
    <span class=c1># camera. If there is only 1 member it&#39;ll be the camera because we</span>
    <span class=c1># validate to have 1 camera only.</span>
    <span class=k>if</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;isolate&quot;</span><span class=p>]</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;setMembers&quot;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;isolate&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;setMembers&quot;</span><span class=p>]</span>

    <span class=c1># Override camera options</span>
    <span class=c1># Enforce persisting camera depth of field</span>
    <span class=n>camera_options</span> <span class=o>=</span> <span class=n>preset</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=s2>&quot;camera_options&quot;</span><span class=p>,</span> <span class=p>{})</span>
    <span class=n>camera_options</span><span class=p>[</span><span class=s2>&quot;depthOfField&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span>
        <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>.depthOfField&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>camera</span><span class=p>)</span>
    <span class=p>)</span>

    <span class=c1># Use Pan/Zoom from instance data instead of from preset</span>
    <span class=n>preset</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;pan_zoom&quot;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=n>camera_options</span><span class=p>[</span><span class=s2>&quot;panZoomEnabled&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;panZoom&quot;</span><span class=p>]</span>

    <span class=c1># Override viewport options by instance data</span>
    <span class=n>viewport_options</span> <span class=o>=</span> <span class=n>preset</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=s2>&quot;viewport_options&quot;</span><span class=p>,</span> <span class=p>{})</span>
    <span class=n>viewport_options</span><span class=p>[</span><span class=s2>&quot;imagePlane&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;imagePlane&quot;</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>

    <span class=c1># When using &#39;project settings&#39; we preserve the capture preset that</span>
    <span class=c1># was picked, then we do not override it with the instance data</span>
    <span class=k>if</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;displayLights&quot;</span><span class=p>]</span> <span class=o>!=</span> <span class=s2>&quot;project_settings&quot;</span><span class=p>:</span>
        <span class=n>viewport_options</span><span class=p>[</span><span class=s2>&quot;displayLights&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;displayLights&quot;</span><span class=p>]</span>

    <span class=c1># Override transparency if requested.</span>
    <span class=n>transparency</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;transparency&quot;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>transparency</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
        <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;viewport2_options&quot;</span><span class=p>][</span><span class=s2>&quot;transparencyAlgorithm&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>transparency</span>

    <span class=c1># Update preset with current panel setting</span>
    <span class=c1># if override_viewport_options is turned off</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>capture_preset</span><span class=p>[</span><span class=s2>&quot;ViewportOptions&quot;</span><span class=p>][</span><span class=s2>&quot;override_viewport_options&quot;</span><span class=p>]:</span>
        <span class=n>panel_preset</span> <span class=o>=</span> <span class=n>capture</span><span class=o>.</span><span class=n>parse_view</span><span class=p>(</span><span class=n>preset</span><span class=p>[</span><span class=s2>&quot;panel&quot;</span><span class=p>])</span>
        <span class=n>panel_preset</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;camera&quot;</span><span class=p>)</span>
        <span class=n>preset</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>panel_preset</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>preset</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.generate_ids class="doc doc-heading"> <code class="highlight language-python"><span class=n>generate_ids</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>folder_id</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Returns new unique ids for the given nodes.</p> <p>Note: This does not assign the new ids, it only generates the values.</p> <p>To assign new ids using this method:</p> <blockquote> <blockquote> <blockquote> <p>nodes = ["a", "b", "c"] for node, id in generate_ids(nodes): set_id(node, id)</p> </blockquote> </blockquote> </blockquote> <p>To also override any existing values (and assign regenerated ids):</p> <blockquote> <blockquote> <blockquote> <p>nodes = ["a", "b", "c"] for node, id in generate_ids(nodes): set_id(node, id, overwrite=True)</p> </blockquote> </blockquote> </blockquote> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>List of nodes.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>folder_id</code> </td> <td> <code><span title=Optional>Optional</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>Folder id to generate id for. When None provided current folder is used.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>A list of (node, id) tuples.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1611</span>
<span class=normal>1612</span>
<span class=normal>1613</span>
<span class=normal>1614</span>
<span class=normal>1615</span>
<span class=normal>1616</span>
<span class=normal>1617</span>
<span class=normal>1618</span>
<span class=normal>1619</span>
<span class=normal>1620</span>
<span class=normal>1621</span>
<span class=normal>1622</span>
<span class=normal>1623</span>
<span class=normal>1624</span>
<span class=normal>1625</span>
<span class=normal>1626</span>
<span class=normal>1627</span>
<span class=normal>1628</span>
<span class=normal>1629</span>
<span class=normal>1630</span>
<span class=normal>1631</span>
<span class=normal>1632</span>
<span class=normal>1633</span>
<span class=normal>1634</span>
<span class=normal>1635</span>
<span class=normal>1636</span>
<span class=normal>1637</span>
<span class=normal>1638</span>
<span class=normal>1639</span>
<span class=normal>1640</span>
<span class=normal>1641</span>
<span class=normal>1642</span>
<span class=normal>1643</span>
<span class=normal>1644</span>
<span class=normal>1645</span>
<span class=normal>1646</span>
<span class=normal>1647</span>
<span class=normal>1648</span>
<span class=normal>1649</span>
<span class=normal>1650</span>
<span class=normal>1651</span>
<span class=normal>1652</span>
<span class=normal>1653</span>
<span class=normal>1654</span>
<span class=normal>1655</span>
<span class=normal>1656</span>
<span class=normal>1657</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>generate_ids</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>folder_id</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns new unique ids for the given nodes.</span>

<span class=sd>    Note: This does not assign the new ids, it only generates the values.</span>

<span class=sd>    To assign new ids using this method:</span>
<span class=sd>    &gt;&gt;&gt; nodes = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
<span class=sd>    &gt;&gt;&gt; for node, id in generate_ids(nodes):</span>
<span class=sd>    &gt;&gt;&gt;     set_id(node, id)</span>

<span class=sd>    To also override any existing values (and assign regenerated ids):</span>
<span class=sd>    &gt;&gt;&gt; nodes = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
<span class=sd>    &gt;&gt;&gt; for node, id in generate_ids(nodes):</span>
<span class=sd>    &gt;&gt;&gt;     set_id(node, id, overwrite=True)</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (list): List of nodes.</span>
<span class=sd>        folder_id (Optional[str]): Folder id to generate id for. When None</span>
<span class=sd>            provided current folder is used.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: A list of (node, id) tuples.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>folder_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=c1># Get the folder id based on current context folder</span>
        <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
        <span class=n>folder_path</span> <span class=o>=</span> <span class=n>get_current_folder_path</span><span class=p>()</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>folder_path</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Current folder path is not set&quot;</span><span class=p>)</span>
        <span class=n>folder_entity</span> <span class=o>=</span> <span class=n>ayon_api</span><span class=o>.</span><span class=n>get_folder_by_path</span><span class=p>(</span>
            <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_path</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>folder_entity</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>((</span>
                <span class=s2>&quot;Current folder &#39;</span><span class=si>{}</span><span class=s2>&#39; was not found on the server&quot;</span>
            <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>folder_path</span><span class=p>))</span>
        <span class=n>folder_id</span> <span class=o>=</span> <span class=n>folder_entity</span><span class=p>[</span><span class=s2>&quot;id&quot;</span><span class=p>]</span>

    <span class=n>node_ids</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=n>_</span><span class=p>,</span> <span class=n>uid</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;-&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>unique_id</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>:</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>folder_id</span><span class=p>,</span> <span class=n>uid</span><span class=p>)</span>
        <span class=n>node_ids</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>node</span><span class=p>,</span> <span class=n>unique_id</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>node_ids</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_all_children class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_all_children</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>ignore_intermediate_objects</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return all children of <code>nodes</code> including each instanced child. Using maya.cmds.listRelatives(allDescendents=True) includes only the first instance. As such, this function acts as an optimal replacement with a focus on a fast query.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=iterable>iterable</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>List of nodes to get children for.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>ignore_intermediate_objects</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Ignore any children that are intermediate objects.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>set</code></td> <td> </td> <td> <div class=doc-md-description> <p>Children of input nodes.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4119</span>
<span class=normal>4120</span>
<span class=normal>4121</span>
<span class=normal>4122</span>
<span class=normal>4123</span>
<span class=normal>4124</span>
<span class=normal>4125</span>
<span class=normal>4126</span>
<span class=normal>4127</span>
<span class=normal>4128</span>
<span class=normal>4129</span>
<span class=normal>4130</span>
<span class=normal>4131</span>
<span class=normal>4132</span>
<span class=normal>4133</span>
<span class=normal>4134</span>
<span class=normal>4135</span>
<span class=normal>4136</span>
<span class=normal>4137</span>
<span class=normal>4138</span>
<span class=normal>4139</span>
<span class=normal>4140</span>
<span class=normal>4141</span>
<span class=normal>4142</span>
<span class=normal>4143</span>
<span class=normal>4144</span>
<span class=normal>4145</span>
<span class=normal>4146</span>
<span class=normal>4147</span>
<span class=normal>4148</span>
<span class=normal>4149</span>
<span class=normal>4150</span>
<span class=normal>4151</span>
<span class=normal>4152</span>
<span class=normal>4153</span>
<span class=normal>4154</span>
<span class=normal>4155</span>
<span class=normal>4156</span>
<span class=normal>4157</span>
<span class=normal>4158</span>
<span class=normal>4159</span>
<span class=normal>4160</span>
<span class=normal>4161</span>
<span class=normal>4162</span>
<span class=normal>4163</span>
<span class=normal>4164</span>
<span class=normal>4165</span>
<span class=normal>4166</span>
<span class=normal>4167</span>
<span class=normal>4168</span>
<span class=normal>4169</span>
<span class=normal>4170</span>
<span class=normal>4171</span>
<span class=normal>4172</span>
<span class=normal>4173</span>
<span class=normal>4174</span>
<span class=normal>4175</span>
<span class=normal>4176</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_all_children</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>ignore_intermediate_objects</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return all children of `nodes` including each instanced child.</span>
<span class=sd>    Using maya.cmds.listRelatives(allDescendents=True) includes only the first</span>
<span class=sd>    instance. As such, this function acts as an optimal replacement with a</span>
<span class=sd>    focus on a fast query.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (iterable[str]): List of nodes to get children for.</span>
<span class=sd>        ignore_intermediate_objects (bool): Ignore any children that</span>
<span class=sd>            are intermediate objects.</span>

<span class=sd>    Returns:</span>
<span class=sd>        set: Children of input nodes.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>sel</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MSelectionList</span><span class=p>()</span>
    <span class=n>traversed</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=n>iterator</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MItDag</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MItDag</span><span class=o>.</span><span class=n>kDepthFirst</span><span class=p>)</span>
    <span class=n>fn_dag</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDagNode</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>

        <span class=k>if</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>traversed</span><span class=p>:</span>
            <span class=c1># Ignore if already processed as a child</span>
            <span class=c1># before</span>
            <span class=k>continue</span>

        <span class=n>sel</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
        <span class=n>sel</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=n>obj</span> <span class=o>=</span> <span class=n>sel</span><span class=o>.</span><span class=n>getDependNode</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>obj</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kDagNode</span><span class=p>):</span>
            <span class=c1># Not a dag node, skip</span>
            <span class=k>continue</span>

        <span class=n>dag</span> <span class=o>=</span> <span class=n>sel</span><span class=o>.</span><span class=n>getDagPath</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>

        <span class=n>iterator</span><span class=o>.</span><span class=n>reset</span><span class=p>(</span><span class=n>dag</span><span class=p>)</span>
        <span class=c1># ignore self</span>
        <span class=n>iterator</span><span class=o>.</span><span class=n>next</span><span class=p>()</span>  <span class=c1># noqa: B305</span>
        <span class=k>while</span> <span class=ow>not</span> <span class=n>iterator</span><span class=o>.</span><span class=n>isDone</span><span class=p>():</span>

            <span class=k>if</span> <span class=n>ignore_intermediate_objects</span><span class=p>:</span>
                <span class=n>fn_dag</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>iterator</span><span class=o>.</span><span class=n>currentItem</span><span class=p>())</span>
                <span class=k>if</span> <span class=n>fn_dag</span><span class=o>.</span><span class=n>isIntermediateObject</span><span class=p>:</span>
                    <span class=n>iterator</span><span class=o>.</span><span class=n>prune</span><span class=p>()</span>
                    <span class=n>iterator</span><span class=o>.</span><span class=n>next</span><span class=p>()</span>  <span class=c1># noqa: B305</span>
                    <span class=k>continue</span>

            <span class=n>path</span> <span class=o>=</span> <span class=n>iterator</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span>

            <span class=k>if</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>traversed</span><span class=p>:</span>
                <span class=n>iterator</span><span class=o>.</span><span class=n>prune</span><span class=p>()</span>
                <span class=n>iterator</span><span class=o>.</span><span class=n>next</span><span class=p>()</span>  <span class=c1># noqa: B305</span>
                <span class=k>continue</span>

            <span class=n>traversed</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
            <span class=n>iterator</span><span class=o>.</span><span class=n>next</span><span class=p>()</span>  <span class=c1># noqa: B305</span>

    <span class=k>return</span> <span class=n>traversed</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_attr_in_layer class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_attr_in_layer</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>layer</span><span class=p>,</span> <span class=n>as_string</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return attribute value in specified renderlayer.</p> <p>Same as cmds.getAttr but this gets the attribute's value in a given render layer without having to switch to it.</p> <details class=warning-for-parent-attribute-overrides open> <summary>Warning for parent attribute overrides</summary> <p>Attributes that have render layer overrides to their parent attribute are not captured correctly since they do not have a direct connection. For example, an override to sphere.rotate when querying sphere.rotateX will not return correctly!</p> </details> <details class=note open> <summary>This is much faster for Maya's renderLayer system, yet the code</summary> <p>does no optimized query for render setup.</p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attr</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>attribute name, ex. "node.attribute"</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>layer</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>layer name</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>as_string</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>whether attribute should convert to a string value</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>The return value from <code>maya.cmds.getAttr</code></p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3267</span>
<span class=normal>3268</span>
<span class=normal>3269</span>
<span class=normal>3270</span>
<span class=normal>3271</span>
<span class=normal>3272</span>
<span class=normal>3273</span>
<span class=normal>3274</span>
<span class=normal>3275</span>
<span class=normal>3276</span>
<span class=normal>3277</span>
<span class=normal>3278</span>
<span class=normal>3279</span>
<span class=normal>3280</span>
<span class=normal>3281</span>
<span class=normal>3282</span>
<span class=normal>3283</span>
<span class=normal>3284</span>
<span class=normal>3285</span>
<span class=normal>3286</span>
<span class=normal>3287</span>
<span class=normal>3288</span>
<span class=normal>3289</span>
<span class=normal>3290</span>
<span class=normal>3291</span>
<span class=normal>3292</span>
<span class=normal>3293</span>
<span class=normal>3294</span>
<span class=normal>3295</span>
<span class=normal>3296</span>
<span class=normal>3297</span>
<span class=normal>3298</span>
<span class=normal>3299</span>
<span class=normal>3300</span>
<span class=normal>3301</span>
<span class=normal>3302</span>
<span class=normal>3303</span>
<span class=normal>3304</span>
<span class=normal>3305</span>
<span class=normal>3306</span>
<span class=normal>3307</span>
<span class=normal>3308</span>
<span class=normal>3309</span>
<span class=normal>3310</span>
<span class=normal>3311</span>
<span class=normal>3312</span>
<span class=normal>3313</span>
<span class=normal>3314</span>
<span class=normal>3315</span>
<span class=normal>3316</span>
<span class=normal>3317</span>
<span class=normal>3318</span>
<span class=normal>3319</span>
<span class=normal>3320</span>
<span class=normal>3321</span>
<span class=normal>3322</span>
<span class=normal>3323</span>
<span class=normal>3324</span>
<span class=normal>3325</span>
<span class=normal>3326</span>
<span class=normal>3327</span>
<span class=normal>3328</span>
<span class=normal>3329</span>
<span class=normal>3330</span>
<span class=normal>3331</span>
<span class=normal>3332</span>
<span class=normal>3333</span>
<span class=normal>3334</span>
<span class=normal>3335</span>
<span class=normal>3336</span>
<span class=normal>3337</span>
<span class=normal>3338</span>
<span class=normal>3339</span>
<span class=normal>3340</span>
<span class=normal>3341</span>
<span class=normal>3342</span>
<span class=normal>3343</span>
<span class=normal>3344</span>
<span class=normal>3345</span>
<span class=normal>3346</span>
<span class=normal>3347</span>
<span class=normal>3348</span>
<span class=normal>3349</span>
<span class=normal>3350</span>
<span class=normal>3351</span>
<span class=normal>3352</span>
<span class=normal>3353</span>
<span class=normal>3354</span>
<span class=normal>3355</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_attr_in_layer</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>layer</span><span class=p>,</span> <span class=n>as_string</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return attribute value in specified renderlayer.</span>

<span class=sd>    Same as cmds.getAttr but this gets the attribute&#39;s value in a</span>
<span class=sd>    given render layer without having to switch to it.</span>

<span class=sd>    Warning for parent attribute overrides:</span>
<span class=sd>        Attributes that have render layer overrides to their parent attribute</span>
<span class=sd>        are not captured correctly since they do not have a direct connection.</span>
<span class=sd>        For example, an override to sphere.rotate when querying sphere.rotateX</span>
<span class=sd>        will not return correctly!</span>

<span class=sd>    Note: This is much faster for Maya&#39;s renderLayer system, yet the code</span>
<span class=sd>        does no optimized query for render setup.</span>

<span class=sd>    Args:</span>
<span class=sd>        attr (str): attribute name, ex. &quot;node.attribute&quot;</span>
<span class=sd>        layer (str): layer name</span>
<span class=sd>        as_string (bool): whether attribute should convert to a string value</span>

<span class=sd>    Returns:</span>
<span class=sd>        The return value from `maya.cmds.getAttr`</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>mayaHasRenderSetup</span><span class=p>():</span>
            <span class=kn>from</span><span class=w> </span><span class=nn>.</span><span class=w> </span><span class=kn>import</span> <span class=n>lib_rendersetup</span>
            <span class=k>return</span> <span class=n>lib_rendersetup</span><span class=o>.</span><span class=n>get_attr_in_layer</span><span class=p>(</span>
                <span class=n>attr</span><span class=p>,</span> <span class=n>layer</span><span class=p>,</span> <span class=n>as_string</span><span class=o>=</span><span class=n>as_string</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>AttributeError</span><span class=p>:</span>
        <span class=k>pass</span>

    <span class=c1># Ignore complex query if we&#39;re in the layer anyway</span>
    <span class=n>current_layer</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>editRenderLayerGlobals</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                <span class=n>currentRenderLayer</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>layer</span> <span class=o>==</span> <span class=n>current_layer</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>asString</span><span class=o>=</span><span class=n>as_string</span><span class=p>)</span>

    <span class=n>connections</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span>
                                       <span class=n>plugs</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                       <span class=n>source</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                       <span class=n>destination</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                       <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;renderLayer&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
    <span class=n>connections</span> <span class=o>=</span> <span class=nb>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;.plug&quot;</span><span class=p>),</span> <span class=n>connections</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>connections</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>)</span>

    <span class=c1># Some value types perform a conversion when assigning</span>
    <span class=c1># TODO: See if there&#39;s a maya method to allow this conversion</span>
    <span class=c1># instead of computing it ourselves.</span>
    <span class=n>attr_type</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>conversion</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=k>if</span> <span class=n>attr_type</span> <span class=o>==</span> <span class=s2>&quot;time&quot;</span><span class=p>:</span>
        <span class=n>conversion</span> <span class=o>=</span> <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s1>&#39;currentTimeUnitToFPS()&#39;</span><span class=p>)</span>  <span class=c1># returns float</span>
    <span class=k>elif</span> <span class=n>attr_type</span> <span class=o>==</span> <span class=s2>&quot;doubleAngle&quot;</span><span class=p>:</span>
        <span class=c1># Radians to Degrees: 180 / pi</span>
        <span class=c1># TODO: This will likely only be correct when Maya units are set</span>
        <span class=c1>#       to degrees</span>
        <span class=n>conversion</span> <span class=o>=</span> <span class=mf>57.2957795131</span>
    <span class=k>elif</span> <span class=n>attr_type</span> <span class=o>==</span> <span class=s2>&quot;doubleLinear&quot;</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=s2>&quot;doubleLinear conversion not implemented.&quot;</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>connection</span> <span class=ow>in</span> <span class=n>connections</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>connection</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>layer</span> <span class=o>+</span> <span class=s2>&quot;.&quot;</span><span class=p>):</span>
            <span class=n>attr_split</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>attr_split</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=n>layer</span><span class=p>:</span>
                <span class=n>attr</span> <span class=o>=</span> <span class=s2>&quot;.&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>attr_split</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
                <span class=n>value</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>%s</span><span class=s2>.value&quot;</span> <span class=o>%</span> <span class=n>attr</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>conversion</span><span class=p>:</span>
                    <span class=n>value</span> <span class=o>*=</span> <span class=n>conversion</span>
                <span class=k>return</span> <span class=n>value</span>

    <span class=k>else</span><span class=p>:</span>
        <span class=c1># When connections are present, but none</span>
        <span class=c1># to the specific renderlayer than the layer</span>
        <span class=c1># should have the &quot;defaultRenderLayer&quot;&#39;s value</span>
        <span class=n>layer</span> <span class=o>=</span> <span class=s2>&quot;defaultRenderLayer&quot;</span>
        <span class=k>for</span> <span class=n>connection</span> <span class=ow>in</span> <span class=n>connections</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>connection</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>layer</span><span class=p>):</span>
                <span class=n>attr_split</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>attr_split</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;defaultRenderLayer&quot;</span><span class=p>:</span>
                    <span class=n>attr</span> <span class=o>=</span> <span class=s2>&quot;.&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>attr_split</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
                    <span class=n>value</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>%s</span><span class=s2>.value&quot;</span> <span class=o>%</span> <span class=n>attr</span><span class=p>)</span>
                    <span class=k>if</span> <span class=n>conversion</span><span class=p>:</span>
                        <span class=n>value</span> <span class=o>*=</span> <span class=n>conversion</span>
                    <span class=k>return</span> <span class=n>value</span>

    <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>asString</span><span class=o>=</span><span class=n>as_string</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_attribute class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_attribute</span><span class=p>(</span><span class=n>plug</span><span class=p>,</span> <span class=n>asString</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>expandEnvironmentVariables</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Maya getAttr with some fixes based on <code>pymel.core.general.getAttr()</code>.</p> <p>Like Pymel getAttr this applies some changes to <code>maya.cmds.getAttr</code> - maya pointlessly returned vector results as a tuple wrapped in a list (ex. '[(1,2,3)]'). This command unpacks the vector for you. - when getting a multi-attr, maya would raise an error, but this will return a list of values for the multi-attr - added support for getting message attributes by returning the connections instead</p> <p>Note that the asString + expandEnvironmentVariables argument naming convention matches the <code>maya.cmds.getAttr</code> arguments so that it can act as a direct replacement for it.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>plug</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Node's attribute plug as <code>node.attribute</code></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>asString</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Return string value for enum attributes instead of the index. Note that the return value can be dependent on the UI language Maya is running in.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>expandEnvironmentVariables</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Expand any environment variable and (tilde characters on UNIX) found in string attributes which are returned.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=kwargs open> <summary>Kwargs</summary> <p>Supports the keyword arguments of <code>maya.cmds.getAttr</code></p> </details> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>object</code></td> <td> </td> <td> <div class=doc-md-description> <p>The value of the maya attribute.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1687</span>
<span class=normal>1688</span>
<span class=normal>1689</span>
<span class=normal>1690</span>
<span class=normal>1691</span>
<span class=normal>1692</span>
<span class=normal>1693</span>
<span class=normal>1694</span>
<span class=normal>1695</span>
<span class=normal>1696</span>
<span class=normal>1697</span>
<span class=normal>1698</span>
<span class=normal>1699</span>
<span class=normal>1700</span>
<span class=normal>1701</span>
<span class=normal>1702</span>
<span class=normal>1703</span>
<span class=normal>1704</span>
<span class=normal>1705</span>
<span class=normal>1706</span>
<span class=normal>1707</span>
<span class=normal>1708</span>
<span class=normal>1709</span>
<span class=normal>1710</span>
<span class=normal>1711</span>
<span class=normal>1712</span>
<span class=normal>1713</span>
<span class=normal>1714</span>
<span class=normal>1715</span>
<span class=normal>1716</span>
<span class=normal>1717</span>
<span class=normal>1718</span>
<span class=normal>1719</span>
<span class=normal>1720</span>
<span class=normal>1721</span>
<span class=normal>1722</span>
<span class=normal>1723</span>
<span class=normal>1724</span>
<span class=normal>1725</span>
<span class=normal>1726</span>
<span class=normal>1727</span>
<span class=normal>1728</span>
<span class=normal>1729</span>
<span class=normal>1730</span>
<span class=normal>1731</span>
<span class=normal>1732</span>
<span class=normal>1733</span>
<span class=normal>1734</span>
<span class=normal>1735</span>
<span class=normal>1736</span>
<span class=normal>1737</span>
<span class=normal>1738</span>
<span class=normal>1739</span>
<span class=normal>1740</span>
<span class=normal>1741</span>
<span class=normal>1742</span>
<span class=normal>1743</span>
<span class=normal>1744</span>
<span class=normal>1745</span>
<span class=normal>1746</span>
<span class=normal>1747</span>
<span class=normal>1748</span>
<span class=normal>1749</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_attribute</span><span class=p>(</span><span class=n>plug</span><span class=p>,</span>
                  <span class=n>asString</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                  <span class=n>expandEnvironmentVariables</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                  <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Maya getAttr with some fixes based on `pymel.core.general.getAttr()`.</span>

<span class=sd>    Like Pymel getAttr this applies some changes to `maya.cmds.getAttr`</span>
<span class=sd>      - maya pointlessly returned vector results as a tuple wrapped in a list</span>
<span class=sd>        (ex.  &#39;[(1,2,3)]&#39;). This command unpacks the vector for you.</span>
<span class=sd>      - when getting a multi-attr, maya would raise an error, but this will</span>
<span class=sd>        return a list of values for the multi-attr</span>
<span class=sd>      - added support for getting message attributes by returning the</span>
<span class=sd>        connections instead</span>

<span class=sd>    Note that the asString + expandEnvironmentVariables argument naming</span>
<span class=sd>    convention matches the `maya.cmds.getAttr` arguments so that it can</span>
<span class=sd>    act as a direct replacement for it.</span>

<span class=sd>    Args:</span>
<span class=sd>        plug (str): Node&#39;s attribute plug as `node.attribute`</span>
<span class=sd>        asString (bool): Return string value for enum attributes instead</span>
<span class=sd>            of the index. Note that the return value can be dependent on the</span>
<span class=sd>            UI language Maya is running in.</span>
<span class=sd>        expandEnvironmentVariables (bool): Expand any environment variable and</span>
<span class=sd>            (tilde characters on UNIX) found in string attributes which are</span>
<span class=sd>            returned.</span>

<span class=sd>    Kwargs:</span>
<span class=sd>        Supports the keyword arguments of `maya.cmds.getAttr`</span>

<span class=sd>    Returns:</span>
<span class=sd>        object: The value of the maya attribute.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>attr_type</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>plug</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>asString</span><span class=p>:</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;asString&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
    <span class=k>if</span> <span class=n>expandEnvironmentVariables</span><span class=p>:</span>
        <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;expandEnvironmentVariables&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>res</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>plug</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>attr_type</span> <span class=o>==</span> <span class=s2>&quot;message&quot;</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span><span class=n>plug</span><span class=p>)</span>

        <span class=n>node</span><span class=p>,</span> <span class=n>attr</span> <span class=o>=</span> <span class=n>plug</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>children</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>listChildren</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>children</span><span class=p>:</span>
            <span class=k>return</span> <span class=p>[</span>
                <span class=n>get_attribute</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>child</span><span class=p>))</span>
                <span class=k>for</span> <span class=n>child</span> <span class=ow>in</span> <span class=n>children</span>
            <span class=p>]</span>

        <span class=k>raise</span>

    <span class=c1># Convert vector result wrapped in tuple</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=nb>list</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>):</span>
        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=nb>tuple</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>):</span>
            <span class=k>if</span> <span class=n>attr_type</span> <span class=ow>in</span> <span class=p>{</span><span class=s1>&#39;pointArray&#39;</span><span class=p>,</span> <span class=s1>&#39;vectorArray&#39;</span><span class=p>}:</span>
                <span class=k>return</span> <span class=n>res</span>
            <span class=k>return</span> <span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>

    <span class=k>return</span> <span class=n>res</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_capture_preset class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_capture_preset</span><span class=p>(</span><span class=n>task_name</span><span class=p>,</span> <span class=n>task_type</span><span class=p>,</span> <span class=n>product_name</span><span class=p>,</span> <span class=n>project_settings</span><span class=p>,</span> <span class=n>log</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get capture preset for playblasting.</p> <p>Logic for transitioning from old style capture preset to new capture preset profiles.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>task_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Task name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>task_type</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Task type.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>product_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Product name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>project_settings</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Project settings.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>log</code> </td> <td> <code><span title=logging.Logger>Logger</span></code> </td> <td> <div class=doc-md-description> <p>Logging object.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4179</span>
<span class=normal>4180</span>
<span class=normal>4181</span>
<span class=normal>4182</span>
<span class=normal>4183</span>
<span class=normal>4184</span>
<span class=normal>4185</span>
<span class=normal>4186</span>
<span class=normal>4187</span>
<span class=normal>4188</span>
<span class=normal>4189</span>
<span class=normal>4190</span>
<span class=normal>4191</span>
<span class=normal>4192</span>
<span class=normal>4193</span>
<span class=normal>4194</span>
<span class=normal>4195</span>
<span class=normal>4196</span>
<span class=normal>4197</span>
<span class=normal>4198</span>
<span class=normal>4199</span>
<span class=normal>4200</span>
<span class=normal>4201</span>
<span class=normal>4202</span>
<span class=normal>4203</span>
<span class=normal>4204</span>
<span class=normal>4205</span>
<span class=normal>4206</span>
<span class=normal>4207</span>
<span class=normal>4208</span>
<span class=normal>4209</span>
<span class=normal>4210</span>
<span class=normal>4211</span>
<span class=normal>4212</span>
<span class=normal>4213</span>
<span class=normal>4214</span>
<span class=normal>4215</span>
<span class=normal>4216</span>
<span class=normal>4217</span>
<span class=normal>4218</span>
<span class=normal>4219</span>
<span class=normal>4220</span>
<span class=normal>4221</span>
<span class=normal>4222</span>
<span class=normal>4223</span>
<span class=normal>4224</span>
<span class=normal>4225</span>
<span class=normal>4226</span>
<span class=normal>4227</span>
<span class=normal>4228</span>
<span class=normal>4229</span>
<span class=normal>4230</span>
<span class=normal>4231</span>
<span class=normal>4232</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_capture_preset</span><span class=p>(</span>
    <span class=n>task_name</span><span class=p>,</span> <span class=n>task_type</span><span class=p>,</span> <span class=n>product_name</span><span class=p>,</span> <span class=n>project_settings</span><span class=p>,</span> <span class=n>log</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get capture preset for playblasting.</span>

<span class=sd>    Logic for transitioning from old style capture preset to new capture preset</span>
<span class=sd>    profiles.</span>

<span class=sd>    Args:</span>
<span class=sd>        task_name (str): Task name.</span>
<span class=sd>        task_type (str): Task type.</span>
<span class=sd>        product_name (str): Product name.</span>
<span class=sd>        project_settings (dict): Project settings.</span>
<span class=sd>        log (logging.Logger): Logging object.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>capture_preset</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>filtering_criteria</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;task_names&quot;</span><span class=p>:</span> <span class=n>task_name</span><span class=p>,</span>
        <span class=s2>&quot;task_types&quot;</span><span class=p>:</span> <span class=n>task_type</span><span class=p>,</span>
        <span class=s2>&quot;product_names&quot;</span><span class=p>:</span> <span class=n>product_name</span>
    <span class=p>}</span>

    <span class=n>plugin_settings</span> <span class=o>=</span> <span class=n>project_settings</span><span class=p>[</span><span class=s2>&quot;maya&quot;</span><span class=p>][</span><span class=s2>&quot;publish&quot;</span><span class=p>][</span><span class=s2>&quot;ExtractPlayblast&quot;</span><span class=p>]</span>
    <span class=k>if</span> <span class=n>plugin_settings</span><span class=p>[</span><span class=s2>&quot;profiles&quot;</span><span class=p>]:</span>
        <span class=n>profile</span> <span class=o>=</span> <span class=n>filter_profiles</span><span class=p>(</span>
            <span class=n>plugin_settings</span><span class=p>[</span><span class=s2>&quot;profiles&quot;</span><span class=p>],</span>
            <span class=n>filtering_criteria</span><span class=p>,</span>
            <span class=n>logger</span><span class=o>=</span><span class=n>log</span>
        <span class=p>)</span> <span class=ow>or</span> <span class=p>{}</span>
        <span class=n>capture_preset</span> <span class=o>=</span> <span class=n>profile</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;capture_preset&quot;</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No profiles present for Extract Playblast&quot;</span><span class=p>)</span>

    <span class=c1># Backward compatibility for deprecated Extract Playblast settings</span>
    <span class=c1># without profiles.</span>
    <span class=k>if</span> <span class=n>capture_preset</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
            <span class=s2>&quot;Falling back to deprecated Extract Playblast capture preset &quot;</span>
            <span class=s2>&quot;because no new style playblast profiles are defined or no &quot;</span>
            <span class=s2>&quot;profile matches for your current context.&quot;</span>
        <span class=p>)</span>
        <span class=n>capture_preset</span> <span class=o>=</span> <span class=n>plugin_settings</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;capture_preset&quot;</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>capture_preset</span><span class=p>:</span>
        <span class=c1># Create deepcopy of preset as we&#39;ll change the values</span>
        <span class=n>capture_preset</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>capture_preset</span><span class=p>)</span>

        <span class=n>viewport_options</span> <span class=o>=</span> <span class=n>capture_preset</span><span class=p>[</span><span class=s2>&quot;ViewportOptions&quot;</span><span class=p>]</span>
        <span class=c1># Change &#39;list&#39; to &#39;dict&#39; for &#39;capture.py&#39;</span>
        <span class=n>viewport_options</span><span class=p>[</span><span class=s2>&quot;pluginObjects&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>item</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>]:</span> <span class=n>item</span><span class=p>[</span><span class=s2>&quot;value&quot;</span><span class=p>]</span>
            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>viewport_options</span><span class=p>[</span><span class=s2>&quot;pluginObjects&quot;</span><span class=p>]</span>
        <span class=p>}</span>
    <span class=k>return</span> <span class=n>capture_preset</span> <span class=ow>or</span> <span class=p>{}</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_color_management_preferences class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_color_management_preferences</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Get and resolve OCIO preferences.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3966</span>
<span class=normal>3967</span>
<span class=normal>3968</span>
<span class=normal>3969</span>
<span class=normal>3970</span>
<span class=normal>3971</span>
<span class=normal>3972</span>
<span class=normal>3973</span>
<span class=normal>3974</span>
<span class=normal>3975</span>
<span class=normal>3976</span>
<span class=normal>3977</span>
<span class=normal>3978</span>
<span class=normal>3979</span>
<span class=normal>3980</span>
<span class=normal>3981</span>
<span class=normal>3982</span>
<span class=normal>3983</span>
<span class=normal>3984</span>
<span class=normal>3985</span>
<span class=normal>3986</span>
<span class=normal>3987</span>
<span class=normal>3988</span>
<span class=normal>3989</span>
<span class=normal>3990</span>
<span class=normal>3991</span>
<span class=normal>3992</span>
<span class=normal>3993</span>
<span class=normal>3994</span>
<span class=normal>3995</span>
<span class=normal>3996</span>
<span class=normal>3997</span>
<span class=normal>3998</span>
<span class=normal>3999</span>
<span class=normal>4000</span>
<span class=normal>4001</span>
<span class=normal>4002</span>
<span class=normal>4003</span>
<span class=normal>4004</span>
<span class=normal>4005</span>
<span class=normal>4006</span>
<span class=normal>4007</span>
<span class=normal>4008</span>
<span class=normal>4009</span>
<span class=normal>4010</span>
<span class=normal>4011</span>
<span class=normal>4012</span>
<span class=normal>4013</span>
<span class=normal>4014</span>
<span class=normal>4015</span>
<span class=normal>4016</span>
<span class=normal>4017</span>
<span class=normal>4018</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_color_management_preferences</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get and resolve OCIO preferences.&quot;&quot;&quot;</span>
    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=c1># Is color management enabled.</span>
        <span class=s2>&quot;enabled&quot;</span><span class=p>:</span> <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>cmEnabled</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=s2>&quot;rendering_space&quot;</span><span class=p>:</span> <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>renderingSpaceName</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=s2>&quot;output_transform&quot;</span><span class=p>:</span> <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>outputTransformName</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=s2>&quot;output_transform_enabled&quot;</span><span class=p>:</span> <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>outputTransformEnabled</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=s2>&quot;view_transform&quot;</span><span class=p>:</span> <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span>
            <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>viewTransformName</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>)</span>
    <span class=p>}</span>

    <span class=c1># Split view and display from view_transform. view_transform comes in</span>
    <span class=c1># format of &quot;{view} ({display})&quot;.</span>
    <span class=n>regex</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;^(?P&lt;view&gt;.+) \((?P&lt;display&gt;.+)\)$&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>about</span><span class=p>(</span><span class=n>version</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span> <span class=o>&lt;=</span> <span class=mi>2020</span><span class=p>:</span>
        <span class=c1># view_transform comes in format of &quot;{view} {display}&quot; in 2020.</span>
        <span class=n>regex</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;^(?P&lt;view&gt;.+) (?P&lt;display&gt;.+)$&quot;</span><span class=p>)</span>

    <span class=n>match</span> <span class=o>=</span> <span class=n>regex</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;view_transform&quot;</span><span class=p>])</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>match</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=s2>&quot;Unable to parse view and display from Maya view transform: &#39;</span><span class=si>{}</span><span class=s2>&#39; &quot;</span>
            <span class=s2>&quot;using regex &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;view_transform&quot;</span><span class=p>],</span> <span class=n>regex</span><span class=o>.</span><span class=n>pattern</span><span class=p>)</span>
        <span class=p>)</span>

    <span class=n>data</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
        <span class=s2>&quot;display&quot;</span><span class=p>:</span> <span class=n>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=s2>&quot;display&quot;</span><span class=p>),</span>
        <span class=s2>&quot;view&quot;</span><span class=p>:</span> <span class=n>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=s2>&quot;view&quot;</span><span class=p>)</span>
    <span class=p>})</span>

    <span class=c1># Get config absolute path.</span>
    <span class=n>path</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span>
        <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>configFilePath</span><span class=o>=</span><span class=kc>True</span>
    <span class=p>)</span>

    <span class=c1># The OCIO config supports a custom &lt;MAYA_RESOURCES&gt; token.</span>
    <span class=n>maya_resources_token</span> <span class=o>=</span> <span class=s2>&quot;&lt;MAYA_RESOURCES&gt;&quot;</span>
    <span class=n>maya_resources_path</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MGlobal</span><span class=o>.</span><span class=n>getAbsolutePathToResources</span><span class=p>()</span>
    <span class=n>path</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>maya_resources_token</span><span class=p>,</span> <span class=n>maya_resources_path</span><span class=p>)</span>

    <span class=n>data</span><span class=p>[</span><span class=s2>&quot;config&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>path</span>

    <span class=k>return</span> <span class=n>data</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_container_members class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_container_members</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=n>include_reference_associated_nodes</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Returns the members of a container. This includes the nodes from any loaded references in the container.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>container</code> </td> <td> <code><span title=str>str</span> | <span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>The container name or a container dictionary with the "objectName" key.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>include_reference_associated_nodes</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>whether to include the associated nodes of references, like those produced from referencing with <code>groupReference</code>. This is disabled by default, for backwards compatibility to existing calls.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[str]: The nodes belonging to the container.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1848</span>
<span class=normal>1849</span>
<span class=normal>1850</span>
<span class=normal>1851</span>
<span class=normal>1852</span>
<span class=normal>1853</span>
<span class=normal>1854</span>
<span class=normal>1855</span>
<span class=normal>1856</span>
<span class=normal>1857</span>
<span class=normal>1858</span>
<span class=normal>1859</span>
<span class=normal>1860</span>
<span class=normal>1861</span>
<span class=normal>1862</span>
<span class=normal>1863</span>
<span class=normal>1864</span>
<span class=normal>1865</span>
<span class=normal>1866</span>
<span class=normal>1867</span>
<span class=normal>1868</span>
<span class=normal>1869</span>
<span class=normal>1870</span>
<span class=normal>1871</span>
<span class=normal>1872</span>
<span class=normal>1873</span>
<span class=normal>1874</span>
<span class=normal>1875</span>
<span class=normal>1876</span>
<span class=normal>1877</span>
<span class=normal>1878</span>
<span class=normal>1879</span>
<span class=normal>1880</span>
<span class=normal>1881</span>
<span class=normal>1882</span>
<span class=normal>1883</span>
<span class=normal>1884</span>
<span class=normal>1885</span>
<span class=normal>1886</span>
<span class=normal>1887</span>
<span class=normal>1888</span>
<span class=normal>1889</span>
<span class=normal>1890</span>
<span class=normal>1891</span>
<span class=normal>1892</span>
<span class=normal>1893</span>
<span class=normal>1894</span>
<span class=normal>1895</span>
<span class=normal>1896</span>
<span class=normal>1897</span>
<span class=normal>1898</span>
<span class=normal>1899</span>
<span class=normal>1900</span>
<span class=normal>1901</span>
<span class=normal>1902</span>
<span class=normal>1903</span>
<span class=normal>1904</span>
<span class=normal>1905</span>
<span class=normal>1906</span>
<span class=normal>1907</span>
<span class=normal>1908</span>
<span class=normal>1909</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_container_members</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=n>include_reference_associated_nodes</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Returns the members of a container.</span>
<span class=sd>    This includes the nodes from any loaded references in the container.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        container (str | dict): The container name or a container dictionary</span>
<span class=sd>            with the &quot;objectName&quot; key.</span>
<span class=sd>        include_reference_associated_nodes (bool): whether to include the</span>
<span class=sd>            associated nodes of references, like those produced from</span>
<span class=sd>            referencing with `groupReference`. This is disabled by default,</span>
<span class=sd>            for backwards compatibility to existing calls.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[str]: The nodes belonging to the container.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=nb>dict</span><span class=p>):</span>
        <span class=c1># Assume it&#39;s a container dictionary</span>
        <span class=n>container</span> <span class=o>=</span> <span class=n>container</span><span class=p>[</span><span class=s2>&quot;objectName&quot;</span><span class=p>]</span>

    <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
    <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>objectsOnly</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
    <span class=n>all_members</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>members</span><span class=p>)</span>

    <span class=c1># Include any referenced nodes from any reference in the container</span>
    <span class=c1># This is required since we&#39;ve removed adding ALL nodes of a reference</span>
    <span class=c1># into the container set and only add the reference node now.</span>
    <span class=k>for</span> <span class=n>ref</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>exactType</span><span class=o>=</span><span class=s2>&quot;reference&quot;</span><span class=p>,</span> <span class=n>objectsOnly</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>

        <span class=c1># Ignore any `:sharedReferenceNode`</span>
        <span class=k>if</span> <span class=n>ref</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;sharedReferenceNode&quot;</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=c1># Ignore _UNKNOWN_REF_NODE_ (PLN-160)</span>
        <span class=k>if</span> <span class=n>ref</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;_UNKNOWN_REF_NODE_&quot;</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=k>try</span><span class=p>:</span>
            <span class=n>reference_members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>referenceQuery</span><span class=p>(</span><span class=n>ref</span><span class=p>,</span>
                                                    <span class=n>nodes</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                                    <span class=n>dagPath</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
            <span class=c1># Ignore reference nodes that are not associated with a</span>
            <span class=c1># referenced file on which `referenceQuery` command fails</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>is_valid_reference_node</span><span class=p>(</span><span class=n>ref</span><span class=p>):</span>
                <span class=k>continue</span>
            <span class=k>raise</span>
        <span class=n>reference_members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>reference_members</span><span class=p>,</span>
                                    <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                    <span class=n>objectsOnly</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>all_members</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>reference_members</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>include_reference_associated_nodes</span><span class=p>:</span>
            <span class=n>associated_nodes</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span>
                <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>ref</span><span class=si>}</span><span class=s2>.associatedNode&quot;</span><span class=p>,</span>
                <span class=n>source</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                <span class=n>destination</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                <span class=n>fullNodeName</span><span class=o>=</span><span class=kc>True</span>
            <span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
            <span class=n>all_members</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>associated_nodes</span><span class=p>)</span>

    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>all_members</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_container_transforms class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_container_transforms</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=n>members</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>root</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Retrieve the root node of the container content</p> <p>When a container is created through a Loader the content of the file will be grouped under a transform. The name of the root transform is stored in the container information</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>container</code> </td> <td> <code><span title=dict>dict</span> | <span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the container</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>members</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>optional and convenience argument</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>root</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>return highest node in hierarchy if True</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[str] | str: List of highest nodes, or first entry if root argument is True</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2248</span>
<span class=normal>2249</span>
<span class=normal>2250</span>
<span class=normal>2251</span>
<span class=normal>2252</span>
<span class=normal>2253</span>
<span class=normal>2254</span>
<span class=normal>2255</span>
<span class=normal>2256</span>
<span class=normal>2257</span>
<span class=normal>2258</span>
<span class=normal>2259</span>
<span class=normal>2260</span>
<span class=normal>2261</span>
<span class=normal>2262</span>
<span class=normal>2263</span>
<span class=normal>2264</span>
<span class=normal>2265</span>
<span class=normal>2266</span>
<span class=normal>2267</span>
<span class=normal>2268</span>
<span class=normal>2269</span>
<span class=normal>2270</span>
<span class=normal>2271</span>
<span class=normal>2272</span>
<span class=normal>2273</span>
<span class=normal>2274</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_container_transforms</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=n>members</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>root</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Retrieve the root node of the container content</span>

<span class=sd>    When a container is created through a Loader the content</span>
<span class=sd>    of the file will be grouped under a transform. The name of the root</span>
<span class=sd>    transform is stored in the container information</span>

<span class=sd>    Args:</span>
<span class=sd>        container (dict | str): the container</span>
<span class=sd>        members (list): optional and convenience argument</span>
<span class=sd>        root (bool): return highest node in hierarchy if True</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[str] | str: List of highest nodes, or first entry if</span>
<span class=sd>            root argument is True</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>members</span><span class=p>:</span>
        <span class=n>members</span> <span class=o>=</span> <span class=n>get_container_members</span><span class=p>(</span><span class=n>container</span><span class=p>)</span>

    <span class=n>results</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>root</span><span class=p>:</span>
        <span class=n>root</span> <span class=o>=</span> <span class=n>get_highest_in_hierarchy</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>root</span><span class=p>:</span>
            <span class=n>results</span> <span class=o>=</span> <span class=n>root</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>

    <span class=k>return</span> <span class=n>results</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_creator_identifier class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_creator_identifier</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the creator identifier of an instance node.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The name of the instance node.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=str>str</span> | None</code> </td> <td> <div class=doc-md-description> <p>str | None: The creator identifier of the instance or None if not found.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4308</span>
<span class=normal>4309</span>
<span class=normal>4310</span>
<span class=normal>4311</span>
<span class=normal>4312</span>
<span class=normal>4313</span>
<span class=normal>4314</span>
<span class=normal>4315</span>
<span class=normal>4316</span>
<span class=normal>4317</span>
<span class=normal>4318</span>
<span class=normal>4319</span>
<span class=normal>4320</span>
<span class=normal>4321</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_creator_identifier</span><span class=p>(</span><span class=n>node</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span> <span class=o>|</span> <span class=kc>None</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the creator identifier of an instance node.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        node (str): The name of the instance node.</span>

<span class=sd>    Returns:</span>
<span class=sd>        str | None: The creator identifier of the instance or None if not found.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>get_attribute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>node</span><span class=si>}</span><span class=s2>.id&quot;</span><span class=p>)</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>{</span>
        <span class=n>AYON_INSTANCE_ID</span><span class=p>,</span> <span class=n>AVALON_INSTANCE_ID</span>
    <span class=p>}:</span>
        <span class=k>return</span> <span class=kc>None</span>
    <span class=k>return</span> <span class=n>get_attribute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>node</span><span class=si>}</span><span class=s2>.creator_identifier&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_custom_namespace class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_custom_namespace</span><span class=p>(</span><span class=n>custom_namespace</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return unique namespace.</p> <p>The input namespace can contain a single group of '#' number tokens to indicate where the namespace's unique index should go. The amount of tokens defines the zero padding of the number, e.g ### turns into 001.</p> <details class=warning open> <summary>Note that a namespace will always be</summary> <p>prefixed with a _ if it starts with a digit</p> </details> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <blockquote> <p>get_custom_namespace("myspace_##_")</p> </blockquote> </blockquote> </blockquote> <h3 id=client.ayon_maya.api.lib.get_custom_namespace--myspace_01_>myspace_01_</h3> <blockquote> <blockquote> <blockquote> <p>get_custom_namespace("##_myspace")</p> </blockquote> </blockquote> </blockquote> <h3 id=client.ayon_maya.api.lib.get_custom_namespace--_01_myspace>_01_myspace</h3> <blockquote> <blockquote> <blockquote> <p>get_custom_namespace("myspace##")</p> </blockquote> </blockquote> </blockquote> <h3 id=client.ayon_maya.api.lib.get_custom_namespace--myspace01>myspace01</h3> </details> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>438</span>
<span class=normal>439</span>
<span class=normal>440</span>
<span class=normal>441</span>
<span class=normal>442</span>
<span class=normal>443</span>
<span class=normal>444</span>
<span class=normal>445</span>
<span class=normal>446</span>
<span class=normal>447</span>
<span class=normal>448</span>
<span class=normal>449</span>
<span class=normal>450</span>
<span class=normal>451</span>
<span class=normal>452</span>
<span class=normal>453</span>
<span class=normal>454</span>
<span class=normal>455</span>
<span class=normal>456</span>
<span class=normal>457</span>
<span class=normal>458</span>
<span class=normal>459</span>
<span class=normal>460</span>
<span class=normal>461</span>
<span class=normal>462</span>
<span class=normal>463</span>
<span class=normal>464</span>
<span class=normal>465</span>
<span class=normal>466</span>
<span class=normal>467</span>
<span class=normal>468</span>
<span class=normal>469</span>
<span class=normal>470</span>
<span class=normal>471</span>
<span class=normal>472</span>
<span class=normal>473</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_custom_namespace</span><span class=p>(</span><span class=n>custom_namespace</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return unique namespace.</span>

<span class=sd>    The input namespace can contain a single group</span>
<span class=sd>    of &#39;#&#39; number tokens to indicate where the namespace&#39;s</span>
<span class=sd>    unique index should go. The amount of tokens defines</span>
<span class=sd>    the zero padding of the number, e.g ### turns into 001.</span>

<span class=sd>    Warning: Note that a namespace will always be</span>
<span class=sd>        prefixed with a _ if it starts with a digit</span>

<span class=sd>    Example:</span>
<span class=sd>        &gt;&gt;&gt; get_custom_namespace(&quot;myspace_##_&quot;)</span>
<span class=sd>        # myspace_01_</span>
<span class=sd>        &gt;&gt;&gt; get_custom_namespace(&quot;##_myspace&quot;)</span>
<span class=sd>        # _01_myspace</span>
<span class=sd>        &gt;&gt;&gt; get_custom_namespace(&quot;myspace##&quot;)</span>
<span class=sd>        # myspace01</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>split</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;([#]+)&quot;</span><span class=p>,</span> <span class=n>custom_namespace</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>

    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>split</span><span class=p>)</span> <span class=o>==</span> <span class=mi>3</span><span class=p>:</span>
        <span class=n>base</span><span class=p>,</span> <span class=n>padding</span><span class=p>,</span> <span class=n>suffix</span> <span class=o>=</span> <span class=n>split</span>
        <span class=n>padding</span> <span class=o>=</span> <span class=s2>&quot;%0</span><span class=si>{}</span><span class=s2>d&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>padding</span><span class=p>))</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>base</span> <span class=o>=</span> <span class=n>split</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=n>padding</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>%02d</span><span class=s2>&quot;</span>  <span class=c1># default padding</span>
        <span class=n>suffix</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>

    <span class=k>return</span> <span class=n>unique_namespace</span><span class=p>(</span>
        <span class=n>base</span><span class=p>,</span>
        <span class=nb>format</span><span class=o>=</span><span class=n>padding</span><span class=p>,</span>
        <span class=n>prefix</span><span class=o>=</span><span class=s2>&quot;_&quot;</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>base</span> <span class=ow>or</span> <span class=n>base</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>isdigit</span><span class=p>()</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span><span class=p>,</span>
        <span class=n>suffix</span><span class=o>=</span><span class=n>suffix</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_fps_for_current_context class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_fps_for_current_context</span><span class=p>(</span><span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get fps that should be set for current context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>task_entity</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Task entity to use. If not provided, the current task entity is used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Union[int, float]: FPS value.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2582</span>
<span class=normal>2583</span>
<span class=normal>2584</span>
<span class=normal>2585</span>
<span class=normal>2586</span>
<span class=normal>2587</span>
<span class=normal>2588</span>
<span class=normal>2589</span>
<span class=normal>2590</span>
<span class=normal>2591</span>
<span class=normal>2592</span>
<span class=normal>2593</span>
<span class=normal>2594</span>
<span class=normal>2595</span>
<span class=normal>2596</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_fps_for_current_context</span><span class=p>(</span><span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get fps that should be set for current context.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        task_entity (dict, optional): Task entity to use.</span>
<span class=sd>            If not provided, the current task entity is used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Union[int, float]: FPS value.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>task_entity</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>task_entity</span> <span class=o>=</span> <span class=n>get_current_task_entity</span><span class=p>(</span><span class=n>fields</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;attrib.fps&quot;</span><span class=p>})</span>
    <span class=n>fps</span> <span class=o>=</span> <span class=n>task_entity</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;attrib&quot;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;fps&quot;</span><span class=p>,</span> <span class=mi>25</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>convert_to_maya_fps</span><span class=p>(</span><span class=n>fps</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_frame_range class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_frame_range</span><span class=p>(</span><span class=n>include_animation_range</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the current task frame range and handles.</p> <p>Note: This does <em>not</em> return the Maya time slider range.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>include_animation_range</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include <code>animationStart</code> and <code>animationEnd</code> keys to define the outer range of the timeline. It is excluded by default.</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>task_entity</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Task entity to use. If not provided, the current task entity is used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>project_settings</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Project settings to use. If not provided, the current project settings are used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>Task's expected frame range values.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2599</span>
<span class=normal>2600</span>
<span class=normal>2601</span>
<span class=normal>2602</span>
<span class=normal>2603</span>
<span class=normal>2604</span>
<span class=normal>2605</span>
<span class=normal>2606</span>
<span class=normal>2607</span>
<span class=normal>2608</span>
<span class=normal>2609</span>
<span class=normal>2610</span>
<span class=normal>2611</span>
<span class=normal>2612</span>
<span class=normal>2613</span>
<span class=normal>2614</span>
<span class=normal>2615</span>
<span class=normal>2616</span>
<span class=normal>2617</span>
<span class=normal>2618</span>
<span class=normal>2619</span>
<span class=normal>2620</span>
<span class=normal>2621</span>
<span class=normal>2622</span>
<span class=normal>2623</span>
<span class=normal>2624</span>
<span class=normal>2625</span>
<span class=normal>2626</span>
<span class=normal>2627</span>
<span class=normal>2628</span>
<span class=normal>2629</span>
<span class=normal>2630</span>
<span class=normal>2631</span>
<span class=normal>2632</span>
<span class=normal>2633</span>
<span class=normal>2634</span>
<span class=normal>2635</span>
<span class=normal>2636</span>
<span class=normal>2637</span>
<span class=normal>2638</span>
<span class=normal>2639</span>
<span class=normal>2640</span>
<span class=normal>2641</span>
<span class=normal>2642</span>
<span class=normal>2643</span>
<span class=normal>2644</span>
<span class=normal>2645</span>
<span class=normal>2646</span>
<span class=normal>2647</span>
<span class=normal>2648</span>
<span class=normal>2649</span>
<span class=normal>2650</span>
<span class=normal>2651</span>
<span class=normal>2652</span>
<span class=normal>2653</span>
<span class=normal>2654</span>
<span class=normal>2655</span>
<span class=normal>2656</span>
<span class=normal>2657</span>
<span class=normal>2658</span>
<span class=normal>2659</span>
<span class=normal>2660</span>
<span class=normal>2661</span>
<span class=normal>2662</span>
<span class=normal>2663</span>
<span class=normal>2664</span>
<span class=normal>2665</span>
<span class=normal>2666</span>
<span class=normal>2667</span>
<span class=normal>2668</span>
<span class=normal>2669</span>
<span class=normal>2670</span>
<span class=normal>2671</span>
<span class=normal>2672</span>
<span class=normal>2673</span>
<span class=normal>2674</span>
<span class=normal>2675</span>
<span class=normal>2676</span>
<span class=normal>2677</span>
<span class=normal>2678</span>
<span class=normal>2679</span>
<span class=normal>2680</span>
<span class=normal>2681</span>
<span class=normal>2682</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_frame_range</span><span class=p>(</span>
        <span class=n>include_animation_range</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
        <span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
        <span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the current task frame range and handles.</span>

<span class=sd>    Note: This does *not* return the Maya time slider range.</span>

<span class=sd>    Args:</span>
<span class=sd>        include_animation_range (bool, optional): Whether to include</span>
<span class=sd>            `animationStart` and `animationEnd` keys to define the outer</span>
<span class=sd>            range of the timeline. It is excluded by default.</span>
<span class=sd>        task_entity (dict, optional): Task entity to use.</span>
<span class=sd>            If not provided, the current task entity is used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>
<span class=sd>        project_settings (dict, optional): Project settings to use.</span>
<span class=sd>            If not provided, the current project settings are used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: Task&#39;s expected frame range values.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>task_entity</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>task_entity</span> <span class=o>=</span> <span class=n>get_current_task_entity</span><span class=p>(</span>
            <span class=n>fields</span><span class=o>=</span><span class=p>{</span>
                <span class=s2>&quot;taskType&quot;</span><span class=p>,</span>
                <span class=s2>&quot;attrib.frameStart&quot;</span><span class=p>,</span>
                <span class=s2>&quot;attrib.frameEnd&quot;</span><span class=p>,</span>
                <span class=s2>&quot;attrib.handleStart&quot;</span><span class=p>,</span>
                <span class=s2>&quot;attrib.handleEnd&quot;</span><span class=p>,</span>
            <span class=p>}</span>
        <span class=p>)</span>
    <span class=n>task_attributes</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>]</span>

    <span class=n>frame_start</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameStart&quot;</span><span class=p>)</span>
    <span class=n>frame_end</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>frame_start</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>frame_end</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=c1># This should never happen because attributes always exist on tasks</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
            <span class=s2>&quot;No frame start and frame end information found for current task.&quot;</span>
        <span class=p>)</span>
        <span class=k>return</span>

    <span class=n>handle_start</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;handleStart&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=mi>0</span>
    <span class=n>handle_end</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;handleEnd&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=mi>0</span>

    <span class=n>frame_range</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=n>frame_start</span><span class=p>,</span>
        <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=n>frame_end</span><span class=p>,</span>
        <span class=s2>&quot;handleStart&quot;</span><span class=p>:</span> <span class=n>handle_start</span><span class=p>,</span>
        <span class=s2>&quot;handleEnd&quot;</span><span class=p>:</span> <span class=n>handle_end</span>
    <span class=p>}</span>
    <span class=k>if</span> <span class=n>include_animation_range</span><span class=p>:</span>
        <span class=c1># The animation range values are only included to define whether</span>
        <span class=c1># the Maya time slider should include the handles or not.</span>
        <span class=c1># Some usages of this function use the full dictionary to define</span>
        <span class=c1># instance attributes for which we want to exclude the animation</span>
        <span class=c1># keys. That is why these are excluded by default.</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>project_settings</span><span class=p>:</span>
            <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
            <span class=n>project_settings</span> <span class=o>=</span> <span class=n>get_project_settings</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

        <span class=n>task_type</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;taskType&quot;</span><span class=p>]</span>

        <span class=n>include_handles_settings</span> <span class=o>=</span> <span class=n>project_settings</span><span class=p>[</span><span class=s2>&quot;maya&quot;</span><span class=p>][</span><span class=s2>&quot;include_handles&quot;</span><span class=p>]</span>

        <span class=n>animation_start</span> <span class=o>=</span> <span class=n>frame_start</span>
        <span class=n>animation_end</span> <span class=o>=</span> <span class=n>frame_end</span>

        <span class=n>include_handles</span> <span class=o>=</span> <span class=n>include_handles_settings</span><span class=p>[</span><span class=s2>&quot;include_handles_default&quot;</span><span class=p>]</span>
        <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>include_handles_settings</span><span class=p>[</span><span class=s2>&quot;per_task_type&quot;</span><span class=p>]:</span>
            <span class=k>if</span> <span class=n>task_type</span> <span class=ow>in</span> <span class=n>item</span><span class=p>[</span><span class=s2>&quot;task_type&quot;</span><span class=p>]:</span>
                <span class=n>include_handles</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s2>&quot;include_handles&quot;</span><span class=p>]</span>
                <span class=k>break</span>
        <span class=k>if</span> <span class=n>include_handles</span><span class=p>:</span>
            <span class=n>animation_start</span> <span class=o>-=</span> <span class=nb>int</span><span class=p>(</span><span class=n>handle_start</span><span class=p>)</span>
            <span class=n>animation_end</span> <span class=o>+=</span> <span class=nb>int</span><span class=p>(</span><span class=n>handle_end</span><span class=p>)</span>

        <span class=n>frame_range</span><span class=p>[</span><span class=s2>&quot;animationStart&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>animation_start</span>
        <span class=n>frame_range</span><span class=p>[</span><span class=s2>&quot;animationEnd&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>animation_end</span>

    <span class=k>return</span> <span class=n>frame_range</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_highest_in_hierarchy class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_highest_in_hierarchy</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return highest nodes in the hierarchy that are in the <code>nodes</code> list.</p> <p>The "highest in hierarchy" are the nodes closest to world: top-most level. The result only contains DAG nodes.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>The nodes in which find the highest in hierarchies.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[str]: The highest DAG nodes from the input nodes.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2277</span>
<span class=normal>2278</span>
<span class=normal>2279</span>
<span class=normal>2280</span>
<span class=normal>2281</span>
<span class=normal>2282</span>
<span class=normal>2283</span>
<span class=normal>2284</span>
<span class=normal>2285</span>
<span class=normal>2286</span>
<span class=normal>2287</span>
<span class=normal>2288</span>
<span class=normal>2289</span>
<span class=normal>2290</span>
<span class=normal>2291</span>
<span class=normal>2292</span>
<span class=normal>2293</span>
<span class=normal>2294</span>
<span class=normal>2295</span>
<span class=normal>2296</span>
<span class=normal>2297</span>
<span class=normal>2298</span>
<span class=normal>2299</span>
<span class=normal>2300</span>
<span class=normal>2301</span>
<span class=normal>2302</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_highest_in_hierarchy</span><span class=p>(</span><span class=n>nodes</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return highest nodes in the hierarchy that are in the `nodes` list.</span>

<span class=sd>    The &quot;highest in hierarchy&quot; are the nodes closest to world: top-most level.</span>
<span class=sd>    The result only contains DAG nodes.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (list[str]): The nodes in which find the highest in hierarchies.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[str]: The highest DAG nodes from the input nodes.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Ensure we use long names</span>
    <span class=n>nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;dagNode&quot;</span><span class=p>)</span>
    <span class=n>lookup</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>

    <span class=n>highest</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=c1># If no parents are within the nodes input list</span>
        <span class=c1># then this is a highest node</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>(</span><span class=n>n</span> <span class=ow>in</span> <span class=n>lookup</span> <span class=k>for</span> <span class=n>n</span> <span class=ow>in</span> <span class=n>iter_parents</span><span class=p>(</span><span class=n>node</span><span class=p>)):</span>
            <span class=n>highest</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>highest</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_id class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_id</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the <code>cbId</code> attribute of the given node.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the name of the node to retrieve the attribute from</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p>Returns: str</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1583</span>
<span class=normal>1584</span>
<span class=normal>1585</span>
<span class=normal>1586</span>
<span class=normal>1587</span>
<span class=normal>1588</span>
<span class=normal>1589</span>
<span class=normal>1590</span>
<span class=normal>1591</span>
<span class=normal>1592</span>
<span class=normal>1593</span>
<span class=normal>1594</span>
<span class=normal>1595</span>
<span class=normal>1596</span>
<span class=normal>1597</span>
<span class=normal>1598</span>
<span class=normal>1599</span>
<span class=normal>1600</span>
<span class=normal>1601</span>
<span class=normal>1602</span>
<span class=normal>1603</span>
<span class=normal>1604</span>
<span class=normal>1605</span>
<span class=normal>1606</span>
<span class=normal>1607</span>
<span class=normal>1608</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_id</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the `cbId` attribute of the given node.</span>

<span class=sd>    Args:</span>
<span class=sd>        node (str): the name of the node to retrieve the attribute from</span>
<span class=sd>    Returns:</span>
<span class=sd>        str</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>node</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=n>sel</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MSelectionList</span><span class=p>()</span>
    <span class=n>sel</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

    <span class=n>api_node</span> <span class=o>=</span> <span class=n>sel</span><span class=o>.</span><span class=n>getDependNode</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
    <span class=n>fn</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDependencyNode</span><span class=p>(</span><span class=n>api_node</span><span class=p>)</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>fn</span><span class=o>.</span><span class=n>hasAttribute</span><span class=p>(</span><span class=s2>&quot;cbId&quot;</span><span class=p>):</span>
        <span class=k>return</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>fn</span><span class=o>.</span><span class=n>findPlug</span><span class=p>(</span><span class=s2>&quot;cbId&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span><span class=o>.</span><span class=n>asString</span><span class=p>()</span>
    <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;Failed to retrieve cbId on </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>node</span><span class=p>)</span>
        <span class=k>return</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_id_from_sibling class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_id_from_sibling</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>history_only</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return first node id in the history chain that matches this node.</p> <p>The nodes in history must be of the exact same node type and must be parented under the same parent.</p> <p>Optionally, if no matching node is found from the history, all the siblings of the node that are of the same type are checked. Additionally to having the same parent, the sibling must be marked as 'intermediate object'.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>node to retrieve the history from</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>history_only</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>if True and if nothing found in history, look for an 'intermediate object' in all the node's siblings of same type</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>str or None: The id from the sibling node or None when no id found on any valid nodes in the history or siblings.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2395</span>
<span class=normal>2396</span>
<span class=normal>2397</span>
<span class=normal>2398</span>
<span class=normal>2399</span>
<span class=normal>2400</span>
<span class=normal>2401</span>
<span class=normal>2402</span>
<span class=normal>2403</span>
<span class=normal>2404</span>
<span class=normal>2405</span>
<span class=normal>2406</span>
<span class=normal>2407</span>
<span class=normal>2408</span>
<span class=normal>2409</span>
<span class=normal>2410</span>
<span class=normal>2411</span>
<span class=normal>2412</span>
<span class=normal>2413</span>
<span class=normal>2414</span>
<span class=normal>2415</span>
<span class=normal>2416</span>
<span class=normal>2417</span>
<span class=normal>2418</span>
<span class=normal>2419</span>
<span class=normal>2420</span>
<span class=normal>2421</span>
<span class=normal>2422</span>
<span class=normal>2423</span>
<span class=normal>2424</span>
<span class=normal>2425</span>
<span class=normal>2426</span>
<span class=normal>2427</span>
<span class=normal>2428</span>
<span class=normal>2429</span>
<span class=normal>2430</span>
<span class=normal>2431</span>
<span class=normal>2432</span>
<span class=normal>2433</span>
<span class=normal>2434</span>
<span class=normal>2435</span>
<span class=normal>2436</span>
<span class=normal>2437</span>
<span class=normal>2438</span>
<span class=normal>2439</span>
<span class=normal>2440</span>
<span class=normal>2441</span>
<span class=normal>2442</span>
<span class=normal>2443</span>
<span class=normal>2444</span>
<span class=normal>2445</span>
<span class=normal>2446</span>
<span class=normal>2447</span>
<span class=normal>2448</span>
<span class=normal>2449</span>
<span class=normal>2450</span>
<span class=normal>2451</span>
<span class=normal>2452</span>
<span class=normal>2453</span>
<span class=normal>2454</span>
<span class=normal>2455</span>
<span class=normal>2456</span>
<span class=normal>2457</span>
<span class=normal>2458</span>
<span class=normal>2459</span>
<span class=normal>2460</span>
<span class=normal>2461</span>
<span class=normal>2462</span>
<span class=normal>2463</span>
<span class=normal>2464</span>
<span class=normal>2465</span>
<span class=normal>2466</span>
<span class=normal>2467</span>
<span class=normal>2468</span>
<span class=normal>2469</span>
<span class=normal>2470</span>
<span class=normal>2471</span>
<span class=normal>2472</span>
<span class=normal>2473</span>
<span class=normal>2474</span>
<span class=normal>2475</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_id_from_sibling</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>history_only</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return first node id in the history chain that matches this node.</span>

<span class=sd>    The nodes in history must be of the exact same node type and must be</span>
<span class=sd>    parented under the same parent.</span>

<span class=sd>    Optionally, if no matching node is found from the history, all the</span>
<span class=sd>    siblings of the node that are of the same type are checked.</span>
<span class=sd>    Additionally to having the same parent, the sibling must be marked as</span>
<span class=sd>    &#39;intermediate object&#39;.</span>

<span class=sd>    Args:</span>
<span class=sd>        node (str): node to retrieve the history from</span>
<span class=sd>        history_only (bool): if True and if nothing found in history,</span>
<span class=sd>            look for an &#39;intermediate object&#39; in all the node&#39;s siblings</span>
<span class=sd>            of same type</span>

<span class=sd>    Returns:</span>
<span class=sd>        str or None: The id from the sibling node or None when no id found</span>
<span class=sd>            on any valid nodes in the history or siblings.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>node</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

    <span class=c1># Find all similar nodes in history</span>
    <span class=n>history</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listHistory</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
    <span class=n>node_type</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>nodeType</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
    <span class=n>similar_nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>history</span><span class=p>,</span> <span class=n>exactType</span><span class=o>=</span><span class=n>node_type</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># Exclude itself</span>
    <span class=n>similar_nodes</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>similar_nodes</span> <span class=k>if</span> <span class=n>x</span> <span class=o>!=</span> <span class=n>node</span><span class=p>]</span>

    <span class=c1># The node *must be* under the same parent</span>
    <span class=n>parent</span> <span class=o>=</span> <span class=n>get_node_parent</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
    <span class=n>similar_nodes</span> <span class=o>=</span> <span class=p>[</span><span class=n>i</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>similar_nodes</span> <span class=k>if</span> <span class=n>get_node_parent</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=o>==</span> <span class=n>parent</span><span class=p>]</span>

    <span class=c1># Check all of the remaining similar nodes and take the first one</span>
    <span class=c1># with an id and assume it&#39;s the original.</span>
    <span class=k>for</span> <span class=n>similar_node</span> <span class=ow>in</span> <span class=n>similar_nodes</span><span class=p>:</span>
        <span class=n>_id</span> <span class=o>=</span> <span class=n>get_id</span><span class=p>(</span><span class=n>similar_node</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>_id</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>_id</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>history_only</span><span class=p>:</span>
        <span class=c1># Get siblings of same type</span>
        <span class=n>similar_nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>parent</span><span class=p>,</span>
                                           <span class=nb>type</span><span class=o>=</span><span class=n>node_type</span><span class=p>,</span>
                                           <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>similar_nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>similar_nodes</span><span class=p>,</span> <span class=n>exactType</span><span class=o>=</span><span class=n>node_type</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=c1># Exclude itself</span>
        <span class=n>similar_nodes</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>similar_nodes</span> <span class=k>if</span> <span class=n>x</span> <span class=o>!=</span> <span class=n>node</span><span class=p>]</span>

        <span class=c1># Get all unique ids from siblings in order since</span>
        <span class=c1># we consistently take the first one found</span>
        <span class=n>sibling_ids</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>similar_node</span> <span class=ow>in</span> <span class=n>similar_nodes</span><span class=p>:</span>
            <span class=c1># Check if &quot;intermediate object&quot;</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>similar_node</span> <span class=o>+</span> <span class=s2>&quot;.intermediateObject&quot;</span><span class=p>):</span>
                <span class=k>continue</span>

            <span class=n>_id</span> <span class=o>=</span> <span class=n>get_id</span><span class=p>(</span><span class=n>similar_node</span><span class=p>)</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>_id</span><span class=p>:</span>
                <span class=k>continue</span>

            <span class=k>if</span> <span class=n>_id</span> <span class=ow>in</span> <span class=n>sibling_ids</span><span class=p>:</span>
                <span class=n>sibling_ids</span><span class=p>[</span><span class=n>_id</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>similar_node</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>sibling_ids</span><span class=p>[</span><span class=n>_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>similar_node</span><span class=p>]</span>

        <span class=k>if</span> <span class=n>sibling_ids</span><span class=p>:</span>
            <span class=n>first_id</span><span class=p>,</span> <span class=n>found_nodes</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span><span class=nb>iter</span><span class=p>(</span><span class=n>sibling_ids</span><span class=o>.</span><span class=n>items</span><span class=p>()))</span>

            <span class=c1># Log a warning if we&#39;ve found multiple unique ids</span>
            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>sibling_ids</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
                <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>((</span><span class=s2>&quot;Found more than 1 intermediate shape with&quot;</span>
                             <span class=s2>&quot; unique id for &#39;</span><span class=si>{}</span><span class=s2>&#39;. Using id of first&quot;</span>
                             <span class=s2>&quot; found: &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>found_nodes</span><span class=p>[</span><span class=mi>0</span><span class=p>])))</span>

            <span class=k>return</span> <span class=n>first_id</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_id_required_nodes class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_id_required_nodes</span><span class=p>(</span><span class=n>referenced_nodes</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>nodes</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>existing_ids</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return nodes that should receive a <code>cbId</code> attribute.</p> <p>This includes only mesh and curve nodes, parent transforms of the shape nodes, file texture nodes and object sets (including shading engines).</p> <p>This filters out any node which is locked, referenced, read-only, intermediate object.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>referenced_nodes</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>set True to include referenced nodes</p> </div> </td> <td> <code>False</code> </td> </tr> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code>(<span title=list>list</span>, <span title=Optional>Optional</span>)</code> </td> <td> <div class=doc-md-description> <p>nodes to consider</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>existing_ids</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>set True to include nodes with <code>cbId</code> attribute</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>nodes</code></td> <td> <code><span title=set>set</span></code> </td> <td> <div class=doc-md-description> <p>list of filtered nodes</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1389</span>
<span class=normal>1390</span>
<span class=normal>1391</span>
<span class=normal>1392</span>
<span class=normal>1393</span>
<span class=normal>1394</span>
<span class=normal>1395</span>
<span class=normal>1396</span>
<span class=normal>1397</span>
<span class=normal>1398</span>
<span class=normal>1399</span>
<span class=normal>1400</span>
<span class=normal>1401</span>
<span class=normal>1402</span>
<span class=normal>1403</span>
<span class=normal>1404</span>
<span class=normal>1405</span>
<span class=normal>1406</span>
<span class=normal>1407</span>
<span class=normal>1408</span>
<span class=normal>1409</span>
<span class=normal>1410</span>
<span class=normal>1411</span>
<span class=normal>1412</span>
<span class=normal>1413</span>
<span class=normal>1414</span>
<span class=normal>1415</span>
<span class=normal>1416</span>
<span class=normal>1417</span>
<span class=normal>1418</span>
<span class=normal>1419</span>
<span class=normal>1420</span>
<span class=normal>1421</span>
<span class=normal>1422</span>
<span class=normal>1423</span>
<span class=normal>1424</span>
<span class=normal>1425</span>
<span class=normal>1426</span>
<span class=normal>1427</span>
<span class=normal>1428</span>
<span class=normal>1429</span>
<span class=normal>1430</span>
<span class=normal>1431</span>
<span class=normal>1432</span>
<span class=normal>1433</span>
<span class=normal>1434</span>
<span class=normal>1435</span>
<span class=normal>1436</span>
<span class=normal>1437</span>
<span class=normal>1438</span>
<span class=normal>1439</span>
<span class=normal>1440</span>
<span class=normal>1441</span>
<span class=normal>1442</span>
<span class=normal>1443</span>
<span class=normal>1444</span>
<span class=normal>1445</span>
<span class=normal>1446</span>
<span class=normal>1447</span>
<span class=normal>1448</span>
<span class=normal>1449</span>
<span class=normal>1450</span>
<span class=normal>1451</span>
<span class=normal>1452</span>
<span class=normal>1453</span>
<span class=normal>1454</span>
<span class=normal>1455</span>
<span class=normal>1456</span>
<span class=normal>1457</span>
<span class=normal>1458</span>
<span class=normal>1459</span>
<span class=normal>1460</span>
<span class=normal>1461</span>
<span class=normal>1462</span>
<span class=normal>1463</span>
<span class=normal>1464</span>
<span class=normal>1465</span>
<span class=normal>1466</span>
<span class=normal>1467</span>
<span class=normal>1468</span>
<span class=normal>1469</span>
<span class=normal>1470</span>
<span class=normal>1471</span>
<span class=normal>1472</span>
<span class=normal>1473</span>
<span class=normal>1474</span>
<span class=normal>1475</span>
<span class=normal>1476</span>
<span class=normal>1477</span>
<span class=normal>1478</span>
<span class=normal>1479</span>
<span class=normal>1480</span>
<span class=normal>1481</span>
<span class=normal>1482</span>
<span class=normal>1483</span>
<span class=normal>1484</span>
<span class=normal>1485</span>
<span class=normal>1486</span>
<span class=normal>1487</span>
<span class=normal>1488</span>
<span class=normal>1489</span>
<span class=normal>1490</span>
<span class=normal>1491</span>
<span class=normal>1492</span>
<span class=normal>1493</span>
<span class=normal>1494</span>
<span class=normal>1495</span>
<span class=normal>1496</span>
<span class=normal>1497</span>
<span class=normal>1498</span>
<span class=normal>1499</span>
<span class=normal>1500</span>
<span class=normal>1501</span>
<span class=normal>1502</span>
<span class=normal>1503</span>
<span class=normal>1504</span>
<span class=normal>1505</span>
<span class=normal>1506</span>
<span class=normal>1507</span>
<span class=normal>1508</span>
<span class=normal>1509</span>
<span class=normal>1510</span>
<span class=normal>1511</span>
<span class=normal>1512</span>
<span class=normal>1513</span>
<span class=normal>1514</span>
<span class=normal>1515</span>
<span class=normal>1516</span>
<span class=normal>1517</span>
<span class=normal>1518</span>
<span class=normal>1519</span>
<span class=normal>1520</span>
<span class=normal>1521</span>
<span class=normal>1522</span>
<span class=normal>1523</span>
<span class=normal>1524</span>
<span class=normal>1525</span>
<span class=normal>1526</span>
<span class=normal>1527</span>
<span class=normal>1528</span>
<span class=normal>1529</span>
<span class=normal>1530</span>
<span class=normal>1531</span>
<span class=normal>1532</span>
<span class=normal>1533</span>
<span class=normal>1534</span>
<span class=normal>1535</span>
<span class=normal>1536</span>
<span class=normal>1537</span>
<span class=normal>1538</span>
<span class=normal>1539</span>
<span class=normal>1540</span>
<span class=normal>1541</span>
<span class=normal>1542</span>
<span class=normal>1543</span>
<span class=normal>1544</span>
<span class=normal>1545</span>
<span class=normal>1546</span>
<span class=normal>1547</span>
<span class=normal>1548</span>
<span class=normal>1549</span>
<span class=normal>1550</span>
<span class=normal>1551</span>
<span class=normal>1552</span>
<span class=normal>1553</span>
<span class=normal>1554</span>
<span class=normal>1555</span>
<span class=normal>1556</span>
<span class=normal>1557</span>
<span class=normal>1558</span>
<span class=normal>1559</span>
<span class=normal>1560</span>
<span class=normal>1561</span>
<span class=normal>1562</span>
<span class=normal>1563</span>
<span class=normal>1564</span>
<span class=normal>1565</span>
<span class=normal>1566</span>
<span class=normal>1567</span>
<span class=normal>1568</span>
<span class=normal>1569</span>
<span class=normal>1570</span>
<span class=normal>1571</span>
<span class=normal>1572</span>
<span class=normal>1573</span>
<span class=normal>1574</span>
<span class=normal>1575</span>
<span class=normal>1576</span>
<span class=normal>1577</span>
<span class=normal>1578</span>
<span class=normal>1579</span>
<span class=normal>1580</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_id_required_nodes</span><span class=p>(</span><span class=n>referenced_nodes</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                          <span class=n>nodes</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
                          <span class=n>existing_ids</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return nodes that should receive a `cbId` attribute.</span>

<span class=sd>    This includes only mesh and curve nodes, parent transforms of the shape</span>
<span class=sd>    nodes, file texture nodes and object sets (including shading engines).</span>

<span class=sd>    This filters out any node which is locked, referenced, read-only,</span>
<span class=sd>    intermediate object.</span>

<span class=sd>    Args:</span>
<span class=sd>        referenced_nodes (bool): set True to include referenced nodes</span>
<span class=sd>        nodes (list, Optional): nodes to consider</span>
<span class=sd>        existing_ids (bool): set True to include nodes with `cbId` attribute</span>

<span class=sd>    Returns:</span>
<span class=sd>        nodes (set): list of filtered nodes</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>nodes</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=c1># User supplied an empty `nodes` list to check so all we can</span>
        <span class=c1># do is return the empty result</span>
        <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_node_type_exists</span><span class=p>(</span><span class=n>node_type</span><span class=p>):</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>nodeType</span><span class=p>(</span><span class=n>node_type</span><span class=p>,</span> <span class=n>isTypeName</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=kc>True</span>
        <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>False</span>

    <span class=k>def</span><span class=w> </span><span class=nf>iterate</span><span class=p>(</span><span class=n>maya_iterator</span><span class=p>):</span>
        <span class=k>while</span> <span class=ow>not</span> <span class=n>maya_iterator</span><span class=o>.</span><span class=n>isDone</span><span class=p>():</span>
            <span class=k>yield</span> <span class=n>maya_iterator</span><span class=o>.</span><span class=n>thisNode</span><span class=p>()</span>
            <span class=n>maya_iterator</span><span class=o>.</span><span class=n>next</span><span class=p>()</span>

    <span class=c1># `readOnly` flag is obsolete as of Maya 2016 therefore we explicitly</span>
    <span class=c1># remove default nodes and reference nodes</span>
    <span class=n>default_camera_shapes</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;frontShape&quot;</span><span class=p>,</span> <span class=s2>&quot;sideShape&quot;</span><span class=p>,</span> <span class=s2>&quot;topShape&quot;</span><span class=p>,</span> <span class=s2>&quot;perspShape&quot;</span>
    <span class=p>}</span>

    <span class=c1># The filtered types do not include transforms because we only want the</span>
    <span class=c1># parent transforms that have a child shape that we filtered to, so we</span>
    <span class=c1># include the parents here</span>
    <span class=n>types</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;mesh&quot;</span><span class=p>,</span> <span class=s2>&quot;nurbsCurve&quot;</span><span class=p>,</span> <span class=s2>&quot;nurbsSurface&quot;</span><span class=p>,</span> <span class=s2>&quot;file&quot;</span><span class=p>,</span> <span class=s2>&quot;objectSet&quot;</span><span class=p>]</span>

    <span class=c1># Check if plugin nodes are available for Maya by checking if the plugin</span>
    <span class=c1># is loaded</span>
    <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>pluginInfo</span><span class=p>(</span><span class=s2>&quot;pgYetiMaya&quot;</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>loaded</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
        <span class=n>types</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;pgYetiMaya&quot;</span><span class=p>)</span>

    <span class=n>iterator_type</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MIteratorType</span><span class=p>()</span>
    <span class=c1># This tries to be closest matching API equivalents of `types` variable</span>
    <span class=n>iterator_type</span><span class=o>.</span><span class=n>filterList</span> <span class=o>=</span> <span class=p>[</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kMesh</span><span class=p>,</span>  <span class=c1># mesh</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kNurbsSurface</span><span class=p>,</span>  <span class=c1># nurbsSurface</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kNurbsCurve</span><span class=p>,</span>  <span class=c1># nurbsCurve</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kFileTexture</span><span class=p>,</span>  <span class=c1># file</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kSet</span><span class=p>,</span>  <span class=c1># objectSet</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kPluginShape</span>  <span class=c1># pgYetiMaya</span>
    <span class=p>]</span>
    <span class=n>it</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MItDependencyNodes</span><span class=p>(</span><span class=n>iterator_type</span><span class=p>)</span>

    <span class=n>fn_dep</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDependencyNode</span><span class=p>()</span>
    <span class=n>fn_dag</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDagNode</span><span class=p>()</span>
    <span class=n>result</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_should_include_parents</span><span class=p>(</span><span class=n>obj</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Whether to include parents of obj in output&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>obj</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kShape</span><span class=p>):</span>
            <span class=k>return</span> <span class=kc>False</span>

        <span class=n>fn_dag</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>fn_dag</span><span class=o>.</span><span class=n>isIntermediateObject</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>False</span>

        <span class=c1># Skip default cameras</span>
        <span class=k>if</span> <span class=p>(</span>
            <span class=n>obj</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kCamera</span><span class=p>)</span> <span class=ow>and</span>
            <span class=n>fn_dag</span><span class=o>.</span><span class=n>name</span><span class=p>()</span> <span class=ow>in</span> <span class=n>default_camera_shapes</span>
        <span class=p>):</span>
            <span class=k>return</span> <span class=kc>False</span>

        <span class=k>return</span> <span class=kc>True</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_add_to_result_if_valid</span><span class=p>(</span><span class=n>obj</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Add to `result` if the object should be included&quot;&quot;&quot;</span>
        <span class=n>fn_dep</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>existing_ids</span> <span class=ow>and</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>hasAttribute</span><span class=p>(</span><span class=s2>&quot;cbId&quot;</span><span class=p>):</span>
            <span class=c1># If not including existing ids, skip nodes with `cbId` attribute</span>
            <span class=n>plug</span> <span class=o>=</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>findPlug</span><span class=p>(</span><span class=s2>&quot;cbId&quot;</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>value</span> <span class=o>=</span> <span class=n>plug</span><span class=o>.</span><span class=n>asString</span><span class=p>()</span>
                <span class=k>if</span> <span class=n>value</span><span class=p>:</span>
                    <span class=k>return</span>
            <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
                <span class=c1># Likely not a string attribute which we will consider as</span>
                <span class=c1># not having a `cbId` attribute - however we do log a warning</span>
                <span class=k>if</span> <span class=n>obj</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kDagNode</span><span class=p>):</span>
                    <span class=n>fn_dag</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
                    <span class=n>name</span> <span class=o>=</span> <span class=n>fn_dag</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>name</span> <span class=o>=</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>name</span><span class=p>()</span>

                <span class=n>type_name</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>.cbId&quot;</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>type_name</span> <span class=o>==</span> <span class=s2>&quot;string&quot;</span><span class=p>:</span>
                    <span class=c1># Type is correct so the issue must be something else,</span>
                    <span class=c1># so we re-raise the exception</span>
                    <span class=k>raise</span>
                <span class=c1># If the attribute is not a string, we log a warning</span>
                <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
                    <span class=sa>f</span><span class=s2>&quot;</span><span class=se>\&quot;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>.cbId</span><span class=se>\&quot;</span><span class=s2> is not a string attribute. &quot;</span>
                    <span class=sa>f</span><span class=s2>&quot;Attribute type: &#39;</span><span class=si>{</span><span class=n>type_name</span><span class=si>}</span><span class=s2>&#39;.&quot;</span>
                <span class=p>)</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>referenced_nodes</span> <span class=ow>and</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>isFromReferencedFile</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=k>if</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>isDefaultNode</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=k>if</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>isLocked</span><span class=p>:</span>
            <span class=k>return</span>

        <span class=c1># Skip default cameras</span>
        <span class=k>if</span> <span class=p>(</span>
            <span class=n>obj</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kCamera</span><span class=p>)</span> <span class=ow>and</span>
            <span class=n>fn_dep</span><span class=o>.</span><span class=n>name</span><span class=p>()</span> <span class=ow>in</span> <span class=n>default_camera_shapes</span>
        <span class=p>):</span>
            <span class=k>return</span>

        <span class=k>if</span> <span class=n>obj</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kDagNode</span><span class=p>):</span>
            <span class=c1># DAG nodes</span>
            <span class=n>fn_dag</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>

            <span class=c1># Skip intermediate objects</span>
            <span class=k>if</span> <span class=n>fn_dag</span><span class=o>.</span><span class=n>isIntermediateObject</span><span class=p>:</span>
                <span class=k>return</span>

            <span class=c1># DAG nodes can be instanced and thus may have multiple paths.</span>
            <span class=c1># We need to identify each path</span>
            <span class=n>paths</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MDagPath</span><span class=o>.</span><span class=n>getAllPathsTo</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
            <span class=k>for</span> <span class=n>dag</span> <span class=ow>in</span> <span class=n>paths</span><span class=p>:</span>
                <span class=n>path</span> <span class=o>=</span> <span class=n>dag</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span>
                <span class=n>result</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=c1># Dependency node</span>
            <span class=n>path</span> <span class=o>=</span> <span class=n>fn_dep</span><span class=o>.</span><span class=n>name</span><span class=p>()</span>
            <span class=n>result</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>

    <span class=k>for</span> <span class=n>obj</span> <span class=ow>in</span> <span class=n>iterate</span><span class=p>(</span><span class=n>it</span><span class=p>):</span>
        <span class=c1># For any non-intermediate shape node always include the parent</span>
        <span class=c1># even if we exclude the shape itself (e.g. when locked, default)</span>
        <span class=k>if</span> <span class=n>_should_include_parents</span><span class=p>(</span><span class=n>obj</span><span class=p>):</span>
            <span class=n>fn_dag</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>
            <span class=n>parents</span> <span class=o>=</span> <span class=p>[</span>
                <span class=n>fn_dag</span><span class=o>.</span><span class=n>parent</span><span class=p>(</span><span class=n>index</span><span class=p>)</span> <span class=k>for</span> <span class=n>index</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>fn_dag</span><span class=o>.</span><span class=n>parentCount</span><span class=p>())</span>
            <span class=p>]</span>
            <span class=k>for</span> <span class=n>parent_obj</span> <span class=ow>in</span> <span class=n>parents</span><span class=p>:</span>
                <span class=n>_add_to_result_if_valid</span><span class=p>(</span><span class=n>parent_obj</span><span class=p>)</span>

        <span class=n>_add_to_result_if_valid</span><span class=p>(</span><span class=n>obj</span><span class=p>)</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>result</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>result</span>

    <span class=c1># Exclude some additional types</span>
    <span class=n>exclude_types</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>if</span> <span class=n>_node_type_exists</span><span class=p>(</span><span class=s2>&quot;ilrBakeLayer&quot;</span><span class=p>):</span>
        <span class=c1># Remove Turtle from the result if Turtle is loaded</span>
        <span class=n>exclude_types</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s2>&quot;ilrBakeLayer&quot;</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>exclude_types</span><span class=p>:</span>
        <span class=n>exclude_nodes</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>exclude_types</span><span class=p>))</span>
        <span class=k>if</span> <span class=n>exclude_nodes</span><span class=p>:</span>
            <span class=n>result</span> <span class=o>-=</span> <span class=n>exclude_nodes</span>

    <span class=c1># Filter to explicit input nodes if provided</span>
    <span class=k>if</span> <span class=n>nodes</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=c1># The amount of input nodes to filter to can be large and querying</span>
        <span class=c1># many nodes can be slow in Maya. As such we want to try and reduce</span>
        <span class=c1># it as much as possible, so we include the type filter to try and</span>
        <span class=c1># reduce the result of `maya.cmds.ls` here.</span>
        <span class=n>nodes</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>types</span> <span class=o>+</span> <span class=p>[</span><span class=s2>&quot;dagNode&quot;</span><span class=p>]))</span>
        <span class=k>if</span> <span class=n>nodes</span><span class=p>:</span>
            <span class=n>result</span> <span class=o>&amp;=</span> <span class=n>nodes</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>return</span> <span class=nb>set</span><span class=p>()</span>

    <span class=k>return</span> <span class=n>result</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_isolate_view_sets class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_isolate_view_sets</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Return isolate view sets of all modelPanels.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>all sets related to isolate view</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2159</span>
<span class=normal>2160</span>
<span class=normal>2161</span>
<span class=normal>2162</span>
<span class=normal>2163</span>
<span class=normal>2164</span>
<span class=normal>2165</span>
<span class=normal>2166</span>
<span class=normal>2167</span>
<span class=normal>2168</span>
<span class=normal>2169</span>
<span class=normal>2170</span>
<span class=normal>2171</span>
<span class=normal>2172</span>
<span class=normal>2173</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_isolate_view_sets</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return isolate view sets of all modelPanels.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: all sets related to isolate view</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>view_sets</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>panel</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getPanel</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=s2>&quot;modelPanel&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]:</span>
        <span class=n>view_set</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>modelEditor</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>viewObjects</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>view_set</span><span class=p>:</span>
            <span class=n>view_sets</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>view_set</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>view_sets</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_main_window class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_main_window</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Acquire Maya's main window</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_main_window</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Acquire Maya&#39;s main window&quot;&quot;&quot;</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>qtpy</span><span class=w> </span><span class=kn>import</span> <span class=n>QtWidgets</span>

    <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_parent</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>_parent</span> <span class=o>=</span> <span class=p>{</span>
            <span class=n>widget</span><span class=o>.</span><span class=n>objectName</span><span class=p>():</span> <span class=n>widget</span>
            <span class=k>for</span> <span class=n>widget</span> <span class=ow>in</span> <span class=n>QtWidgets</span><span class=o>.</span><span class=n>QApplication</span><span class=o>.</span><span class=n>topLevelWidgets</span><span class=p>()</span>
        <span class=p>}[</span><span class=s2>&quot;MayaWindow&quot;</span><span class=p>]</span>
    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_parent</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_namespace class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_namespace</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return namespace of given node</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>393</span>
<span class=normal>394</span>
<span class=normal>395</span>
<span class=normal>396</span>
<span class=normal>397</span>
<span class=normal>398</span>
<span class=normal>399</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_namespace</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return namespace of given node&quot;&quot;&quot;</span>
    <span class=n>node_name</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=k>if</span> <span class=s2>&quot;:&quot;</span> <span class=ow>in</span> <span class=n>node_name</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>node_name</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>return</span> <span class=s2>&quot;&quot;</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_node_index_under_parent class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_node_index_under_parent</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return the index of a DAG node under its parent.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>A DAG Node path.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>int</code></td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The DAG node's index under its parents or world</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4481</span>
<span class=normal>4482</span>
<span class=normal>4483</span>
<span class=normal>4484</span>
<span class=normal>4485</span>
<span class=normal>4486</span>
<span class=normal>4487</span>
<span class=normal>4488</span>
<span class=normal>4489</span>
<span class=normal>4490</span>
<span class=normal>4491</span>
<span class=normal>4492</span>
<span class=normal>4493</span>
<span class=normal>4494</span>
<span class=normal>4495</span>
<span class=normal>4496</span>
<span class=normal>4497</span>
<span class=normal>4498</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_node_index_under_parent</span><span class=p>(</span><span class=n>node</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the index of a DAG node under its parent.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        node (str): A DAG Node path.</span>

<span class=sd>    Returns:</span>
<span class=sd>        int: The DAG node&#39;s index under its parents or world</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>node</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># enforce long names</span>
    <span class=n>parent</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>parent</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>assemblies</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>parent</span><span class=p>,</span>
                                  <span class=n>children</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                  <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_node_name class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_node_name</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return maya node name without namespace or parents</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>get_node_name</span><span class=p>(</span><span class=s2>&quot;|grp|node&quot;</span><span class=p>)</span>
<span class=go>&quot;node&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>get_node_name</span><span class=p>(</span><span class=s2>&quot;|foobar:grp|foobar:child&quot;</span><span class=p>)</span>
<span class=go>&quot;child&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>get_node_name</span><span class=p>(</span><span class=s2>&quot;|foobar:grp|lala:bar|foobar:test:hello_world&quot;</span><span class=p>)</span>
<span class=go>&quot;hello_world&quot;</span>
</code></pre></div> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>531</span>
<span class=normal>532</span>
<span class=normal>533</span>
<span class=normal>534</span>
<span class=normal>535</span>
<span class=normal>536</span>
<span class=normal>537</span>
<span class=normal>538</span>
<span class=normal>539</span>
<span class=normal>540</span>
<span class=normal>541</span>
<span class=normal>542</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_node_name</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return maya node name without namespace or parents</span>

<span class=sd>    Examples:</span>
<span class=sd>        &gt;&gt;&gt; get_node_name(&quot;|grp|node&quot;)</span>
<span class=sd>        &quot;node&quot;</span>
<span class=sd>        &gt;&gt;&gt; get_node_name(&quot;|foobar:grp|foobar:child&quot;)</span>
<span class=sd>        &quot;child&quot;</span>
<span class=sd>        &gt;&gt;&gt; get_node_name(&quot;|foobar:grp|lala:bar|foobar:test:hello_world&quot;)</span>
<span class=sd>        &quot;hello_world&quot;</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=n>path</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_node_parent class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_node_parent</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return full path name for parent of node</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The node path of the node to get the parent for.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>str | None: The full path name of the parent node or None.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2381</span>
<span class=normal>2382</span>
<span class=normal>2383</span>
<span class=normal>2384</span>
<span class=normal>2385</span>
<span class=normal>2386</span>
<span class=normal>2387</span>
<span class=normal>2388</span>
<span class=normal>2389</span>
<span class=normal>2390</span>
<span class=normal>2391</span>
<span class=normal>2392</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_node_parent</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return full path name for parent of node</span>

<span class=sd>    Arguments:</span>
<span class=sd>        node (str): The node path of the node to get the parent for.</span>

<span class=sd>    Returns:</span>
<span class=sd>        str | None: The full path name of the parent node or None.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>parents</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>parent</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>parents</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>parents</span> <span class=k>else</span> <span class=kc>None</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_reference_node class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_reference_node</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the reference node from the container members Args: members: list of node names</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>Reference node name.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4235</span>
<span class=normal>4236</span>
<span class=normal>4237</span>
<span class=normal>4238</span>
<span class=normal>4239</span>
<span class=normal>4240</span>
<span class=normal>4241</span>
<span class=normal>4242</span>
<span class=normal>4243</span>
<span class=normal>4244</span>
<span class=normal>4245</span>
<span class=normal>4246</span>
<span class=normal>4247</span>
<span class=normal>4248</span>
<span class=normal>4249</span>
<span class=normal>4250</span>
<span class=normal>4251</span>
<span class=normal>4252</span>
<span class=normal>4253</span>
<span class=normal>4254</span>
<span class=normal>4255</span>
<span class=normal>4256</span>
<span class=normal>4257</span>
<span class=normal>4258</span>
<span class=normal>4259</span>
<span class=normal>4260</span>
<span class=normal>4261</span>
<span class=normal>4262</span>
<span class=normal>4263</span>
<span class=normal>4264</span>
<span class=normal>4265</span>
<span class=normal>4266</span>
<span class=normal>4267</span>
<span class=normal>4268</span>
<span class=normal>4269</span>
<span class=normal>4270</span>
<span class=normal>4271</span>
<span class=normal>4272</span>
<span class=normal>4273</span>
<span class=normal>4274</span>
<span class=normal>4275</span>
<span class=normal>4276</span>
<span class=normal>4277</span>
<span class=normal>4278</span>
<span class=normal>4279</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_reference_node</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>log</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the reference node from the container members</span>
<span class=sd>    Args:</span>
<span class=sd>        members: list of node names</span>

<span class=sd>    Returns:</span>
<span class=sd>        str: Reference node name.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Collect the references without .placeHolderList[] attributes as</span>
    <span class=c1># unique entries (objects only) and skipping the sharedReferenceNode.</span>
    <span class=n>references</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>ref</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>exactType</span><span class=o>=</span><span class=s2>&quot;reference&quot;</span><span class=p>,</span> <span class=n>objectsOnly</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>

        <span class=c1># Ignore any `:sharedReferenceNode`</span>
        <span class=k>if</span> <span class=n>ref</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;sharedReferenceNode&quot;</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=c1># Ignore _UNKNOWN_REF_NODE_ (PLN-160)</span>
        <span class=k>if</span> <span class=n>ref</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;_UNKNOWN_REF_NODE_&quot;</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>is_valid_reference_node</span><span class=p>(</span><span class=n>ref</span><span class=p>):</span>
            <span class=k>continue</span>

        <span class=n>references</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>ref</span><span class=p>)</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>references</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=c1># Get highest reference node (least parents)</span>
    <span class=n>highest</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>references</span><span class=p>,</span>
                  <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>get_reference_node_parents</span><span class=p>(</span><span class=n>x</span><span class=p>)))</span>

    <span class=c1># Warn the user when we&#39;re taking the highest reference node</span>
    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>references</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>log</span><span class=p>:</span>
            <span class=n>log</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>

        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;More than one reference node found in &quot;</span>
                    <span class=s2>&quot;container, using highest reference node: &quot;</span>
                    <span class=s2>&quot;</span><span class=si>%s</span><span class=s2> (in: </span><span class=si>%s</span><span class=s2>)&quot;</span><span class=p>,</span> <span class=n>highest</span><span class=p>,</span> <span class=nb>list</span><span class=p>(</span><span class=n>references</span><span class=p>))</span>

    <span class=k>return</span> <span class=n>highest</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_reference_node_parents class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_reference_node_parents</span><span class=p>(</span><span class=n>ref</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return all parent reference nodes of reference node</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>ref</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>reference node.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>The upstream parent reference nodes.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4282</span>
<span class=normal>4283</span>
<span class=normal>4284</span>
<span class=normal>4285</span>
<span class=normal>4286</span>
<span class=normal>4287</span>
<span class=normal>4288</span>
<span class=normal>4289</span>
<span class=normal>4290</span>
<span class=normal>4291</span>
<span class=normal>4292</span>
<span class=normal>4293</span>
<span class=normal>4294</span>
<span class=normal>4295</span>
<span class=normal>4296</span>
<span class=normal>4297</span>
<span class=normal>4298</span>
<span class=normal>4299</span>
<span class=normal>4300</span>
<span class=normal>4301</span>
<span class=normal>4302</span>
<span class=normal>4303</span>
<span class=normal>4304</span>
<span class=normal>4305</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_reference_node_parents</span><span class=p>(</span><span class=n>ref</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return all parent reference nodes of reference node</span>

<span class=sd>    Args:</span>
<span class=sd>        ref (str): reference node.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: The upstream parent reference nodes.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_get_parent</span><span class=p>(</span><span class=n>reference_node</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return parent reference node, but ignore invalid reference nodes&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>is_valid_reference_node</span><span class=p>(</span><span class=n>reference_node</span><span class=p>):</span>
            <span class=k>return</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>referenceQuery</span><span class=p>(</span><span class=n>reference_node</span><span class=p>,</span>
                                   <span class=n>referenceNode</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                   <span class=n>parent</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=n>parent</span> <span class=o>=</span> <span class=n>_get_parent</span><span class=p>(</span><span class=n>ref</span><span class=p>)</span>
    <span class=n>parents</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>while</span> <span class=n>parent</span><span class=p>:</span>
        <span class=n>parents</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
        <span class=n>parent</span> <span class=o>=</span> <span class=n>_get_parent</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>parents</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_related_sets class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_related_sets</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return objectSets that are relationships for a look for <code>node</code>.</p> <p>Filters out based on: - id attribute is NOT <code>AVALON_CONTAINER_ID</code> - shapes and deformer shapes (alembic creates meshShapeDeformed) - set name ends with any from a predefined list - set in not in viewport set (isolate selected for example)</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name of the current node to check</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>The related sets</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2176</span>
<span class=normal>2177</span>
<span class=normal>2178</span>
<span class=normal>2179</span>
<span class=normal>2180</span>
<span class=normal>2181</span>
<span class=normal>2182</span>
<span class=normal>2183</span>
<span class=normal>2184</span>
<span class=normal>2185</span>
<span class=normal>2186</span>
<span class=normal>2187</span>
<span class=normal>2188</span>
<span class=normal>2189</span>
<span class=normal>2190</span>
<span class=normal>2191</span>
<span class=normal>2192</span>
<span class=normal>2193</span>
<span class=normal>2194</span>
<span class=normal>2195</span>
<span class=normal>2196</span>
<span class=normal>2197</span>
<span class=normal>2198</span>
<span class=normal>2199</span>
<span class=normal>2200</span>
<span class=normal>2201</span>
<span class=normal>2202</span>
<span class=normal>2203</span>
<span class=normal>2204</span>
<span class=normal>2205</span>
<span class=normal>2206</span>
<span class=normal>2207</span>
<span class=normal>2208</span>
<span class=normal>2209</span>
<span class=normal>2210</span>
<span class=normal>2211</span>
<span class=normal>2212</span>
<span class=normal>2213</span>
<span class=normal>2214</span>
<span class=normal>2215</span>
<span class=normal>2216</span>
<span class=normal>2217</span>
<span class=normal>2218</span>
<span class=normal>2219</span>
<span class=normal>2220</span>
<span class=normal>2221</span>
<span class=normal>2222</span>
<span class=normal>2223</span>
<span class=normal>2224</span>
<span class=normal>2225</span>
<span class=normal>2226</span>
<span class=normal>2227</span>
<span class=normal>2228</span>
<span class=normal>2229</span>
<span class=normal>2230</span>
<span class=normal>2231</span>
<span class=normal>2232</span>
<span class=normal>2233</span>
<span class=normal>2234</span>
<span class=normal>2235</span>
<span class=normal>2236</span>
<span class=normal>2237</span>
<span class=normal>2238</span>
<span class=normal>2239</span>
<span class=normal>2240</span>
<span class=normal>2241</span>
<span class=normal>2242</span>
<span class=normal>2243</span>
<span class=normal>2244</span>
<span class=normal>2245</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_related_sets</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return objectSets that are relationships for a look for `node`.</span>

<span class=sd>    Filters out based on:</span>
<span class=sd>    - id attribute is NOT `AVALON_CONTAINER_ID`</span>
<span class=sd>    - shapes and deformer shapes (alembic creates meshShapeDeformed)</span>
<span class=sd>    - set name ends with any from a predefined list</span>
<span class=sd>    - set in not in viewport set (isolate selected for example)</span>

<span class=sd>    Args:</span>
<span class=sd>        node (str): name of the current node to check</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: The related sets</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>sets</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listSets</span><span class=p>(</span><span class=nb>object</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>extendToShape</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>sets</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>[]</span>

    <span class=c1># Fix &#39;no object matches name&#39; errors on nodes returned by listSets.</span>
    <span class=c1># In rare cases it can happen that a node is added to an internal maya</span>
    <span class=c1># set inaccessible by maya commands, for example check some nodes</span>
    <span class=c1># returned by `cmds.listSets(allSets=True)`</span>
    <span class=n>sets</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>sets</span><span class=p>)</span>

    <span class=c1># Ids to ignore</span>
    <span class=n>ignored</span> <span class=o>=</span> <span class=p>{</span>
        <span class=n>AVALON_INSTANCE_ID</span><span class=p>,</span>
        <span class=n>AVALON_CONTAINER_ID</span><span class=p>,</span>
        <span class=n>AYON_INSTANCE_ID</span><span class=p>,</span>
        <span class=n>AYON_CONTAINER_ID</span><span class=p>,</span>
    <span class=p>}</span>

    <span class=c1># Ignore `avalon.container`</span>
    <span class=n>sets</span> <span class=o>=</span> <span class=p>[</span>
        <span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>sets</span>
        <span class=k>if</span> <span class=p>(</span>
           <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=s2>&quot;id&quot;</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>s</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
           <span class=ow>or</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>s</span><span class=si>}</span><span class=s2>.id&quot;</span><span class=p>)</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>ignored</span>
        <span class=p>)</span>
    <span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>sets</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>sets</span>

    <span class=c1># Exclude deformer sets (`type=2` for `maya.cmds.listSets`)</span>
    <span class=n>exclude_sets</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listSets</span><span class=p>(</span><span class=nb>object</span><span class=o>=</span><span class=n>node</span><span class=p>,</span>
                                 <span class=n>extendToShape</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                 <span class=nb>type</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
    <span class=n>exclude_sets</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>exclude_sets</span><span class=p>)</span>  <span class=c1># optimize lookup</span>

    <span class=c1># Default nodes to ignore</span>
    <span class=n>exclude_sets</span><span class=o>.</span><span class=n>update</span><span class=p>({</span><span class=s2>&quot;defaultLightSet&quot;</span><span class=p>,</span> <span class=s2>&quot;defaultObjectSet&quot;</span><span class=p>})</span>

    <span class=c1># Filter out the sets to exclude</span>
    <span class=n>sets</span> <span class=o>=</span> <span class=p>[</span><span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>sets</span> <span class=k>if</span> <span class=n>s</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>exclude_sets</span><span class=p>]</span>

    <span class=c1># Ignore when the set has a specific suffix</span>
    <span class=n>ignore_suffices</span> <span class=o>=</span> <span class=p>(</span><span class=s2>&quot;out_SET&quot;</span><span class=p>,</span> <span class=s2>&quot;controls_SET&quot;</span><span class=p>,</span> <span class=s2>&quot;_INST&quot;</span><span class=p>,</span> <span class=s2>&quot;_CON&quot;</span><span class=p>)</span>
    <span class=n>sets</span> <span class=o>=</span> <span class=p>[</span><span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>sets</span> <span class=k>if</span> <span class=ow>not</span> <span class=n>s</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=n>ignore_suffices</span><span class=p>)]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>sets</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>sets</span>

    <span class=c1># Ignore viewport filter view sets (from isolate select and</span>
    <span class=c1># viewports)</span>
    <span class=n>view_sets</span> <span class=o>=</span> <span class=n>get_isolate_view_sets</span><span class=p>()</span>
    <span class=n>sets</span> <span class=o>=</span> <span class=p>[</span><span class=n>s</span> <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>sets</span> <span class=k>if</span> <span class=n>s</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>view_sets</span><span class=p>]</span>

    <span class=k>return</span> <span class=n>sets</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_representation_path_by_project class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_representation_path_by_project</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get the representation path for a given representation entity. This function would be used temporarily until the version from the core addon is available. Args: project_name (str): The project name. repre_entity (dict): The representation entity. project_name (str, optional): The project name. Defaults to None. Returns: str: The representation path.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1912</span>
<span class=normal>1913</span>
<span class=normal>1914</span>
<span class=normal>1915</span>
<span class=normal>1916</span>
<span class=normal>1917</span>
<span class=normal>1918</span>
<span class=normal>1919</span>
<span class=normal>1920</span>
<span class=normal>1921</span>
<span class=normal>1922</span>
<span class=normal>1923</span>
<span class=normal>1924</span>
<span class=normal>1925</span>
<span class=normal>1926</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_representation_path_by_project</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>repre_entity</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the representation path for a given representation entity.</span>
<span class=sd>    This function would be used temporarily until the version from</span>
<span class=sd>    the core addon is available.</span>
<span class=sd>    Args:</span>
<span class=sd>        project_name (str): The project name.</span>
<span class=sd>        repre_entity (dict): The representation entity.</span>
<span class=sd>        project_name (str, optional): The project name. Defaults to None.</span>
<span class=sd>    Returns:</span>
<span class=sd>        str: The representation path.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>project_name</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
    <span class=n>anatomy</span> <span class=o>=</span> <span class=n>Anatomy</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>get_representation_path_with_anatomy</span><span class=p>(</span><span class=n>repre_entity</span><span class=p>,</span> <span class=n>anatomy</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_scene_units_settings class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_scene_units_settings</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Function to return preferred linear unit and angular scale from settings</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_settings</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Project Name. Defaults to None.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=tuple>tuple</span>[<span title=str>str</span>, <span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>tuple[str, str]: linear scene unit, angular scene unit</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4754</span>
<span class=normal>4755</span>
<span class=normal>4756</span>
<span class=normal>4757</span>
<span class=normal>4758</span>
<span class=normal>4759</span>
<span class=normal>4760</span>
<span class=normal>4761</span>
<span class=normal>4762</span>
<span class=normal>4763</span>
<span class=normal>4764</span>
<span class=normal>4765</span>
<span class=normal>4766</span>
<span class=normal>4767</span>
<span class=normal>4768</span>
<span class=normal>4769</span>
<span class=normal>4770</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_scene_units_settings</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span><span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>str</span><span class=p>]:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Function to return preferred linear unit and angular scale from settings</span>

<span class=sd>    Args:</span>
<span class=sd>        project_settings (dict, optional): Project Name. Defaults to None.</span>

<span class=sd>    Returns:</span>
<span class=sd>        tuple[str, str]: linear scene unit, angular scene unit</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>project_settings</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
        <span class=n>project_settings</span> <span class=o>=</span> <span class=n>get_project_settings</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>

    <span class=n>scene_units</span> <span class=o>=</span> <span class=n>project_settings</span><span class=p>[</span><span class=s2>&quot;maya&quot;</span><span class=p>][</span><span class=s2>&quot;scene_units&quot;</span><span class=p>]</span>
    <span class=n>linear_unit</span> <span class=o>=</span> <span class=n>scene_units</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;linear_units&quot;</span><span class=p>,</span> <span class=s2>&quot;cm&quot;</span><span class=p>)</span>
    <span class=n>angular_unit</span> <span class=o>=</span> <span class=n>scene_units</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;angular_units&quot;</span><span class=p>,</span> <span class=s2>&quot;deg&quot;</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>linear_unit</span><span class=p>,</span> <span class=n>angular_unit</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_sequence class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_sequence</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=n>pattern</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%04d</span><span class=s1>&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Get sequence from filename.</p> <p>This will only return files if they exist on disk as it tries to collect the sequence using the filename pattern and searching for them on disk.</p> <p>Supports negative frame ranges like -001, 0000, 0001 and -0001, 0000, 0001.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>filepath</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The full path to filename containing the given</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>pattern</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The pattern to swap with the variable frame number.</p> </div> </td> <td> <code>&#39;%04d&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>Optional[list[str]]: file sequence.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4539</span>
<span class=normal>4540</span>
<span class=normal>4541</span>
<span class=normal>4542</span>
<span class=normal>4543</span>
<span class=normal>4544</span>
<span class=normal>4545</span>
<span class=normal>4546</span>
<span class=normal>4547</span>
<span class=normal>4548</span>
<span class=normal>4549</span>
<span class=normal>4550</span>
<span class=normal>4551</span>
<span class=normal>4552</span>
<span class=normal>4553</span>
<span class=normal>4554</span>
<span class=normal>4555</span>
<span class=normal>4556</span>
<span class=normal>4557</span>
<span class=normal>4558</span>
<span class=normal>4559</span>
<span class=normal>4560</span>
<span class=normal>4561</span>
<span class=normal>4562</span>
<span class=normal>4563</span>
<span class=normal>4564</span>
<span class=normal>4565</span>
<span class=normal>4566</span>
<span class=normal>4567</span>
<span class=normal>4568</span>
<span class=normal>4569</span>
<span class=normal>4570</span>
<span class=normal>4571</span>
<span class=normal>4572</span>
<span class=normal>4573</span>
<span class=normal>4574</span>
<span class=normal>4575</span>
<span class=normal>4576</span>
<span class=normal>4577</span>
<span class=normal>4578</span>
<span class=normal>4579</span>
<span class=normal>4580</span>
<span class=normal>4581</span>
<span class=normal>4582</span>
<span class=normal>4583</span>
<span class=normal>4584</span>
<span class=normal>4585</span>
<span class=normal>4586</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_sequence</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=n>pattern</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>%04d</span><span class=s2>&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get sequence from filename.</span>

<span class=sd>    This will only return files if they exist on disk as it tries</span>
<span class=sd>    to collect the sequence using the filename pattern and searching</span>
<span class=sd>    for them on disk.</span>

<span class=sd>    Supports negative frame ranges like -001, 0000, 0001 and -0001,</span>
<span class=sd>    0000, 0001.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        filepath (str): The full path to filename containing the given</span>
<span class=sd>        pattern.</span>
<span class=sd>        pattern (str): The pattern to swap with the variable frame number.</span>

<span class=sd>    Returns:</span>
<span class=sd>        Optional[list[str]]: file sequence.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
    <span class=n>re_pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>escape</span><span class=p>(</span><span class=n>filename</span><span class=p>)</span>
    <span class=n>re_pattern</span> <span class=o>=</span> <span class=n>re_pattern</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>escape</span><span class=p>(</span><span class=n>pattern</span><span class=p>),</span> <span class=s2>&quot;-?[0-9]+&quot;</span><span class=p>)</span>
    <span class=n>source_dir</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
    <span class=n>files</span> <span class=o>=</span> <span class=p>[</span><span class=n>f</span> <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>source_dir</span><span class=p>)</span> <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>re_pattern</span><span class=p>,</span> <span class=n>f</span><span class=p>)]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>files</span><span class=p>:</span>
        <span class=c1># Files do not exist, this may not be a problem if e.g. the</span>
        <span class=c1># textures were relative paths and we&#39;re searching across</span>
        <span class=c1># multiple image search paths.</span>
        <span class=k>return</span>

    <span class=c1># clique.PATTERNS[&quot;frames&quot;] supports only `.1001.exr` not `_1001.exr` so</span>
    <span class=c1># we use a customized pattern.</span>
    <span class=n>pattern</span> <span class=o>=</span> <span class=s2>&quot;[_.](?P&lt;index&gt;(?P&lt;padding&gt;0*)</span><span class=se>\\</span><span class=s2>d+)</span><span class=se>\\</span><span class=s2>.</span><span class=se>\\</span><span class=s2>D+</span><span class=se>\\</span><span class=s2>d?$&quot;</span>
    <span class=n>patterns</span> <span class=o>=</span> <span class=p>[</span><span class=n>pattern</span><span class=p>]</span>
    <span class=n>collections</span><span class=p>,</span> <span class=n>_remainder</span> <span class=o>=</span> <span class=n>clique</span><span class=o>.</span><span class=n>assemble</span><span class=p>(</span>
        <span class=n>files</span><span class=p>,</span>
        <span class=n>patterns</span><span class=o>=</span><span class=n>patterns</span><span class=p>,</span>
        <span class=n>minimum_items</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>

    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>collections</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;Multiple collections found for </span><span class=si>{</span><span class=n>collections</span><span class=si>}</span><span class=s2>. &quot;</span>
            <span class=s2>&quot;This is a bug.&quot;</span><span class=p>)</span>

    <span class=k>return</span> <span class=p>[</span>
        <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>source_dir</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>collections</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
    <span class=p>]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.get_shader_assignments_from_shapes class="doc doc-heading"> <code class="highlight language-python"><span class=n>get_shader_assignments_from_shapes</span><span class=p>(</span><span class=n>shapes</span><span class=p>,</span> <span class=n>components</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return the shape assignment per related shading engines.</p> <p>Returns a dictionary where the keys are shadingGroups and the values are lists of assigned shapes or shape-components.</p> <p>Since <code>maya.cmds.sets</code> returns shader members on the shapes as components on the transform we correct that in this method too.</p> <p>For the 'shapes' this will return a dictionary like: { "shadingEngineX": ["nodeX", "nodeY"], "shadingEngineY": ["nodeA", "nodeB"] }</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>shapes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>The shapes to collect the assignments for.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>components</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to include the component assignments.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p>The {shadingEngine: shapes} relationships</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1019</span>
<span class=normal>1020</span>
<span class=normal>1021</span>
<span class=normal>1022</span>
<span class=normal>1023</span>
<span class=normal>1024</span>
<span class=normal>1025</span>
<span class=normal>1026</span>
<span class=normal>1027</span>
<span class=normal>1028</span>
<span class=normal>1029</span>
<span class=normal>1030</span>
<span class=normal>1031</span>
<span class=normal>1032</span>
<span class=normal>1033</span>
<span class=normal>1034</span>
<span class=normal>1035</span>
<span class=normal>1036</span>
<span class=normal>1037</span>
<span class=normal>1038</span>
<span class=normal>1039</span>
<span class=normal>1040</span>
<span class=normal>1041</span>
<span class=normal>1042</span>
<span class=normal>1043</span>
<span class=normal>1044</span>
<span class=normal>1045</span>
<span class=normal>1046</span>
<span class=normal>1047</span>
<span class=normal>1048</span>
<span class=normal>1049</span>
<span class=normal>1050</span>
<span class=normal>1051</span>
<span class=normal>1052</span>
<span class=normal>1053</span>
<span class=normal>1054</span>
<span class=normal>1055</span>
<span class=normal>1056</span>
<span class=normal>1057</span>
<span class=normal>1058</span>
<span class=normal>1059</span>
<span class=normal>1060</span>
<span class=normal>1061</span>
<span class=normal>1062</span>
<span class=normal>1063</span>
<span class=normal>1064</span>
<span class=normal>1065</span>
<span class=normal>1066</span>
<span class=normal>1067</span>
<span class=normal>1068</span>
<span class=normal>1069</span>
<span class=normal>1070</span>
<span class=normal>1071</span>
<span class=normal>1072</span>
<span class=normal>1073</span>
<span class=normal>1074</span>
<span class=normal>1075</span>
<span class=normal>1076</span>
<span class=normal>1077</span>
<span class=normal>1078</span>
<span class=normal>1079</span>
<span class=normal>1080</span>
<span class=normal>1081</span>
<span class=normal>1082</span>
<span class=normal>1083</span>
<span class=normal>1084</span>
<span class=normal>1085</span>
<span class=normal>1086</span>
<span class=normal>1087</span>
<span class=normal>1088</span>
<span class=normal>1089</span>
<span class=normal>1090</span>
<span class=normal>1091</span>
<span class=normal>1092</span>
<span class=normal>1093</span>
<span class=normal>1094</span>
<span class=normal>1095</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>get_shader_assignments_from_shapes</span><span class=p>(</span><span class=n>shapes</span><span class=p>,</span> <span class=n>components</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the shape assignment per related shading engines.</span>

<span class=sd>    Returns a dictionary where the keys are shadingGroups and the values are</span>
<span class=sd>    lists of assigned shapes or shape-components.</span>

<span class=sd>    Since `maya.cmds.sets` returns shader members on the shapes as components</span>
<span class=sd>    on the transform we correct that in this method too.</span>

<span class=sd>    For the &#39;shapes&#39; this will return a dictionary like:</span>
<span class=sd>        {</span>
<span class=sd>            &quot;shadingEngineX&quot;: [&quot;nodeX&quot;, &quot;nodeY&quot;],</span>
<span class=sd>            &quot;shadingEngineY&quot;: [&quot;nodeA&quot;, &quot;nodeB&quot;]</span>
<span class=sd>        }</span>

<span class=sd>    Args:</span>
<span class=sd>        shapes (list): The shapes to collect the assignments for.</span>
<span class=sd>        components (bool): Whether to include the component assignments.</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: The {shadingEngine: shapes} relationships</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>shapes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>shapes</span><span class=p>,</span>
                     <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                     <span class=n>shapes</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                     <span class=n>objectsOnly</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>shapes</span><span class=p>:</span>
        <span class=k>return</span> <span class=p>{}</span>

    <span class=c1># Collect shading engines and their shapes</span>
    <span class=n>assignments</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>shape</span> <span class=ow>in</span> <span class=n>shapes</span><span class=p>:</span>

        <span class=c1># Get unique shading groups for the shape</span>
        <span class=n>shading_groups</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span><span class=n>shape</span><span class=p>,</span>
                                              <span class=n>source</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                              <span class=n>destination</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                              <span class=n>plugs</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                              <span class=n>connections</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                                              <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;shadingEngine&quot;</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[]</span>
        <span class=n>shading_groups</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>shading_groups</span><span class=p>))</span>
        <span class=k>for</span> <span class=n>shading_group</span> <span class=ow>in</span> <span class=n>shading_groups</span><span class=p>:</span>
            <span class=n>assignments</span><span class=p>[</span><span class=n>shading_group</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>shape</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>components</span><span class=p>:</span>
        <span class=c1># Note: Components returned from maya.cmds.sets are &quot;listed&quot; as if</span>
        <span class=c1># being assigned to the transform like: pCube1.f[0] as opposed</span>
        <span class=c1># to pCubeShape1.f[0] so we correct that here too.</span>

        <span class=c1># Build a mapping from parent to shapes to include in lookup.</span>
        <span class=n>transforms</span> <span class=o>=</span> <span class=p>{</span><span class=n>shape</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]:</span> <span class=n>shape</span> <span class=k>for</span> <span class=n>shape</span> <span class=ow>in</span> <span class=n>shapes</span><span class=p>}</span>
        <span class=n>lookup</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>shapes</span><span class=p>)</span> <span class=o>|</span> <span class=nb>set</span><span class=p>(</span><span class=n>transforms</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>

        <span class=n>component_assignments</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>shading_group</span> <span class=ow>in</span> <span class=n>assignments</span><span class=o>.</span><span class=n>keys</span><span class=p>():</span>
            <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>shading_group</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>),</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>for</span> <span class=n>member</span> <span class=ow>in</span> <span class=n>members</span><span class=p>:</span>

                <span class=n>node</span> <span class=o>=</span> <span class=n>member</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
                <span class=k>if</span> <span class=n>node</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>lookup</span><span class=p>:</span>
                    <span class=k>continue</span>

                <span class=c1># Component</span>
                <span class=k>if</span> <span class=s2>&quot;.&quot;</span> <span class=ow>in</span> <span class=n>member</span><span class=p>:</span>

                    <span class=c1># Fix transform to shape as shaders are assigned to shapes</span>
                    <span class=k>if</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>transforms</span><span class=p>:</span>
                        <span class=n>shape</span> <span class=o>=</span> <span class=n>transforms</span><span class=p>[</span><span class=n>node</span><span class=p>]</span>
                        <span class=n>component</span> <span class=o>=</span> <span class=n>member</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
                        <span class=n>member</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>.</span><span class=si>{1}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>shape</span><span class=p>,</span> <span class=n>component</span><span class=p>)</span>

                <span class=n>component_assignments</span><span class=p>[</span><span class=n>shading_group</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>member</span><span class=p>)</span>
        <span class=n>assignments</span> <span class=o>=</span> <span class=n>component_assignments</span>

    <span class=k>return</span> <span class=nb>dict</span><span class=p>(</span><span class=n>assignments</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.guess_colorspace class="doc doc-heading"> <code class="highlight language-python"><span class=n>guess_colorspace</span><span class=p>(</span><span class=n>img_info</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Guess the colorspace of the input image filename. Note: Reference from makeTx.py Args: img_info (dict): Image info generated by :func:<code>image_info</code> Returns: str: color space name use in the <code>--colorconvert</code> option of maketx.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4056</span>
<span class=normal>4057</span>
<span class=normal>4058</span>
<span class=normal>4059</span>
<span class=normal>4060</span>
<span class=normal>4061</span>
<span class=normal>4062</span>
<span class=normal>4063</span>
<span class=normal>4064</span>
<span class=normal>4065</span>
<span class=normal>4066</span>
<span class=normal>4067</span>
<span class=normal>4068</span>
<span class=normal>4069</span>
<span class=normal>4070</span>
<span class=normal>4071</span>
<span class=normal>4072</span>
<span class=normal>4073</span>
<span class=normal>4074</span>
<span class=normal>4075</span>
<span class=normal>4076</span>
<span class=normal>4077</span>
<span class=normal>4078</span>
<span class=normal>4079</span>
<span class=normal>4080</span>
<span class=normal>4081</span>
<span class=normal>4082</span>
<span class=normal>4083</span>
<span class=normal>4084</span>
<span class=normal>4085</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>guess_colorspace</span><span class=p>(</span><span class=n>img_info</span><span class=p>):</span>
    <span class=c1># type: (dict) -&gt; str</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Guess the colorspace of the input image filename.</span>
<span class=sd>    Note:</span>
<span class=sd>        Reference from makeTx.py</span>
<span class=sd>    Args:</span>
<span class=sd>        img_info (dict): Image info generated by :func:`image_info`</span>
<span class=sd>    Returns:</span>
<span class=sd>        str: color space name use in the `--colorconvert`</span>
<span class=sd>             option of maketx.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>arnold</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
        <span class=n>AiTextureInvalidate</span><span class=p>,</span>
        <span class=c1># types</span>
        <span class=n>AI_TYPE_BYTE</span><span class=p>,</span>
        <span class=n>AI_TYPE_INT</span><span class=p>,</span>
        <span class=n>AI_TYPE_UINT</span>
    <span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;bit_depth&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=mi>16</span><span class=p>:</span>
            <span class=k>if</span> <span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;format&#39;</span><span class=p>]</span> <span class=ow>in</span> <span class=p>(</span><span class=n>AI_TYPE_BYTE</span><span class=p>,</span> <span class=n>AI_TYPE_INT</span><span class=p>,</span> <span class=n>AI_TYPE_UINT</span><span class=p>):</span> <span class=c1># noqa</span>
                <span class=k>return</span> <span class=s1>&#39;sRGB&#39;</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=k>return</span> <span class=s1>&#39;linear&#39;</span>
        <span class=c1># now discard the image file as AiTextureGetFormat has loaded it</span>
        <span class=n>AiTextureInvalidate</span><span class=p>(</span><span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;filename&#39;</span><span class=p>])</span>       <span class=c1># noqa</span>
    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>((</span><span class=s2>&quot;[maketx] Error: Could not guess&quot;</span>
               <span class=s2>&quot;colorspace for </span><span class=si>{}</span><span class=s2>&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>img_info</span><span class=p>[</span><span class=s2>&quot;filename&quot;</span><span class=p>]))</span>
        <span class=k>return</span> <span class=s2>&quot;linear&quot;</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.image_info class="doc doc-heading"> <code class="highlight language-python"><span class=n>image_info</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Based on the texture path, get its bit depth and format information. Take reference from makeTx.py in Arnold: ImageInfo(filename): Get Image Information for colorspace AiTextureGetFormat(filename): Get Texture Format AiTextureGetBitDepth(filename): Get Texture bit depth Args: file_path (str): Path to the texture file. Returns: dict: Dictionary with the information about the texture file.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4029</span>
<span class=normal>4030</span>
<span class=normal>4031</span>
<span class=normal>4032</span>
<span class=normal>4033</span>
<span class=normal>4034</span>
<span class=normal>4035</span>
<span class=normal>4036</span>
<span class=normal>4037</span>
<span class=normal>4038</span>
<span class=normal>4039</span>
<span class=normal>4040</span>
<span class=normal>4041</span>
<span class=normal>4042</span>
<span class=normal>4043</span>
<span class=normal>4044</span>
<span class=normal>4045</span>
<span class=normal>4046</span>
<span class=normal>4047</span>
<span class=normal>4048</span>
<span class=normal>4049</span>
<span class=normal>4050</span>
<span class=normal>4051</span>
<span class=normal>4052</span>
<span class=normal>4053</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>image_info</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
    <span class=c1># type: (str) -&gt; dict</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Based on the texture path, get its bit depth and format information.</span>
<span class=sd>    Take reference from makeTx.py in Arnold:</span>
<span class=sd>        ImageInfo(filename): Get Image Information for colorspace</span>
<span class=sd>        AiTextureGetFormat(filename): Get Texture Format</span>
<span class=sd>        AiTextureGetBitDepth(filename): Get Texture bit depth</span>
<span class=sd>    Args:</span>
<span class=sd>        file_path (str): Path to the texture file.</span>
<span class=sd>    Returns:</span>
<span class=sd>        dict: Dictionary with the information about the texture file.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>arnold</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
        <span class=n>AiTextureGetBitDepth</span><span class=p>,</span>
        <span class=n>AiTextureGetFormat</span>
    <span class=p>)</span>
    <span class=c1># Get Texture Information</span>
    <span class=n>img_info</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>file_path</span><span class=p>}</span>
    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
        <span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;bit_depth&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>AiTextureGetBitDepth</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>  <span class=c1># noqa</span>
        <span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;format&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>AiTextureGetFormat</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>  <span class=c1># noqa</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;bit_depth&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>8</span>
        <span class=n>img_info</span><span class=p>[</span><span class=s1>&#39;format&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;unknown&quot;</span>
    <span class=k>return</span> <span class=n>img_info</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.imprint class="doc doc-heading"> <code class="highlight language-python"><span class=n>imprint</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Write <code>data</code> to <code>node</code> as userDefined attributes</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Long name of node</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Dictionary of key/value pairs</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <blockquote> <p>from maya import cmds def compute(): ... return 6 ... cube, generator = cmds.polyCube() imprint(cube, { ... "regularString": "myFamily", ... "computedValue": lambda: compute() ... }) ... cmds.getAttr(cube + ".computedValue") 6</p> </blockquote> </blockquote> </blockquote> </details> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>682</span>
<span class=normal>683</span>
<span class=normal>684</span>
<span class=normal>685</span>
<span class=normal>686</span>
<span class=normal>687</span>
<span class=normal>688</span>
<span class=normal>689</span>
<span class=normal>690</span>
<span class=normal>691</span>
<span class=normal>692</span>
<span class=normal>693</span>
<span class=normal>694</span>
<span class=normal>695</span>
<span class=normal>696</span>
<span class=normal>697</span>
<span class=normal>698</span>
<span class=normal>699</span>
<span class=normal>700</span>
<span class=normal>701</span>
<span class=normal>702</span>
<span class=normal>703</span>
<span class=normal>704</span>
<span class=normal>705</span>
<span class=normal>706</span>
<span class=normal>707</span>
<span class=normal>708</span>
<span class=normal>709</span>
<span class=normal>710</span>
<span class=normal>711</span>
<span class=normal>712</span>
<span class=normal>713</span>
<span class=normal>714</span>
<span class=normal>715</span>
<span class=normal>716</span>
<span class=normal>717</span>
<span class=normal>718</span>
<span class=normal>719</span>
<span class=normal>720</span>
<span class=normal>721</span>
<span class=normal>722</span>
<span class=normal>723</span>
<span class=normal>724</span>
<span class=normal>725</span>
<span class=normal>726</span>
<span class=normal>727</span>
<span class=normal>728</span>
<span class=normal>729</span>
<span class=normal>730</span>
<span class=normal>731</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>imprint</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Write `data` to `node` as userDefined attributes</span>

<span class=sd>    Arguments:</span>
<span class=sd>        node (str): Long name of node</span>
<span class=sd>        data (dict): Dictionary of key/value pairs</span>

<span class=sd>    Example:</span>
<span class=sd>        &gt;&gt;&gt; from maya import cmds</span>
<span class=sd>        &gt;&gt;&gt; def compute():</span>
<span class=sd>        ...   return 6</span>
<span class=sd>        ...</span>
<span class=sd>        &gt;&gt;&gt; cube, generator = cmds.polyCube()</span>
<span class=sd>        &gt;&gt;&gt; imprint(cube, {</span>
<span class=sd>        ...   &quot;regularString&quot;: &quot;myFamily&quot;,</span>
<span class=sd>        ...   &quot;computedValue&quot;: lambda: compute()</span>
<span class=sd>        ... })</span>
<span class=sd>        ...</span>
<span class=sd>        &gt;&gt;&gt; cmds.getAttr(cube + &quot;.computedValue&quot;)</span>
<span class=sd>        6</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>

        <span class=k>if</span> <span class=nb>callable</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>
            <span class=c1># Support values evaluated at imprint</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>value</span><span class=p>()</span>

        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>bool</span><span class=p>):</span>
            <span class=n>add_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;attributeType&quot;</span><span class=p>:</span> <span class=s2>&quot;bool&quot;</span><span class=p>}</span>
            <span class=n>set_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;keyable&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&quot;channelBox&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
            <span class=n>add_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;dataType&quot;</span><span class=p>:</span> <span class=s2>&quot;string&quot;</span><span class=p>}</span>
            <span class=n>set_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;type&quot;</span><span class=p>:</span> <span class=s2>&quot;string&quot;</span><span class=p>}</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
            <span class=n>add_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;attributeType&quot;</span><span class=p>:</span> <span class=s2>&quot;long&quot;</span><span class=p>}</span>
            <span class=n>set_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;keyable&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&quot;channelBox&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=nb>float</span><span class=p>):</span>
            <span class=n>add_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;attributeType&quot;</span><span class=p>:</span> <span class=s2>&quot;double&quot;</span><span class=p>}</span>
            <span class=n>set_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;keyable&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&quot;channelBox&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>)):</span>
            <span class=n>add_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;attributeType&quot;</span><span class=p>:</span> <span class=s2>&quot;enum&quot;</span><span class=p>,</span> <span class=s2>&quot;enumName&quot;</span><span class=p>:</span> <span class=s2>&quot;:&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>value</span><span class=p>)}</span>
            <span class=n>set_type</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;keyable&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&quot;channelBox&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
            <span class=n>value</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># enum default</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>raise</span> <span class=ne>TypeError</span><span class=p>(</span><span class=s2>&quot;Unsupported type: </span><span class=si>%r</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=nb>type</span><span class=p>(</span><span class=n>value</span><span class=p>))</span>

        <span class=n>cmds</span><span class=o>.</span><span class=n>addAttr</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>longName</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=o>**</span><span class=n>add_type</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>node</span> <span class=o>+</span> <span class=s2>&quot;.&quot;</span> <span class=o>+</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=o>**</span><span class=n>set_type</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.is_valid_reference_node class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_valid_reference_node</span><span class=p>(</span><span class=n>reference_node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return whether Maya considers the reference node a valid reference.</p> <p>Maya might report an error when using <code>maya.cmds.referenceQuery</code>: Reference node 'reference_node' is not associated with a reference file.</p> <p>Note that this does <em>not</em> check whether the reference node points to an existing file. Instead, it only returns whether maya considers it valid and thus is not an unassociated reference node</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>reference_node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Reference node name</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> </td> <td> <div class=doc-md-description> <p>Whether reference node is a valid reference</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1816</span>
<span class=normal>1817</span>
<span class=normal>1818</span>
<span class=normal>1819</span>
<span class=normal>1820</span>
<span class=normal>1821</span>
<span class=normal>1822</span>
<span class=normal>1823</span>
<span class=normal>1824</span>
<span class=normal>1825</span>
<span class=normal>1826</span>
<span class=normal>1827</span>
<span class=normal>1828</span>
<span class=normal>1829</span>
<span class=normal>1830</span>
<span class=normal>1831</span>
<span class=normal>1832</span>
<span class=normal>1833</span>
<span class=normal>1834</span>
<span class=normal>1835</span>
<span class=normal>1836</span>
<span class=normal>1837</span>
<span class=normal>1838</span>
<span class=normal>1839</span>
<span class=normal>1840</span>
<span class=normal>1841</span>
<span class=normal>1842</span>
<span class=normal>1843</span>
<span class=normal>1844</span>
<span class=normal>1845</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>is_valid_reference_node</span><span class=p>(</span><span class=n>reference_node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return whether Maya considers the reference node a valid reference.</span>

<span class=sd>    Maya might report an error when using `maya.cmds.referenceQuery`:</span>
<span class=sd>    Reference node &#39;reference_node&#39; is not associated with a reference file.</span>

<span class=sd>    Note that this does *not* check whether the reference node points to an</span>
<span class=sd>    existing file. Instead, it only returns whether maya considers it valid</span>
<span class=sd>    and thus is not an unassociated reference node</span>

<span class=sd>    Arguments:</span>
<span class=sd>         reference_node (str): Reference node name</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: Whether reference node is a valid reference</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># maya 2022 is missing `isValidReference` so the check needs to be</span>
    <span class=c1># done in different way.</span>
    <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>about</span><span class=p>(</span><span class=n>version</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span> <span class=o>&lt;</span> <span class=mi>2023</span><span class=p>:</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>referenceQuery</span><span class=p>(</span><span class=n>reference_node</span><span class=p>,</span> <span class=n>filename</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
            <span class=k>return</span> <span class=kc>True</span>
        <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
            <span class=k>return</span> <span class=kc>False</span>
    <span class=n>sel</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MSelectionList</span><span class=p>()</span>
    <span class=n>sel</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>reference_node</span><span class=p>)</span>
    <span class=n>depend_node</span> <span class=o>=</span> <span class=n>sel</span><span class=o>.</span><span class=n>getDependNode</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnReference</span><span class=p>(</span><span class=n>depend_node</span><span class=p>)</span><span class=o>.</span><span class=n>isValidReference</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.is_visible class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_visible</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>displayLayer</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>intermediateObject</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>parentHidden</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>visibility</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Is <code>node</code> visible?</p> <p>Returns whether a node is hidden by one of the following methods: - The node exists (always checked) - The node must be a dagNode (always checked) - The node's visibility is off. - The node is set as intermediate Object. - The node is in a disabled displayLayer. - Whether any of its parent nodes is hidden.</p> <p>Roughly based on: http://ewertb.soundlinker.com/mel/mel.098.php</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> </td> <td> <div class=doc-md-description> <p>Whether the node is visible in the scene</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1328</span>
<span class=normal>1329</span>
<span class=normal>1330</span>
<span class=normal>1331</span>
<span class=normal>1332</span>
<span class=normal>1333</span>
<span class=normal>1334</span>
<span class=normal>1335</span>
<span class=normal>1336</span>
<span class=normal>1337</span>
<span class=normal>1338</span>
<span class=normal>1339</span>
<span class=normal>1340</span>
<span class=normal>1341</span>
<span class=normal>1342</span>
<span class=normal>1343</span>
<span class=normal>1344</span>
<span class=normal>1345</span>
<span class=normal>1346</span>
<span class=normal>1347</span>
<span class=normal>1348</span>
<span class=normal>1349</span>
<span class=normal>1350</span>
<span class=normal>1351</span>
<span class=normal>1352</span>
<span class=normal>1353</span>
<span class=normal>1354</span>
<span class=normal>1355</span>
<span class=normal>1356</span>
<span class=normal>1357</span>
<span class=normal>1358</span>
<span class=normal>1359</span>
<span class=normal>1360</span>
<span class=normal>1361</span>
<span class=normal>1362</span>
<span class=normal>1363</span>
<span class=normal>1364</span>
<span class=normal>1365</span>
<span class=normal>1366</span>
<span class=normal>1367</span>
<span class=normal>1368</span>
<span class=normal>1369</span>
<span class=normal>1370</span>
<span class=normal>1371</span>
<span class=normal>1372</span>
<span class=normal>1373</span>
<span class=normal>1374</span>
<span class=normal>1375</span>
<span class=normal>1376</span>
<span class=normal>1377</span>
<span class=normal>1378</span>
<span class=normal>1379</span>
<span class=normal>1380</span>
<span class=normal>1381</span>
<span class=normal>1382</span>
<span class=normal>1383</span>
<span class=normal>1384</span>
<span class=normal>1385</span>
<span class=normal>1386</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>is_visible</span><span class=p>(</span><span class=n>node</span><span class=p>,</span>
               <span class=n>displayLayer</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
               <span class=n>intermediateObject</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
               <span class=n>parentHidden</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
               <span class=n>visibility</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Is `node` visible?</span>

<span class=sd>    Returns whether a node is hidden by one of the following methods:</span>
<span class=sd>    - The node exists (always checked)</span>
<span class=sd>    - The node must be a dagNode (always checked)</span>
<span class=sd>    - The node&#39;s visibility is off.</span>
<span class=sd>    - The node is set as intermediate Object.</span>
<span class=sd>    - The node is in a disabled displayLayer.</span>
<span class=sd>    - Whether any of its parent nodes is hidden.</span>

<span class=sd>    Roughly based on: http://ewertb.soundlinker.com/mel/mel.098.php</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: Whether the node is visible in the scene</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Only existing objects can be visible</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objExists</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
        <span class=k>return</span> <span class=kc>False</span>

    <span class=c1># Only dagNodes can be visible</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objectType</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>isAType</span><span class=o>=</span><span class=s1>&#39;dagNode&#39;</span><span class=p>):</span>
        <span class=k>return</span> <span class=kc>False</span>

    <span class=k>if</span> <span class=n>visibility</span><span class=p>:</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{0}</span><span class=s1>.visibility&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>)):</span>
            <span class=k>return</span> <span class=kc>False</span>

    <span class=k>if</span> <span class=n>intermediateObject</span> <span class=ow>and</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objectType</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>isAType</span><span class=o>=</span><span class=s1>&#39;shape&#39;</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{0}</span><span class=s1>.intermediateObject&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>)):</span>
            <span class=k>return</span> <span class=kc>False</span>

    <span class=k>if</span> <span class=n>displayLayer</span><span class=p>:</span>
        <span class=c1># Display layers set overrideEnabled and overrideVisibility on members</span>
        <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=s1>&#39;overrideEnabled&#39;</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
            <span class=n>override_enabled</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1>.overrideEnabled&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>))</span>
            <span class=n>override_visibility</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{}</span><span class=s1>.overrideVisibility&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=n>node</span><span class=p>))</span>
            <span class=k>if</span> <span class=n>override_enabled</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>override_visibility</span><span class=p>:</span>
                <span class=k>return</span> <span class=kc>False</span>

    <span class=k>if</span> <span class=n>parentHidden</span><span class=p>:</span>
        <span class=n>parents</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listRelatives</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>parent</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fullPath</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>parents</span><span class=p>:</span>
            <span class=n>parent</span> <span class=o>=</span> <span class=n>parents</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>is_visible</span><span class=p>(</span><span class=n>parent</span><span class=p>,</span>
                              <span class=n>displayLayer</span><span class=o>=</span><span class=n>displayLayer</span><span class=p>,</span>
                              <span class=n>intermediateObject</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
                              <span class=n>parentHidden</span><span class=o>=</span><span class=n>parentHidden</span><span class=p>,</span>
                              <span class=n>visibility</span><span class=o>=</span><span class=n>visibility</span><span class=p>):</span>
                <span class=k>return</span> <span class=kc>False</span>

    <span class=k>return</span> <span class=kc>True</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.iter_parents class="doc doc-heading"> <code class="highlight language-python"><span class=n>iter_parents</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Iter parents of node from its long name.</p> <p>Note: The <code>node</code> <em>must</em> be the long node name.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Node long name.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Yields:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>All parent node names (long names)</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2305</span>
<span class=normal>2306</span>
<span class=normal>2307</span>
<span class=normal>2308</span>
<span class=normal>2309</span>
<span class=normal>2310</span>
<span class=normal>2311</span>
<span class=normal>2312</span>
<span class=normal>2313</span>
<span class=normal>2314</span>
<span class=normal>2315</span>
<span class=normal>2316</span>
<span class=normal>2317</span>
<span class=normal>2318</span>
<span class=normal>2319</span>
<span class=normal>2320</span>
<span class=normal>2321</span>
<span class=normal>2322</span>
<span class=normal>2323</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>iter_parents</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Iter parents of node from its long name.</span>

<span class=sd>    Note: The `node` *must* be the long node name.</span>

<span class=sd>    Args:</span>
<span class=sd>        node (str): Node long name.</span>

<span class=sd>    Yields:</span>
<span class=sd>        str: All parent node names (long names)</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
        <span class=n>split</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>split</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>split</span><span class=p>[</span><span class=mi>0</span><span class=p>]:</span>
            <span class=k>return</span>

        <span class=n>node</span> <span class=o>=</span> <span class=n>split</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
        <span class=k>yield</span> <span class=n>node</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.iter_shader_edits class="doc doc-heading"> <code class="highlight language-python"><span class=n>iter_shader_edits</span><span class=p>(</span><span class=n>relationships</span><span class=p>,</span> <span class=n>shader_nodes</span><span class=p>,</span> <span class=n>nodes_by_id</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Yield edits as a set of actions.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3441</span>
<span class=normal>3442</span>
<span class=normal>3443</span>
<span class=normal>3444</span>
<span class=normal>3445</span>
<span class=normal>3446</span>
<span class=normal>3447</span>
<span class=normal>3448</span>
<span class=normal>3449</span>
<span class=normal>3450</span>
<span class=normal>3451</span>
<span class=normal>3452</span>
<span class=normal>3453</span>
<span class=normal>3454</span>
<span class=normal>3455</span>
<span class=normal>3456</span>
<span class=normal>3457</span>
<span class=normal>3458</span>
<span class=normal>3459</span>
<span class=normal>3460</span>
<span class=normal>3461</span>
<span class=normal>3462</span>
<span class=normal>3463</span>
<span class=normal>3464</span>
<span class=normal>3465</span>
<span class=normal>3466</span>
<span class=normal>3467</span>
<span class=normal>3468</span>
<span class=normal>3469</span>
<span class=normal>3470</span>
<span class=normal>3471</span>
<span class=normal>3472</span>
<span class=normal>3473</span>
<span class=normal>3474</span>
<span class=normal>3475</span>
<span class=normal>3476</span>
<span class=normal>3477</span>
<span class=normal>3478</span>
<span class=normal>3479</span>
<span class=normal>3480</span>
<span class=normal>3481</span>
<span class=normal>3482</span>
<span class=normal>3483</span>
<span class=normal>3484</span>
<span class=normal>3485</span>
<span class=normal>3486</span>
<span class=normal>3487</span>
<span class=normal>3488</span>
<span class=normal>3489</span>
<span class=normal>3490</span>
<span class=normal>3491</span>
<span class=normal>3492</span>
<span class=normal>3493</span>
<span class=normal>3494</span>
<span class=normal>3495</span>
<span class=normal>3496</span>
<span class=normal>3497</span>
<span class=normal>3498</span>
<span class=normal>3499</span>
<span class=normal>3500</span>
<span class=normal>3501</span>
<span class=normal>3502</span>
<span class=normal>3503</span>
<span class=normal>3504</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>iter_shader_edits</span><span class=p>(</span><span class=n>relationships</span><span class=p>,</span> <span class=n>shader_nodes</span><span class=p>,</span> <span class=n>nodes_by_id</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Yield edits as a set of actions.&quot;&quot;&quot;</span>

    <span class=n>attributes</span> <span class=o>=</span> <span class=n>relationships</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;attributes&quot;</span><span class=p>,</span> <span class=p>[])</span>
    <span class=n>shader_data</span> <span class=o>=</span> <span class=n>relationships</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;relationships&quot;</span><span class=p>,</span> <span class=p>{})</span>

    <span class=n>shading_engines</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>shader_nodes</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;objectSet&quot;</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>assert</span> <span class=n>shading_engines</span><span class=p>,</span> <span class=s2>&quot;Error in retrieving objectSets from reference&quot;</span>

    <span class=c1># region compute lookup</span>
    <span class=n>shading_engines_by_id</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>shad</span> <span class=ow>in</span> <span class=n>shading_engines</span><span class=p>:</span>
        <span class=n>shading_engines_by_id</span><span class=p>[</span><span class=n>get_id</span><span class=p>(</span><span class=n>shad</span><span class=p>)]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>shad</span><span class=p>)</span>
    <span class=c1># endregion</span>

    <span class=c1># region assign shading engines and other sets</span>
    <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>shader_data</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
        <span class=c1># collect all unique IDs of the set members</span>
        <span class=n>shader_uuid</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>]</span>
        <span class=n>member_uuids</span> <span class=o>=</span> <span class=p>[</span>
            <span class=p>(</span><span class=n>member</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>],</span> <span class=n>member</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;components&quot;</span><span class=p>))</span>
            <span class=k>for</span> <span class=n>member</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;members&quot;</span><span class=p>]]</span>

        <span class=n>filtered_nodes</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>_uuid</span><span class=p>,</span> <span class=n>components</span> <span class=ow>in</span> <span class=n>member_uuids</span><span class=p>:</span>
            <span class=n>nodes</span> <span class=o>=</span> <span class=n>nodes_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>_uuid</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>nodes</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                <span class=k>continue</span>

            <span class=k>if</span> <span class=n>components</span><span class=p>:</span>
                <span class=c1># Assign to the components</span>
                <span class=n>nodes</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;.&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>node</span><span class=p>,</span> <span class=n>components</span><span class=p>])</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>]</span>

            <span class=n>filtered_nodes</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>

        <span class=n>id_shading_engines</span> <span class=o>=</span> <span class=n>shading_engines_by_id</span><span class=p>[</span><span class=n>shader_uuid</span><span class=p>]</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>id_shading_engines</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{}</span><span class=s2> - No shader found with cbId &quot;</span>
                      <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>shader_uuid</span><span class=p>))</span>
            <span class=k>continue</span>
        <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=n>id_shading_engines</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{}</span><span class=s2> - Skipping shader assignment. &quot;</span>
                      <span class=s2>&quot;More than one shader found with cbId &quot;</span>
                      <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39;. (found: </span><span class=si>{}</span><span class=s2>)&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>shader_uuid</span><span class=p>,</span>
                                                 <span class=n>id_shading_engines</span><span class=p>))</span>
            <span class=k>continue</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>filtered_nodes</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{}</span><span class=s2> - No nodes found for shading engine &quot;</span>
                        <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> <span class=n>id_shading_engines</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
            <span class=k>continue</span>

        <span class=k>yield</span> <span class=p>{</span><span class=s2>&quot;action&quot;</span><span class=p>:</span> <span class=s2>&quot;assign&quot;</span><span class=p>,</span>
               <span class=s2>&quot;uuid&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>],</span>
               <span class=s2>&quot;nodes&quot;</span><span class=p>:</span> <span class=n>filtered_nodes</span><span class=p>,</span>
               <span class=s2>&quot;shader&quot;</span><span class=p>:</span> <span class=n>id_shading_engines</span><span class=p>[</span><span class=mi>0</span><span class=p>]}</span>

    <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>attributes</span><span class=p>:</span>
        <span class=n>nodes</span> <span class=o>=</span> <span class=n>nodes_by_id</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>],</span> <span class=p>[])</span>
        <span class=n>attr_value</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;attributes&quot;</span><span class=p>]</span>
        <span class=k>yield</span> <span class=p>{</span><span class=s2>&quot;action&quot;</span><span class=p>:</span> <span class=s2>&quot;setattr&quot;</span><span class=p>,</span>
               <span class=s2>&quot;uuid&quot;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;uuid&quot;</span><span class=p>],</span>
               <span class=s2>&quot;nodes&quot;</span><span class=p>:</span> <span class=n>nodes</span><span class=p>,</span>
               <span class=s2>&quot;attributes&quot;</span><span class=p>:</span> <span class=n>attr_value</span><span class=p>}</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.iter_visible_nodes_in_range class="doc doc-heading"> <code class="highlight language-python"><span class=n>iter_visible_nodes_in_range</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Yield nodes that are visible in start-end frame range.</p> <ul> <li>Ignores intermediateObjects completely.</li> <li>Considers animated visibility attributes + upstream visibilities.</li> </ul> <p>This is optimized for large scenes where some nodes in the parent hierarchy might have some input connections to the visibilities, e.g. key, driven keys, connections to other attributes, etc.</p> <p>This only does a single time step to <code>start</code> if current frame is not inside frame range since the assumption is made that changing a frame isn't so slow that it beats querying all visibility plugs through MDGContext on another frame.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>List of node names to consider.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>start</code> </td> <td> <code>(<span title=int>int</span>, <span title=float>float</span>)</code> </td> <td> <div class=doc-md-description> <p>Start frame.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>end</code> </td> <td> <code>(<span title=int>int</span>, <span title=float>float</span>)</code> </td> <td> <div class=doc-md-description> <p>End frame.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>List of node names. These will be long full path names so might have a longer name than the input nodes.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3651</span>
<span class=normal>3652</span>
<span class=normal>3653</span>
<span class=normal>3654</span>
<span class=normal>3655</span>
<span class=normal>3656</span>
<span class=normal>3657</span>
<span class=normal>3658</span>
<span class=normal>3659</span>
<span class=normal>3660</span>
<span class=normal>3661</span>
<span class=normal>3662</span>
<span class=normal>3663</span>
<span class=normal>3664</span>
<span class=normal>3665</span>
<span class=normal>3666</span>
<span class=normal>3667</span>
<span class=normal>3668</span>
<span class=normal>3669</span>
<span class=normal>3670</span>
<span class=normal>3671</span>
<span class=normal>3672</span>
<span class=normal>3673</span>
<span class=normal>3674</span>
<span class=normal>3675</span>
<span class=normal>3676</span>
<span class=normal>3677</span>
<span class=normal>3678</span>
<span class=normal>3679</span>
<span class=normal>3680</span>
<span class=normal>3681</span>
<span class=normal>3682</span>
<span class=normal>3683</span>
<span class=normal>3684</span>
<span class=normal>3685</span>
<span class=normal>3686</span>
<span class=normal>3687</span>
<span class=normal>3688</span>
<span class=normal>3689</span>
<span class=normal>3690</span>
<span class=normal>3691</span>
<span class=normal>3692</span>
<span class=normal>3693</span>
<span class=normal>3694</span>
<span class=normal>3695</span>
<span class=normal>3696</span>
<span class=normal>3697</span>
<span class=normal>3698</span>
<span class=normal>3699</span>
<span class=normal>3700</span>
<span class=normal>3701</span>
<span class=normal>3702</span>
<span class=normal>3703</span>
<span class=normal>3704</span>
<span class=normal>3705</span>
<span class=normal>3706</span>
<span class=normal>3707</span>
<span class=normal>3708</span>
<span class=normal>3709</span>
<span class=normal>3710</span>
<span class=normal>3711</span>
<span class=normal>3712</span>
<span class=normal>3713</span>
<span class=normal>3714</span>
<span class=normal>3715</span>
<span class=normal>3716</span>
<span class=normal>3717</span>
<span class=normal>3718</span>
<span class=normal>3719</span>
<span class=normal>3720</span>
<span class=normal>3721</span>
<span class=normal>3722</span>
<span class=normal>3723</span>
<span class=normal>3724</span>
<span class=normal>3725</span>
<span class=normal>3726</span>
<span class=normal>3727</span>
<span class=normal>3728</span>
<span class=normal>3729</span>
<span class=normal>3730</span>
<span class=normal>3731</span>
<span class=normal>3732</span>
<span class=normal>3733</span>
<span class=normal>3734</span>
<span class=normal>3735</span>
<span class=normal>3736</span>
<span class=normal>3737</span>
<span class=normal>3738</span>
<span class=normal>3739</span>
<span class=normal>3740</span>
<span class=normal>3741</span>
<span class=normal>3742</span>
<span class=normal>3743</span>
<span class=normal>3744</span>
<span class=normal>3745</span>
<span class=normal>3746</span>
<span class=normal>3747</span>
<span class=normal>3748</span>
<span class=normal>3749</span>
<span class=normal>3750</span>
<span class=normal>3751</span>
<span class=normal>3752</span>
<span class=normal>3753</span>
<span class=normal>3754</span>
<span class=normal>3755</span>
<span class=normal>3756</span>
<span class=normal>3757</span>
<span class=normal>3758</span>
<span class=normal>3759</span>
<span class=normal>3760</span>
<span class=normal>3761</span>
<span class=normal>3762</span>
<span class=normal>3763</span>
<span class=normal>3764</span>
<span class=normal>3765</span>
<span class=normal>3766</span>
<span class=normal>3767</span>
<span class=normal>3768</span>
<span class=normal>3769</span>
<span class=normal>3770</span>
<span class=normal>3771</span>
<span class=normal>3772</span>
<span class=normal>3773</span>
<span class=normal>3774</span>
<span class=normal>3775</span>
<span class=normal>3776</span>
<span class=normal>3777</span>
<span class=normal>3778</span>
<span class=normal>3779</span>
<span class=normal>3780</span>
<span class=normal>3781</span>
<span class=normal>3782</span>
<span class=normal>3783</span>
<span class=normal>3784</span>
<span class=normal>3785</span>
<span class=normal>3786</span>
<span class=normal>3787</span>
<span class=normal>3788</span>
<span class=normal>3789</span>
<span class=normal>3790</span>
<span class=normal>3791</span>
<span class=normal>3792</span>
<span class=normal>3793</span>
<span class=normal>3794</span>
<span class=normal>3795</span>
<span class=normal>3796</span>
<span class=normal>3797</span>
<span class=normal>3798</span>
<span class=normal>3799</span>
<span class=normal>3800</span>
<span class=normal>3801</span>
<span class=normal>3802</span>
<span class=normal>3803</span>
<span class=normal>3804</span>
<span class=normal>3805</span>
<span class=normal>3806</span>
<span class=normal>3807</span>
<span class=normal>3808</span>
<span class=normal>3809</span>
<span class=normal>3810</span>
<span class=normal>3811</span>
<span class=normal>3812</span>
<span class=normal>3813</span>
<span class=normal>3814</span>
<span class=normal>3815</span>
<span class=normal>3816</span>
<span class=normal>3817</span>
<span class=normal>3818</span>
<span class=normal>3819</span>
<span class=normal>3820</span>
<span class=normal>3821</span>
<span class=normal>3822</span>
<span class=normal>3823</span>
<span class=normal>3824</span>
<span class=normal>3825</span>
<span class=normal>3826</span>
<span class=normal>3827</span>
<span class=normal>3828</span>
<span class=normal>3829</span>
<span class=normal>3830</span>
<span class=normal>3831</span>
<span class=normal>3832</span>
<span class=normal>3833</span>
<span class=normal>3834</span>
<span class=normal>3835</span>
<span class=normal>3836</span>
<span class=normal>3837</span>
<span class=normal>3838</span>
<span class=normal>3839</span>
<span class=normal>3840</span>
<span class=normal>3841</span>
<span class=normal>3842</span>
<span class=normal>3843</span>
<span class=normal>3844</span>
<span class=normal>3845</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>iter_visible_nodes_in_range</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Yield nodes that are visible in start-end frame range.</span>

<span class=sd>    - Ignores intermediateObjects completely.</span>
<span class=sd>    - Considers animated visibility attributes + upstream visibilities.</span>

<span class=sd>    This is optimized for large scenes where some nodes in the parent</span>
<span class=sd>    hierarchy might have some input connections to the visibilities,</span>
<span class=sd>    e.g. key, driven keys, connections to other attributes, etc.</span>

<span class=sd>    This only does a single time step to `start` if current frame is</span>
<span class=sd>    not inside frame range since the assumption is made that changing</span>
<span class=sd>    a frame isn&#39;t so slow that it beats querying all visibility</span>
<span class=sd>    plugs through MDGContext on another frame.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodes (list): List of node names to consider.</span>
<span class=sd>        start (int, float): Start frame.</span>
<span class=sd>        end (int, float): End frame.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: List of node names. These will be long full path names so</span>
<span class=sd>            might have a longer name than the input nodes.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># States we consider per node</span>
    <span class=n>VISIBLE</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># always visible</span>
    <span class=n>INVISIBLE</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># always invisible</span>
    <span class=n>ANIMATED</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span>  <span class=c1># animated visibility</span>

    <span class=c1># Ensure integers</span>
    <span class=n>start</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>start</span><span class=p>)</span>
    <span class=n>end</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>end</span><span class=p>)</span>

    <span class=c1># Consider only non-intermediate dag nodes and use the &quot;long&quot; names.</span>
    <span class=n>nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>noIntermediate</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;dagNode&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=k>with</span> <span class=n>maintained_time</span><span class=p>():</span>
        <span class=c1># Go to first frame of the range if the current time is outside</span>
        <span class=c1># the queried range so can directly query all visible nodes on</span>
        <span class=c1># that frame.</span>
        <span class=n>current_time</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=p>(</span><span class=n>start</span> <span class=o>&lt;=</span> <span class=n>current_time</span> <span class=o>&lt;=</span> <span class=n>end</span><span class=p>):</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>start</span><span class=p>)</span>

        <span class=n>visible</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>visible</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>visible</span><span class=p>:</span>
            <span class=k>yield</span> <span class=n>node</span>
        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>visible</span><span class=p>)</span> <span class=o>==</span> <span class=nb>len</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span> <span class=ow>or</span> <span class=n>start</span> <span class=o>==</span> <span class=n>end</span><span class=p>:</span>
            <span class=c1># All are visible on frame one, so they are at least visible once</span>
            <span class=c1># inside the frame range.</span>
            <span class=k>return</span>

    <span class=c1># For the invisible ones check whether its visibility and/or</span>
    <span class=c1># any of its parents visibility attributes are animated. If so, it might</span>
    <span class=c1># get visible on other frames in the range.</span>
    <span class=k>def</span><span class=w> </span><span class=nf>memodict</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Memoization decorator for a function taking a single argument.</span>

<span class=sd>        See: http://code.activestate.com/recipes/</span>
<span class=sd>             578231-probably-the-fastest-memoization-decorator-in-the-/</span>
<span class=sd>        &quot;&quot;&quot;</span>

        <span class=k>class</span><span class=w> </span><span class=nc>memodict</span><span class=p>(</span><span class=nb>dict</span><span class=p>):</span>
            <span class=k>def</span><span class=w> </span><span class=fm>__missing__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
                <span class=n>ret</span> <span class=o>=</span> <span class=bp>self</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>f</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
                <span class=k>return</span> <span class=n>ret</span>

        <span class=k>return</span> <span class=n>memodict</span><span class=p>()</span><span class=o>.</span><span class=fm>__getitem__</span>

    <span class=nd>@memodict</span>
    <span class=k>def</span><span class=w> </span><span class=nf>get_state</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
        <span class=n>plug</span> <span class=o>=</span> <span class=n>node</span> <span class=o>+</span> <span class=s2>&quot;.visibility&quot;</span>
        <span class=n>connections</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span><span class=n>plug</span><span class=p>,</span>
                                           <span class=n>source</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                           <span class=n>destination</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>connections</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>ANIMATED</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>VISIBLE</span> <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>plug</span><span class=p>)</span> <span class=k>else</span> <span class=n>INVISIBLE</span>

    <span class=n>visible</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>visible</span><span class=p>)</span>
    <span class=n>invisible</span> <span class=o>=</span> <span class=p>[</span><span class=n>node</span> <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span> <span class=k>if</span> <span class=n>node</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>visible</span><span class=p>]</span>
    <span class=n>always_invisible</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=c1># Iterate over the nodes by short to long names to iterate the highest</span>
    <span class=c1># in hierarchy nodes first. So the collected data can be used from the</span>
    <span class=c1># cache for parent queries in next iterations.</span>
    <span class=n>node_dependencies</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>invisible</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=nb>len</span><span class=p>):</span>

        <span class=n>state</span> <span class=o>=</span> <span class=n>get_state</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>state</span> <span class=o>==</span> <span class=n>INVISIBLE</span><span class=p>:</span>
            <span class=n>always_invisible</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
            <span class=k>continue</span>

        <span class=c1># If not always invisible by itself we should go through and check</span>
        <span class=c1># the parents to see if any of them are always invisible. For those</span>
        <span class=c1># that are &quot;ANIMATED&quot; we consider that this node is dependent on</span>
        <span class=c1># that attribute, we store them as dependency.</span>
        <span class=n>dependencies</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
        <span class=k>if</span> <span class=n>state</span> <span class=o>==</span> <span class=n>ANIMATED</span><span class=p>:</span>
            <span class=n>dependencies</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

        <span class=n>traversed_parents</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>
        <span class=k>for</span> <span class=n>parent</span> <span class=ow>in</span> <span class=n>iter_parents</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>

            <span class=k>if</span> <span class=n>parent</span> <span class=ow>in</span> <span class=n>always_invisible</span> <span class=ow>or</span> <span class=n>get_state</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span> <span class=o>==</span> <span class=n>INVISIBLE</span><span class=p>:</span>
                <span class=c1># When parent is always invisible then consider this parent,</span>
                <span class=c1># this node we started from and any of the parents we</span>
                <span class=c1># have traversed in-between to be *always invisible*</span>
                <span class=n>always_invisible</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
                <span class=n>always_invisible</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
                <span class=n>always_invisible</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>traversed_parents</span><span class=p>)</span>
                <span class=k>break</span>

            <span class=c1># If we have traversed the parent before and its visibility</span>
            <span class=c1># was dependent on animated visibilities then we can just extend</span>
            <span class=c1># its dependencies for to those for this node and break further</span>
            <span class=c1># iteration upwards.</span>
            <span class=n>parent_dependencies</span> <span class=o>=</span> <span class=n>node_dependencies</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>parent</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>parent_dependencies</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
                <span class=n>dependencies</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>parent_dependencies</span><span class=p>)</span>
                <span class=k>break</span>

            <span class=n>state</span> <span class=o>=</span> <span class=n>get_state</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>state</span> <span class=o>==</span> <span class=n>ANIMATED</span><span class=p>:</span>
                <span class=n>dependencies</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>

            <span class=n>traversed_parents</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>node</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>always_invisible</span> <span class=ow>and</span> <span class=n>dependencies</span><span class=p>:</span>
            <span class=n>node_dependencies</span><span class=p>[</span><span class=n>node</span><span class=p>]</span> <span class=o>=</span> <span class=n>dependencies</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>node_dependencies</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=c1># Now we only have to check the visibilities for nodes that have animated</span>
    <span class=c1># visibility dependencies upstream. The fastest way to check these</span>
    <span class=c1># visibility attributes across different frames is with Python api 2.0</span>
    <span class=c1># so we do that.</span>
    <span class=nd>@memodict</span>
    <span class=k>def</span><span class=w> </span><span class=nf>get_visibility_mplug</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return api 2.0 MPlug with cached memoize decorator&quot;&quot;&quot;</span>
        <span class=n>sel</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MSelectionList</span><span class=p>()</span>
        <span class=n>sel</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=n>dag</span> <span class=o>=</span> <span class=n>sel</span><span class=o>.</span><span class=n>getDagPath</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDagNode</span><span class=p>(</span><span class=n>dag</span><span class=p>)</span><span class=o>.</span><span class=n>findPlug</span><span class=p>(</span><span class=s2>&quot;visibility&quot;</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>

    <span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
    <span class=k>def</span><span class=w> </span><span class=nf>dgcontext</span><span class=p>(</span><span class=n>mtime</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;MDGContext context manager&quot;&quot;&quot;</span>
        <span class=n>context</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MDGContext</span><span class=p>(</span><span class=n>mtime</span><span class=p>)</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>previous</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>makeCurrent</span><span class=p>()</span>
            <span class=k>yield</span> <span class=n>context</span>
        <span class=k>finally</span><span class=p>:</span>
            <span class=n>previous</span><span class=o>.</span><span class=n>makeCurrent</span><span class=p>()</span>

    <span class=c1># We skip the first frame as we already used that frame to check for</span>
    <span class=c1># overall visibilities. And end+1 to include the end frame.</span>
    <span class=n>scene_units</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MTime</span><span class=o>.</span><span class=n>uiUnit</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>frame</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>start</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>end</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
        <span class=n>mtime</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MTime</span><span class=p>(</span><span class=n>frame</span><span class=p>,</span> <span class=n>unit</span><span class=o>=</span><span class=n>scene_units</span><span class=p>)</span>

        <span class=c1># Build little cache so we don&#39;t query the same MPlug&#39;s value</span>
        <span class=c1># again if it was checked on this frame and also is a dependency</span>
        <span class=c1># for another node</span>
        <span class=n>frame_visibilities</span> <span class=o>=</span> <span class=p>{}</span>
        <span class=k>with</span> <span class=n>dgcontext</span><span class=p>(</span><span class=n>mtime</span><span class=p>):</span>
            <span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>dependencies</span> <span class=ow>in</span> <span class=nb>list</span><span class=p>(</span><span class=n>node_dependencies</span><span class=o>.</span><span class=n>items</span><span class=p>()):</span>
                <span class=k>for</span> <span class=n>dependency</span> <span class=ow>in</span> <span class=n>dependencies</span><span class=p>:</span>
                    <span class=n>dependency_visible</span> <span class=o>=</span> <span class=n>frame_visibilities</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>dependency</span><span class=p>,</span>
                                                                <span class=kc>None</span><span class=p>)</span>
                    <span class=k>if</span> <span class=n>dependency_visible</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
                        <span class=n>mplug</span> <span class=o>=</span> <span class=n>get_visibility_mplug</span><span class=p>(</span><span class=n>dependency</span><span class=p>)</span>
                        <span class=n>dependency_visible</span> <span class=o>=</span> <span class=n>mplug</span><span class=o>.</span><span class=n>asBool</span><span class=p>()</span>
                        <span class=n>frame_visibilities</span><span class=p>[</span><span class=n>dependency</span><span class=p>]</span> <span class=o>=</span> <span class=n>dependency_visible</span>

                    <span class=k>if</span> <span class=ow>not</span> <span class=n>dependency_visible</span><span class=p>:</span>
                        <span class=c1># One dependency is not visible, thus the</span>
                        <span class=c1># node is not visible.</span>
                        <span class=k>break</span>

                <span class=k>else</span><span class=p>:</span>
                    <span class=c1># All dependencies are visible.</span>
                    <span class=k>yield</span> <span class=n>node</span>
                    <span class=c1># Remove node with dependencies for next frame iterations</span>
                    <span class=c1># because it was visible at least once.</span>
                    <span class=n>node_dependencies</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>

        <span class=c1># If no more nodes to process break the frame iterations..</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>node_dependencies</span><span class=p>:</span>
            <span class=k>break</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.keytangent_default class="doc doc-heading"> <code class="highlight language-python"><span class=n>keytangent_default</span><span class=p>(</span><span class=n>in_tangent_type</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span> <span class=n>out_tangent_type</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set the default keyTangent for new keys during this context</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>843</span>
<span class=normal>844</span>
<span class=normal>845</span>
<span class=normal>846</span>
<span class=normal>847</span>
<span class=normal>848</span>
<span class=normal>849</span>
<span class=normal>850</span>
<span class=normal>851</span>
<span class=normal>852</span>
<span class=normal>853</span>
<span class=normal>854</span>
<span class=normal>855</span>
<span class=normal>856</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>keytangent_default</span><span class=p>(</span><span class=n>in_tangent_type</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>,</span>
                       <span class=n>out_tangent_type</span><span class=o>=</span><span class=s1>&#39;auto&#39;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the default keyTangent for new keys during this context&quot;&quot;&quot;</span>

    <span class=n>original_itt</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>keyTangent</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>g</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>itt</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>original_ott</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>keyTangent</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>g</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>ott</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>keyTangent</span><span class=p>(</span><span class=n>g</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>itt</span><span class=o>=</span><span class=n>in_tangent_type</span><span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>keyTangent</span><span class=p>(</span><span class=n>g</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>ott</span><span class=o>=</span><span class=n>out_tangent_type</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>keyTangent</span><span class=p>(</span><span class=n>g</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>itt</span><span class=o>=</span><span class=n>original_itt</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>keyTangent</span><span class=p>(</span><span class=n>g</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>ott</span><span class=o>=</span><span class=n>original_ott</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.len_flattened class="doc doc-heading"> <code class="highlight language-python"><span class=n>len_flattened</span><span class=p>(</span><span class=n>components</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return the length of the list as if it was flattened.</p> <p>Maya will return consecutive components as a single entry when requesting with <code>maya.cmds.ls</code> without the <code>flatten</code> flag. Though enabling <code>flatten</code> on a large list (e.g. millions) will result in a slow result. This command will return the amount of entries in a non-flattened list by parsing the result with regex.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>components</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>The non-flattened components.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>int</code></td> <td> </td> <td> <div class=doc-md-description> <p>The amount of entries.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4088</span>
<span class=normal>4089</span>
<span class=normal>4090</span>
<span class=normal>4091</span>
<span class=normal>4092</span>
<span class=normal>4093</span>
<span class=normal>4094</span>
<span class=normal>4095</span>
<span class=normal>4096</span>
<span class=normal>4097</span>
<span class=normal>4098</span>
<span class=normal>4099</span>
<span class=normal>4100</span>
<span class=normal>4101</span>
<span class=normal>4102</span>
<span class=normal>4103</span>
<span class=normal>4104</span>
<span class=normal>4105</span>
<span class=normal>4106</span>
<span class=normal>4107</span>
<span class=normal>4108</span>
<span class=normal>4109</span>
<span class=normal>4110</span>
<span class=normal>4111</span>
<span class=normal>4112</span>
<span class=normal>4113</span>
<span class=normal>4114</span>
<span class=normal>4115</span>
<span class=normal>4116</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>len_flattened</span><span class=p>(</span><span class=n>components</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the length of the list as if it was flattened.</span>

<span class=sd>    Maya will return consecutive components as a single entry</span>
<span class=sd>    when requesting with `maya.cmds.ls` without the `flatten`</span>
<span class=sd>    flag. Though enabling `flatten` on a large list (e.g. millions)</span>
<span class=sd>    will result in a slow result. This command will return the amount</span>
<span class=sd>    of entries in a non-flattened list by parsing the result with</span>
<span class=sd>    regex.</span>

<span class=sd>    Args:</span>
<span class=sd>        components (list): The non-flattened components.</span>

<span class=sd>    Returns:</span>
<span class=sd>        int: The amount of entries.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>assert</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>components</span><span class=p>,</span> <span class=p>(</span><span class=nb>list</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>))</span>
    <span class=n>n</span> <span class=o>=</span> <span class=mi>0</span>

    <span class=n>pattern</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;\[(\d+):(\d+)\]&quot;</span><span class=p>)</span>
    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>components</span><span class=p>:</span>
        <span class=n>match</span> <span class=o>=</span> <span class=n>pattern</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>match</span><span class=p>:</span>
            <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=n>match</span><span class=o>.</span><span class=n>groups</span><span class=p>()</span>
            <span class=n>n</span> <span class=o>+=</span> <span class=nb>int</span><span class=p>(</span><span class=n>end</span><span class=p>)</span> <span class=o>-</span> <span class=nb>int</span><span class=p>(</span><span class=n>start</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
    <span class=k>return</span> <span class=n>n</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.list_looks class="doc doc-heading"> <code class="highlight language-python"><span class=n>list_looks</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>folder_id</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return all look products for the given folder.</p> <p>This assumes all look products start with "look*" in their names.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>list[dict[str, Any]]: List of look products.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1930</span>
<span class=normal>1931</span>
<span class=normal>1932</span>
<span class=normal>1933</span>
<span class=normal>1934</span>
<span class=normal>1935</span>
<span class=normal>1936</span>
<span class=normal>1937</span>
<span class=normal>1938</span>
<span class=normal>1939</span>
<span class=normal>1940</span>
<span class=normal>1941</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>list_looks</span><span class=p>(</span><span class=n>project_name</span><span class=p>,</span> <span class=n>folder_id</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return all look products for the given folder.</span>

<span class=sd>    This assumes all look products start with &quot;look*&quot; in their names.</span>

<span class=sd>    Returns:</span>
<span class=sd>        list[dict[str, Any]]: List of look products.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>ayon_api</span><span class=o>.</span><span class=n>get_products</span><span class=p>(</span>
        <span class=n>project_name</span><span class=p>,</span> <span class=n>folder_ids</span><span class=o>=</span><span class=p>[</span><span class=n>folder_id</span><span class=p>],</span> <span class=n>product_types</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;look&quot;</span><span class=p>}</span>
    <span class=p>))</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.load_capture_preset class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_capture_preset</span><span class=p>(</span><span class=n>data</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Convert AYON Extract Playblast settings to <code>capture</code> arguments</p> <details class=input-data-is-the-settings-from open> <summary>Input data is the settings from</summary> <p><code>project_settings/maya/publish/ExtractPlayblast/capture_preset</code></p> </details> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Capture preset settings from AYON settings</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>dict</code></td> <td> </td> <td> <div class=doc-md-description> <p><code>capture.capture</code> compatible keyword arguments</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3150</span>
<span class=normal>3151</span>
<span class=normal>3152</span>
<span class=normal>3153</span>
<span class=normal>3154</span>
<span class=normal>3155</span>
<span class=normal>3156</span>
<span class=normal>3157</span>
<span class=normal>3158</span>
<span class=normal>3159</span>
<span class=normal>3160</span>
<span class=normal>3161</span>
<span class=normal>3162</span>
<span class=normal>3163</span>
<span class=normal>3164</span>
<span class=normal>3165</span>
<span class=normal>3166</span>
<span class=normal>3167</span>
<span class=normal>3168</span>
<span class=normal>3169</span>
<span class=normal>3170</span>
<span class=normal>3171</span>
<span class=normal>3172</span>
<span class=normal>3173</span>
<span class=normal>3174</span>
<span class=normal>3175</span>
<span class=normal>3176</span>
<span class=normal>3177</span>
<span class=normal>3178</span>
<span class=normal>3179</span>
<span class=normal>3180</span>
<span class=normal>3181</span>
<span class=normal>3182</span>
<span class=normal>3183</span>
<span class=normal>3184</span>
<span class=normal>3185</span>
<span class=normal>3186</span>
<span class=normal>3187</span>
<span class=normal>3188</span>
<span class=normal>3189</span>
<span class=normal>3190</span>
<span class=normal>3191</span>
<span class=normal>3192</span>
<span class=normal>3193</span>
<span class=normal>3194</span>
<span class=normal>3195</span>
<span class=normal>3196</span>
<span class=normal>3197</span>
<span class=normal>3198</span>
<span class=normal>3199</span>
<span class=normal>3200</span>
<span class=normal>3201</span>
<span class=normal>3202</span>
<span class=normal>3203</span>
<span class=normal>3204</span>
<span class=normal>3205</span>
<span class=normal>3206</span>
<span class=normal>3207</span>
<span class=normal>3208</span>
<span class=normal>3209</span>
<span class=normal>3210</span>
<span class=normal>3211</span>
<span class=normal>3212</span>
<span class=normal>3213</span>
<span class=normal>3214</span>
<span class=normal>3215</span>
<span class=normal>3216</span>
<span class=normal>3217</span>
<span class=normal>3218</span>
<span class=normal>3219</span>
<span class=normal>3220</span>
<span class=normal>3221</span>
<span class=normal>3222</span>
<span class=normal>3223</span>
<span class=normal>3224</span>
<span class=normal>3225</span>
<span class=normal>3226</span>
<span class=normal>3227</span>
<span class=normal>3228</span>
<span class=normal>3229</span>
<span class=normal>3230</span>
<span class=normal>3231</span>
<span class=normal>3232</span>
<span class=normal>3233</span>
<span class=normal>3234</span>
<span class=normal>3235</span>
<span class=normal>3236</span>
<span class=normal>3237</span>
<span class=normal>3238</span>
<span class=normal>3239</span>
<span class=normal>3240</span>
<span class=normal>3241</span>
<span class=normal>3242</span>
<span class=normal>3243</span>
<span class=normal>3244</span>
<span class=normal>3245</span>
<span class=normal>3246</span>
<span class=normal>3247</span>
<span class=normal>3248</span>
<span class=normal>3249</span>
<span class=normal>3250</span>
<span class=normal>3251</span>
<span class=normal>3252</span>
<span class=normal>3253</span>
<span class=normal>3254</span>
<span class=normal>3255</span>
<span class=normal>3256</span>
<span class=normal>3257</span>
<span class=normal>3258</span>
<span class=normal>3259</span>
<span class=normal>3260</span>
<span class=normal>3261</span>
<span class=normal>3262</span>
<span class=normal>3263</span>
<span class=normal>3264</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>load_capture_preset</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Convert AYON Extract Playblast settings to `capture` arguments</span>

<span class=sd>    Input data is the settings from:</span>
<span class=sd>        `project_settings/maya/publish/ExtractPlayblast/capture_preset`</span>

<span class=sd>    Args:</span>
<span class=sd>        data (dict): Capture preset settings from AYON settings</span>

<span class=sd>    Returns:</span>
<span class=sd>        dict: `capture.capture` compatible keyword arguments</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>options</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
    <span class=n>viewport_options</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
    <span class=n>viewport2_options</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
    <span class=n>camera_options</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>

    <span class=c1># Straight key-value match from settings to capture arguments</span>
    <span class=n>options</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;Codec&quot;</span><span class=p>])</span>
    <span class=n>options</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;Generic&quot;</span><span class=p>])</span>
    <span class=n>options</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;Resolution&quot;</span><span class=p>])</span>

    <span class=n>camera_options</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;CameraOptions&quot;</span><span class=p>])</span>
    <span class=n>viewport_options</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&quot;Renderer&quot;</span><span class=p>])</span>

    <span class=c1># DISPLAY OPTIONS</span>
    <span class=n>disp_options</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;DisplayOptions&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
        <span class=k>if</span> <span class=n>key</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;background&quot;</span><span class=p>):</span>
            <span class=c1># Convert background, backgroundTop, backgroundBottom colors</span>

            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
                <span class=c1># Ignore alpha + convert RGB to float</span>
                <span class=n>value</span> <span class=o>=</span> <span class=p>[</span>
                    <span class=nb>float</span><span class=p>(</span><span class=n>value</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>/</span> <span class=mi>255</span><span class=p>,</span>
                    <span class=nb>float</span><span class=p>(</span><span class=n>value</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=mi>255</span><span class=p>,</span>
                    <span class=nb>float</span><span class=p>(</span><span class=n>value</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>/</span> <span class=mi>255</span>
                <span class=p>]</span>
            <span class=n>disp_options</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
        <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=s2>&quot;displayGradient&quot;</span><span class=p>:</span>
            <span class=n>disp_options</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

    <span class=n>options</span><span class=p>[</span><span class=s2>&quot;display_options&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>disp_options</span>

    <span class=c1># Viewport Options has a mixture of Viewport2 Options and Viewport Options</span>
    <span class=c1># to pass along to capture. So we&#39;ll need to differentiate between the two</span>
    <span class=n>VIEWPORT2_OPTIONS</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;textureMaxResolution&quot;</span><span class=p>,</span>
        <span class=s2>&quot;renderDepthOfField&quot;</span><span class=p>,</span>
        <span class=s2>&quot;ssaoEnable&quot;</span><span class=p>,</span>
        <span class=s2>&quot;ssaoSamples&quot;</span><span class=p>,</span>
        <span class=s2>&quot;ssaoAmount&quot;</span><span class=p>,</span>
        <span class=s2>&quot;ssaoRadius&quot;</span><span class=p>,</span>
        <span class=s2>&quot;ssaoFilterRadius&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogStart&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogEnd&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogAlpha&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogFalloff&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogColorR&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogColorG&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogColorB&quot;</span><span class=p>,</span>
        <span class=s2>&quot;hwFogDensity&quot;</span><span class=p>,</span>
        <span class=s2>&quot;motionBlurEnable&quot;</span><span class=p>,</span>
        <span class=s2>&quot;motionBlurSampleCount&quot;</span><span class=p>,</span>
        <span class=s2>&quot;motionBlurShutterOpenFraction&quot;</span><span class=p>,</span>
        <span class=s2>&quot;lineAAEnable&quot;</span>
    <span class=p>}</span>
    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;ViewportOptions&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>

        <span class=c1># There are some keys we want to ignore</span>
        <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=p>{</span><span class=s2>&quot;override_viewport_options&quot;</span><span class=p>,</span> <span class=s2>&quot;high_quality&quot;</span><span class=p>}:</span>
            <span class=k>continue</span>

        <span class=c1># First handle special cases where we do value conversion to</span>
        <span class=c1># separate option values</span>
        <span class=k>if</span> <span class=n>key</span> <span class=o>==</span> <span class=s1>&#39;textureMaxResolution&#39;</span><span class=p>:</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;textureMaxResolution&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
            <span class=k>if</span> <span class=n>value</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
                <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;enableTextureMaxRes&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
                <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;textureMaxResMode&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;enableTextureMaxRes&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
                <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;textureMaxResMode&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>

        <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=s1>&#39;multiSample&#39;</span><span class=p>:</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;multiSampleEnable&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span> <span class=o>&gt;</span> <span class=mi>0</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;multiSampleCount&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

        <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=s1>&#39;alphaCut&#39;</span><span class=p>:</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;transparencyAlgorithm&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;transparencyQuality&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>

        <span class=k>elif</span> <span class=n>key</span> <span class=o>==</span> <span class=s1>&#39;hwFogFalloff&#39;</span><span class=p>:</span>
            <span class=c1># Settings enum value string to integer</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=s1>&#39;hwFogFalloff&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>

        <span class=c1># Then handle Viewport 2.0 Options</span>
        <span class=k>elif</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>VIEWPORT2_OPTIONS</span><span class=p>:</span>
            <span class=n>viewport2_options</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

        <span class=c1># Then assume remainder is Viewport Options</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>viewport_options</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

    <span class=n>options</span><span class=p>[</span><span class=s1>&#39;viewport_options&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>viewport_options</span>
    <span class=n>options</span><span class=p>[</span><span class=s1>&#39;viewport2_options&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>viewport2_options</span>
    <span class=n>options</span><span class=p>[</span><span class=s1>&#39;camera_options&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>camera_options</span>

    <span class=c1># use active sound track</span>
    <span class=n>scene</span> <span class=o>=</span> <span class=n>capture</span><span class=o>.</span><span class=n>parse_active_scene</span><span class=p>()</span>
    <span class=n>options</span><span class=p>[</span><span class=s1>&#39;sound&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>scene</span><span class=p>[</span><span class=s1>&#39;sound&#39;</span><span class=p>]</span>

    <span class=k>return</span> <span class=n>options</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.lsattr class="doc doc-heading"> <code class="highlight language-python"><span class=n>lsattr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return nodes matching <code>key</code> and <code>value</code></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attr</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of Maya attribute</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=object>object</span></code> </td> <td> <div class=doc-md-description> <p>Value of attribute. If none is provided, return all nodes with this attribute.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <p>lsattr("id", "myId") ["myNode"] lsattr("id") ["myNode", "myOtherNode"]</p> </blockquote> </blockquote> </details> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>734</span>
<span class=normal>735</span>
<span class=normal>736</span>
<span class=normal>737</span>
<span class=normal>738</span>
<span class=normal>739</span>
<span class=normal>740</span>
<span class=normal>741</span>
<span class=normal>742</span>
<span class=normal>743</span>
<span class=normal>744</span>
<span class=normal>745</span>
<span class=normal>746</span>
<span class=normal>747</span>
<span class=normal>748</span>
<span class=normal>749</span>
<span class=normal>750</span>
<span class=normal>751</span>
<span class=normal>752</span>
<span class=normal>753</span>
<span class=normal>754</span>
<span class=normal>755</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>lsattr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return nodes matching `key` and `value`</span>

<span class=sd>    Arguments:</span>
<span class=sd>        attr (str): Name of Maya attribute</span>
<span class=sd>        value (object, optional): Value of attribute. If none</span>
<span class=sd>            is provided, return all nodes with this attribute.</span>

<span class=sd>    Example:</span>
<span class=sd>        &gt;&gt; lsattr(&quot;id&quot;, &quot;myId&quot;)</span>
<span class=sd>        [&quot;myNode&quot;]</span>
<span class=sd>        &gt;&gt; lsattr(&quot;id&quot;)</span>
<span class=sd>        [&quot;myNode&quot;, &quot;myOtherNode&quot;]</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>if</span> <span class=n>value</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=s2>&quot;*.</span><span class=si>%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=n>attr</span><span class=p>,</span>
                       <span class=n>recursive</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                       <span class=n>objectsOnly</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                       <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>lsattrs</span><span class=p>({</span><span class=n>attr</span><span class=p>:</span> <span class=n>value</span><span class=p>})</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.lsattrs class="doc doc-heading"> <code class="highlight language-python"><span class=n>lsattrs</span><span class=p>(</span><span class=n>attrs</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return nodes with the given attribute(s).</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attrs</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Name and value pairs of expected matches</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <blockquote> <h3 id=client.ayon_maya.api.lib.lsattrs--return-nodes-with-an-age-of-five>Return nodes with an <code>age</code> of five.</h3> <p>lsattrs({"age": "five"})</p> <h3 id=client.ayon_maya.api.lib.lsattrs--return-nodes-with-both-age-and-color-of-five-and-blue>Return nodes with both <code>age</code> and <code>color</code> of five and blue.</h3> <p>lsattrs({"age": "five", "color": "blue"})</p> </blockquote> </blockquote> </blockquote> </details> <details class=return open> <summary>Return</summary> <p>list: matching nodes.</p> </details> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>758</span>
<span class=normal>759</span>
<span class=normal>760</span>
<span class=normal>761</span>
<span class=normal>762</span>
<span class=normal>763</span>
<span class=normal>764</span>
<span class=normal>765</span>
<span class=normal>766</span>
<span class=normal>767</span>
<span class=normal>768</span>
<span class=normal>769</span>
<span class=normal>770</span>
<span class=normal>771</span>
<span class=normal>772</span>
<span class=normal>773</span>
<span class=normal>774</span>
<span class=normal>775</span>
<span class=normal>776</span>
<span class=normal>777</span>
<span class=normal>778</span>
<span class=normal>779</span>
<span class=normal>780</span>
<span class=normal>781</span>
<span class=normal>782</span>
<span class=normal>783</span>
<span class=normal>784</span>
<span class=normal>785</span>
<span class=normal>786</span>
<span class=normal>787</span>
<span class=normal>788</span>
<span class=normal>789</span>
<span class=normal>790</span>
<span class=normal>791</span>
<span class=normal>792</span>
<span class=normal>793</span>
<span class=normal>794</span>
<span class=normal>795</span>
<span class=normal>796</span>
<span class=normal>797</span>
<span class=normal>798</span>
<span class=normal>799</span>
<span class=normal>800</span>
<span class=normal>801</span>
<span class=normal>802</span>
<span class=normal>803</span>
<span class=normal>804</span>
<span class=normal>805</span>
<span class=normal>806</span>
<span class=normal>807</span>
<span class=normal>808</span>
<span class=normal>809</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>lsattrs</span><span class=p>(</span><span class=n>attrs</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return nodes with the given attribute(s).</span>

<span class=sd>    Arguments:</span>
<span class=sd>        attrs (dict): Name and value pairs of expected matches</span>

<span class=sd>    Example:</span>
<span class=sd>        &gt;&gt;&gt; # Return nodes with an `age` of five.</span>
<span class=sd>        &gt;&gt;&gt; lsattrs({&quot;age&quot;: &quot;five&quot;})</span>
<span class=sd>        &gt;&gt;&gt; # Return nodes with both `age` and `color` of five and blue.</span>
<span class=sd>        &gt;&gt;&gt; lsattrs({&quot;age&quot;: &quot;five&quot;, &quot;color&quot;: &quot;blue&quot;})</span>

<span class=sd>    Return:</span>
<span class=sd>         list: matching nodes.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>dep_fn</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDependencyNode</span><span class=p>()</span>
    <span class=n>dag_fn</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFnDagNode</span><span class=p>()</span>
    <span class=n>selection_list</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MSelectionList</span><span class=p>()</span>

    <span class=n>first_attr</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span><span class=nb>iter</span><span class=p>(</span><span class=n>attrs</span><span class=p>))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>selection_list</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s2>&quot;*.</span><span class=si>{0}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>first_attr</span><span class=p>),</span>
                           <span class=n>searchChildNamespaces</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>RuntimeError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
        <span class=k>if</span> <span class=nb>str</span><span class=p>(</span><span class=n>exc</span><span class=p>)</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;Object does not exist&quot;</span><span class=p>):</span>
            <span class=k>return</span> <span class=p>[]</span>

    <span class=n>matches</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>selection_list</span><span class=o>.</span><span class=n>length</span><span class=p>()):</span>
        <span class=n>node</span> <span class=o>=</span> <span class=n>selection_list</span><span class=o>.</span><span class=n>getDependNode</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>node</span><span class=o>.</span><span class=n>hasFn</span><span class=p>(</span><span class=n>OpenMaya</span><span class=o>.</span><span class=n>MFn</span><span class=o>.</span><span class=n>kDagNode</span><span class=p>):</span>
            <span class=n>fn_node</span> <span class=o>=</span> <span class=n>dag_fn</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
            <span class=n>full_path_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>path</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span>
                               <span class=k>for</span> <span class=n>path</span> <span class=ow>in</span> <span class=n>fn_node</span><span class=o>.</span><span class=n>getAllPaths</span><span class=p>()]</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>fn_node</span> <span class=o>=</span> <span class=n>dep_fn</span><span class=o>.</span><span class=n>setObject</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
            <span class=n>full_path_names</span> <span class=o>=</span> <span class=p>[</span><span class=n>fn_node</span><span class=o>.</span><span class=n>name</span><span class=p>()]</span>

        <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>attrs</span><span class=p>:</span>
            <span class=k>try</span><span class=p>:</span>
                <span class=n>plug</span> <span class=o>=</span> <span class=n>fn_node</span><span class=o>.</span><span class=n>findPlug</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>
                <span class=k>if</span> <span class=n>plug</span><span class=o>.</span><span class=n>asString</span><span class=p>()</span> <span class=o>!=</span> <span class=n>attrs</span><span class=p>[</span><span class=n>attr</span><span class=p>]:</span>
                    <span class=k>break</span>
            <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
                <span class=k>break</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>matches</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>full_path_names</span><span class=p>)</span>

    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>matches</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.maintained_selection class="doc doc-heading"> <code class="highlight language-python"><span class=n>maintained_selection</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Maintain selection during context</p> <details class=example open> <summary>Example</summary> <blockquote> <blockquote> <blockquote> <p>scene = cmds.file(new=True, force=True) node = cmds.createNode("transform", name="Test") cmds.select("persp") with maintained_selection(): ... cmds.select("Test", replace=True) "Test" in cmds.ls(selection=True) False</p> </blockquote> </blockquote> </blockquote> </details> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>maintained_selection</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Maintain selection during context</span>

<span class=sd>    Example:</span>
<span class=sd>        &gt;&gt;&gt; scene = cmds.file(new=True, force=True)</span>
<span class=sd>        &gt;&gt;&gt; node = cmds.createNode(&quot;transform&quot;, name=&quot;Test&quot;)</span>
<span class=sd>        &gt;&gt;&gt; cmds.select(&quot;persp&quot;)</span>
<span class=sd>        &gt;&gt;&gt; with maintained_selection():</span>
<span class=sd>        ...     cmds.select(&quot;Test&quot;, replace=True)</span>
<span class=sd>        &gt;&gt;&gt; &quot;Test&quot; in cmds.ls(selection=True)</span>
<span class=sd>        False</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>previous_selection</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>selection</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>previous_selection</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>previous_selection</span><span class=p>,</span>
                        <span class=n>replace</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                        <span class=n>noExpand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>clear</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.maintained_selection_api class="doc doc-heading"> <code class="highlight language-python"><span class=n>maintained_selection_api</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Maintain selection using the Maya Python API.</p> <p>Warning: This is <em>not</em> added to the undo stack.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1237</span>
<span class=normal>1238</span>
<span class=normal>1239</span>
<span class=normal>1240</span>
<span class=normal>1241</span>
<span class=normal>1242</span>
<span class=normal>1243</span>
<span class=normal>1244</span>
<span class=normal>1245</span>
<span class=normal>1246</span>
<span class=normal>1247</span>
<span class=normal>1248</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>maintained_selection_api</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Maintain selection using the Maya Python API.</span>

<span class=sd>    Warning: This is *not* added to the undo stack.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>original</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MGlobal</span><span class=o>.</span><span class=n>getActiveSelectionList</span><span class=p>()</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MGlobal</span><span class=o>.</span><span class=n>setActiveSelectionList</span><span class=p>(</span><span class=n>original</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.material_loading_mode class="doc doc-heading"> <code class="highlight language-python"><span class=n>material_loading_mode</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s1>&#39;immediate&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set material loading mode during context</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>382</span>
<span class=normal>383</span>
<span class=normal>384</span>
<span class=normal>385</span>
<span class=normal>386</span>
<span class=normal>387</span>
<span class=normal>388</span>
<span class=normal>389</span>
<span class=normal>390</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>material_loading_mode</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;immediate&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set material loading mode during context&quot;&quot;&quot;</span>
    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>displayPref</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>materialLoadingMode</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>displayPref</span><span class=p>(</span><span class=n>materialLoadingMode</span><span class=o>=</span><span class=n>mode</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>displayPref</span><span class=p>(</span><span class=n>materialLoadingMode</span><span class=o>=</span><span class=n>original</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.matrix_equals class="doc doc-heading"> <code class="highlight language-python"><span class=n>matrix_equals</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mf>1e-10</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Compares two matrices with an imperfection tolerance</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>a</code> </td> <td> <code>(<span title=list>list</span>, <span title=tuple>tuple</span>)</code> </td> <td> <div class=doc-md-description> <p>the matrix to check</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>b</code> </td> <td> <code>(<span title=list>list</span>, <span title=tuple>tuple</span>)</code> </td> <td> <div class=doc-md-description> <p>the matrix to check against</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>tolerance</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>the precision of the differences</p> </div> </td> <td> <code>1e-10</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> </td> <td> <div class=doc-md-description> <p>True or False</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>575</span>
<span class=normal>576</span>
<span class=normal>577</span>
<span class=normal>578</span>
<span class=normal>579</span>
<span class=normal>580</span>
<span class=normal>581</span>
<span class=normal>582</span>
<span class=normal>583</span>
<span class=normal>584</span>
<span class=normal>585</span>
<span class=normal>586</span>
<span class=normal>587</span>
<span class=normal>588</span>
<span class=normal>589</span>
<span class=normal>590</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>matrix_equals</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>tolerance</span><span class=o>=</span><span class=mf>1e-10</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    Compares two matrices with an imperfection tolerance</span>

<span class=sd>    Args:</span>
<span class=sd>        a (list, tuple): the matrix to check</span>
<span class=sd>        b (list, tuple): the matrix to check against</span>
<span class=sd>        tolerance (float): the precision of the differences</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool : True or False</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>(</span><span class=nb>abs</span><span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>y</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>tolerance</span> <span class=k>for</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>)):</span>
        <span class=k>return</span> <span class=kc>False</span>
    <span class=k>return</span> <span class=kc>True</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.namespaced class="doc doc-heading"> <code class="highlight language-python"><span class=n>namespaced</span><span class=p>(</span><span class=n>namespace</span><span class=p>,</span> <span class=n>new</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>relative_names</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Work inside namespace during context</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>new</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>When enabled this will rename the namespace to a unique namespace if the input namespace already exists.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Yields:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>The namespace that is used during the context</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1209</span>
<span class=normal>1210</span>
<span class=normal>1211</span>
<span class=normal>1212</span>
<span class=normal>1213</span>
<span class=normal>1214</span>
<span class=normal>1215</span>
<span class=normal>1216</span>
<span class=normal>1217</span>
<span class=normal>1218</span>
<span class=normal>1219</span>
<span class=normal>1220</span>
<span class=normal>1221</span>
<span class=normal>1222</span>
<span class=normal>1223</span>
<span class=normal>1224</span>
<span class=normal>1225</span>
<span class=normal>1226</span>
<span class=normal>1227</span>
<span class=normal>1228</span>
<span class=normal>1229</span>
<span class=normal>1230</span>
<span class=normal>1231</span>
<span class=normal>1232</span>
<span class=normal>1233</span>
<span class=normal>1234</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>namespaced</span><span class=p>(</span><span class=n>namespace</span><span class=p>,</span> <span class=n>new</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>relative_names</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Work inside namespace during context</span>

<span class=sd>    Args:</span>
<span class=sd>        new (bool): When enabled this will rename the namespace to a unique</span>
<span class=sd>            namespace if the input namespace already exists.</span>

<span class=sd>    Yields:</span>
<span class=sd>        str: The namespace that is used during the context</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>namespaceInfo</span><span class=p>(</span><span class=n>cur</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>absoluteName</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>original_relative_names</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>relativeNames</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>new</span><span class=p>:</span>
        <span class=n>namespace</span> <span class=o>=</span> <span class=n>unique_namespace</span><span class=p>(</span><span class=n>namespace</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=n>add</span><span class=o>=</span><span class=n>namespace</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>relative_names</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=n>relativeNames</span><span class=o>=</span><span class=n>relative_names</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=nb>set</span><span class=o>=</span><span class=n>namespace</span><span class=p>)</span>
        <span class=k>yield</span> <span class=n>namespace</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=nb>set</span><span class=o>=</span><span class=n>original</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>relative_names</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=n>relativeNames</span><span class=o>=</span><span class=n>original_relative_names</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.no_display_layers class="doc doc-heading"> <code class="highlight language-python"><span class=n>no_display_layers</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Ensure nodes are not in a displayLayer during context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodes</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>The nodes to remove from any display layer.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1166</span>
<span class=normal>1167</span>
<span class=normal>1168</span>
<span class=normal>1169</span>
<span class=normal>1170</span>
<span class=normal>1171</span>
<span class=normal>1172</span>
<span class=normal>1173</span>
<span class=normal>1174</span>
<span class=normal>1175</span>
<span class=normal>1176</span>
<span class=normal>1177</span>
<span class=normal>1178</span>
<span class=normal>1179</span>
<span class=normal>1180</span>
<span class=normal>1181</span>
<span class=normal>1182</span>
<span class=normal>1183</span>
<span class=normal>1184</span>
<span class=normal>1185</span>
<span class=normal>1186</span>
<span class=normal>1187</span>
<span class=normal>1188</span>
<span class=normal>1189</span>
<span class=normal>1190</span>
<span class=normal>1191</span>
<span class=normal>1192</span>
<span class=normal>1193</span>
<span class=normal>1194</span>
<span class=normal>1195</span>
<span class=normal>1196</span>
<span class=normal>1197</span>
<span class=normal>1198</span>
<span class=normal>1199</span>
<span class=normal>1200</span>
<span class=normal>1201</span>
<span class=normal>1202</span>
<span class=normal>1203</span>
<span class=normal>1204</span>
<span class=normal>1205</span>
<span class=normal>1206</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>no_display_layers</span><span class=p>(</span><span class=n>nodes</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Ensure nodes are not in a displayLayer during context.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        nodes (list): The nodes to remove from any display layer.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Ensure long names</span>
    <span class=n>nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># Get the original state</span>
    <span class=n>lookup</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>nodes</span><span class=p>)</span>
    <span class=n>original</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>for</span> <span class=n>layer</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=s1>&#39;displayLayer&#39;</span><span class=p>):</span>

        <span class=c1># Skip default layer</span>
        <span class=k>if</span> <span class=n>layer</span> <span class=o>==</span> <span class=s2>&quot;defaultLayer&quot;</span><span class=p>:</span>
            <span class=k>continue</span>

        <span class=n>members</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>editDisplayLayerMembers</span><span class=p>(</span><span class=n>layer</span><span class=p>,</span>
                                               <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                               <span class=n>fullNames</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>members</span><span class=p>:</span>
            <span class=k>continue</span>
        <span class=n>members</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>members</span><span class=p>)</span>

        <span class=n>included</span> <span class=o>=</span> <span class=n>lookup</span><span class=o>.</span><span class=n>intersection</span><span class=p>(</span><span class=n>members</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>included</span><span class=p>:</span>
            <span class=n>original</span><span class=p>[</span><span class=n>layer</span><span class=p>]</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>included</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=c1># Add all nodes to default layer</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>editDisplayLayerMembers</span><span class=p>(</span><span class=s2>&quot;defaultLayer&quot;</span><span class=p>,</span> <span class=n>nodes</span><span class=p>,</span> <span class=n>noRecurse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=c1># Restore original members</span>
        <span class=n>_iteritems</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>original</span><span class=p>,</span> <span class=s2>&quot;iteritems&quot;</span><span class=p>,</span> <span class=n>original</span><span class=o>.</span><span class=n>items</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>layer</span><span class=p>,</span> <span class=n>members</span> <span class=ow>in</span> <span class=n>_iteritems</span><span class=p>():</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>editDisplayLayerMembers</span><span class=p>(</span><span class=n>layer</span><span class=p>,</span> <span class=n>members</span><span class=p>,</span> <span class=n>noRecurse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.no_undo class="doc doc-heading"> <code class="highlight language-python"><span class=n>no_undo</span><span class=p>(</span><span class=n>flush</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Disable the undo queue during the context</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>flush</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>When True the undo queue will be emptied when returning from the context losing all undo history. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1000</span>
<span class=normal>1001</span>
<span class=normal>1002</span>
<span class=normal>1003</span>
<span class=normal>1004</span>
<span class=normal>1005</span>
<span class=normal>1006</span>
<span class=normal>1007</span>
<span class=normal>1008</span>
<span class=normal>1009</span>
<span class=normal>1010</span>
<span class=normal>1011</span>
<span class=normal>1012</span>
<span class=normal>1013</span>
<span class=normal>1014</span>
<span class=normal>1015</span>
<span class=normal>1016</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>no_undo</span><span class=p>(</span><span class=n>flush</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Disable the undo queue during the context</span>

<span class=sd>    Arguments:</span>
<span class=sd>        flush (bool): When True the undo queue will be emptied when returning</span>
<span class=sd>            from the context losing all undo history. Defaults to False.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>undoInfo</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>state</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>keyword</span> <span class=o>=</span> <span class=s1>&#39;state&#39;</span> <span class=k>if</span> <span class=n>flush</span> <span class=k>else</span> <span class=s1>&#39;stateWithoutFlush&#39;</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>undoInfo</span><span class=p>(</span><span class=o>**</span><span class=p>{</span><span class=n>keyword</span><span class=p>:</span> <span class=kc>False</span><span class=p>})</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>undoInfo</span><span class=p>(</span><span class=o>**</span><span class=p>{</span><span class=n>keyword</span><span class=p>:</span> <span class=n>original</span><span class=p>})</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.nodetype_exists class="doc doc-heading"> <code class="highlight language-python"><span class=n>nodetype_exists</span><span class=p>(</span><span class=n>nodetype</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return whether node type exists in the current Maya session.</p> <p>This returns whether it's registered as a node type to maya, it does not check whether it exists in the current scene.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>nodetype</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The node type name to check for existence.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>True if the node type exists, False otherwise.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4683</span>
<span class=normal>4684</span>
<span class=normal>4685</span>
<span class=normal>4686</span>
<span class=normal>4687</span>
<span class=normal>4688</span>
<span class=normal>4689</span>
<span class=normal>4690</span>
<span class=normal>4691</span>
<span class=normal>4692</span>
<span class=normal>4693</span>
<span class=normal>4694</span>
<span class=normal>4695</span>
<span class=normal>4696</span>
<span class=normal>4697</span>
<span class=normal>4698</span>
<span class=normal>4699</span>
<span class=normal>4700</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>nodetype_exists</span><span class=p>(</span><span class=n>nodetype</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return whether node type exists in the current Maya session.</span>

<span class=sd>    This returns whether it&#39;s registered as a node type to maya, it does not</span>
<span class=sd>    check whether it exists in the current scene.</span>

<span class=sd>    Args:</span>
<span class=sd>        nodetype (str): The node type name to check for existence.</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: True if the node type exists, False otherwise.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># If the node type does not exist, Maya will raise a RuntimeError.</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>nodeType</span><span class=p>(</span><span class=n>nodetype</span><span class=p>,</span> <span class=n>isTypeName</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>return</span> <span class=kc>True</span>
    <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
        <span class=k>return</span> <span class=kc>False</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.pairwise class="doc doc-heading"> <code class="highlight language-python"><span class=n>pairwise</span><span class=p>(</span><span class=n>iterable</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>s -&gt; (s0,s1), (s2,s3), (s4, s5), ...</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>597</span>
<span class=normal>598</span>
<span class=normal>599</span>
<span class=normal>600</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>pairwise</span><span class=p>(</span><span class=n>iterable</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;s -&gt; (s0,s1), (s2,s3), (s4, s5), ...&quot;&quot;&quot;</span>
    <span class=n>a</span> <span class=o>=</span> <span class=nb>iter</span><span class=p>(</span><span class=n>iterable</span><span class=p>)</span>
    <span class=k>return</span> <span class=nb>zip</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.panel_camera class="doc doc-heading"> <code class="highlight language-python"><span class=n>panel_camera</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>camera</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set modelPanel's camera during the context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>panel</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>modelPanel name.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>camera</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>camera name.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>panel_camera</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>camera</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set modelPanel&#39;s camera during the context.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        panel (str): modelPanel name.</span>
<span class=sd>        camera (str): camera name.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>original_camera</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>modelPanel</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>camera</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>modelPanel</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>camera</span><span class=o>=</span><span class=n>camera</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>modelPanel</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>camera</span><span class=o>=</span><span class=n>original_camera</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.parent_nodes class="doc doc-heading"> <code class="highlight language-python"><span class=n>parent_nodes</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>parent</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Context manager to un-parent provided nodes and return them back.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3564</span>
<span class=normal>3565</span>
<span class=normal>3566</span>
<span class=normal>3567</span>
<span class=normal>3568</span>
<span class=normal>3569</span>
<span class=normal>3570</span>
<span class=normal>3571</span>
<span class=normal>3572</span>
<span class=normal>3573</span>
<span class=normal>3574</span>
<span class=normal>3575</span>
<span class=normal>3576</span>
<span class=normal>3577</span>
<span class=normal>3578</span>
<span class=normal>3579</span>
<span class=normal>3580</span>
<span class=normal>3581</span>
<span class=normal>3582</span>
<span class=normal>3583</span>
<span class=normal>3584</span>
<span class=normal>3585</span>
<span class=normal>3586</span>
<span class=normal>3587</span>
<span class=normal>3588</span>
<span class=normal>3589</span>
<span class=normal>3590</span>
<span class=normal>3591</span>
<span class=normal>3592</span>
<span class=normal>3593</span>
<span class=normal>3594</span>
<span class=normal>3595</span>
<span class=normal>3596</span>
<span class=normal>3597</span>
<span class=normal>3598</span>
<span class=normal>3599</span>
<span class=normal>3600</span>
<span class=normal>3601</span>
<span class=normal>3602</span>
<span class=normal>3603</span>
<span class=normal>3604</span>
<span class=normal>3605</span>
<span class=normal>3606</span>
<span class=normal>3607</span>
<span class=normal>3608</span>
<span class=normal>3609</span>
<span class=normal>3610</span>
<span class=normal>3611</span>
<span class=normal>3612</span>
<span class=normal>3613</span>
<span class=normal>3614</span>
<span class=normal>3615</span>
<span class=normal>3616</span>
<span class=normal>3617</span>
<span class=normal>3618</span>
<span class=normal>3619</span>
<span class=normal>3620</span>
<span class=normal>3621</span>
<span class=normal>3622</span>
<span class=normal>3623</span>
<span class=normal>3624</span>
<span class=normal>3625</span>
<span class=normal>3626</span>
<span class=normal>3627</span>
<span class=normal>3628</span>
<span class=normal>3629</span>
<span class=normal>3630</span>
<span class=normal>3631</span>
<span class=normal>3632</span>
<span class=normal>3633</span>
<span class=normal>3634</span>
<span class=normal>3635</span>
<span class=normal>3636</span>
<span class=normal>3637</span>
<span class=normal>3638</span>
<span class=normal>3639</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>parent_nodes</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>parent</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
    <span class=c1># type: (list, str) -&gt; list</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Context manager to un-parent provided nodes and return them back.&quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>_as_mdagpath</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Return MDagPath for node path.&quot;&quot;&quot;</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>node</span><span class=p>:</span>
            <span class=k>return</span>
        <span class=n>sel</span> <span class=o>=</span> <span class=n>OpenMaya</span><span class=o>.</span><span class=n>MSelectionList</span><span class=p>()</span>
        <span class=n>sel</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=k>return</span> <span class=n>sel</span><span class=o>.</span><span class=n>getDagPath</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>

    <span class=c1># We can only parent dag nodes so we ensure input contains only dag nodes</span>
    <span class=n>nodes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;dagNode&quot;</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=c1># opt-out early</span>
        <span class=k>yield</span>
        <span class=k>return</span>

    <span class=n>parent_node_path</span> <span class=o>=</span> <span class=kc>None</span>
    <span class=n>delete_parent</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=k>if</span> <span class=n>parent</span><span class=p>:</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objExists</span><span class=p>(</span><span class=n>parent</span><span class=p>):</span>
            <span class=n>parent_node</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>createNode</span><span class=p>(</span><span class=s2>&quot;transform&quot;</span><span class=p>,</span>
                                          <span class=n>name</span><span class=o>=</span><span class=n>parent</span><span class=p>,</span>
                                          <span class=n>skipSelect</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
            <span class=n>delete_parent</span> <span class=o>=</span> <span class=kc>True</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>parent_node</span> <span class=o>=</span> <span class=n>parent</span>
        <span class=n>parent_node_path</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>parent_node</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

    <span class=c1># Store original parents</span>
    <span class=n>node_parents</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>nodes</span><span class=p>:</span>
        <span class=n>node_parent</span> <span class=o>=</span> <span class=n>get_node_parent</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=n>node_parents</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>_as_mdagpath</span><span class=p>(</span><span class=n>node</span><span class=p>),</span> <span class=n>_as_mdagpath</span><span class=p>(</span><span class=n>node_parent</span><span class=p>)))</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>node_parent</span> <span class=ow>in</span> <span class=n>node_parents</span><span class=p>:</span>
            <span class=n>node_parent_path</span> <span class=o>=</span> <span class=n>node_parent</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span> <span class=k>if</span> <span class=n>node_parent</span> <span class=k>else</span> <span class=kc>None</span>  <span class=c1># noqa</span>
            <span class=k>if</span> <span class=n>node_parent_path</span> <span class=o>==</span> <span class=n>parent_node_path</span><span class=p>:</span>
                <span class=c1># Already a child</span>
                <span class=k>continue</span>

            <span class=k>if</span> <span class=n>parent_node_path</span><span class=p>:</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>parent</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>(),</span> <span class=n>parent_node_path</span><span class=p>)</span>
            <span class=k>else</span><span class=p>:</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>parent</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>(),</span> <span class=n>world</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=c1># Reparent to original parents</span>
        <span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>original_parent</span> <span class=ow>in</span> <span class=n>node_parents</span><span class=p>:</span>
            <span class=n>node_path</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>node_path</span><span class=p>:</span>
                <span class=c1># Node must have been deleted</span>
                <span class=k>continue</span>

            <span class=n>node_parent_path</span> <span class=o>=</span> <span class=n>get_node_parent</span><span class=p>(</span><span class=n>node_path</span><span class=p>)</span>

            <span class=n>original_parent_path</span> <span class=o>=</span> <span class=kc>None</span>
            <span class=k>if</span> <span class=n>original_parent</span><span class=p>:</span>
                <span class=n>original_parent_path</span> <span class=o>=</span> <span class=n>original_parent</span><span class=o>.</span><span class=n>fullPathName</span><span class=p>()</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>original_parent_path</span><span class=p>:</span>
                    <span class=c1># Original parent node must have been deleted</span>
                    <span class=k>continue</span>

            <span class=k>if</span> <span class=n>node_parent_path</span> <span class=o>!=</span> <span class=n>original_parent_path</span><span class=p>:</span>
                <span class=k>if</span> <span class=ow>not</span> <span class=n>original_parent_path</span><span class=p>:</span>
                    <span class=n>cmds</span><span class=o>.</span><span class=n>parent</span><span class=p>(</span><span class=n>node_path</span><span class=p>,</span> <span class=n>world</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                <span class=k>else</span><span class=p>:</span>
                    <span class=n>cmds</span><span class=o>.</span><span class=n>parent</span><span class=p>(</span><span class=n>node_path</span><span class=p>,</span> <span class=n>original_parent_path</span><span class=p>)</span>

        <span class=k>if</span> <span class=n>delete_parent</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>parent_node_path</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.polyConstraint class="doc doc-heading"> <code class="highlight language-python"><span class=n>polyConstraint</span><span class=p>(</span><span class=n>components</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return the list of <em>components</em> with the constraints applied.</p> <p>A wrapper around Maya's <code>polySelectConstraint</code> to retrieve its results as a list without altering selections. For a list of possible constraints see <code>maya.cmds.polySelectConstraint</code> documentation.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>components</code> </td> <td> <code><span title=list>list</span></code> </td> <td> <div class=doc-md-description> <p>List of components of polygon meshes</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>The list of components filtered by the given constraints.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1264</span>
<span class=normal>1265</span>
<span class=normal>1266</span>
<span class=normal>1267</span>
<span class=normal>1268</span>
<span class=normal>1269</span>
<span class=normal>1270</span>
<span class=normal>1271</span>
<span class=normal>1272</span>
<span class=normal>1273</span>
<span class=normal>1274</span>
<span class=normal>1275</span>
<span class=normal>1276</span>
<span class=normal>1277</span>
<span class=normal>1278</span>
<span class=normal>1279</span>
<span class=normal>1280</span>
<span class=normal>1281</span>
<span class=normal>1282</span>
<span class=normal>1283</span>
<span class=normal>1284</span>
<span class=normal>1285</span>
<span class=normal>1286</span>
<span class=normal>1287</span>
<span class=normal>1288</span>
<span class=normal>1289</span>
<span class=normal>1290</span>
<span class=normal>1291</span>
<span class=normal>1292</span>
<span class=normal>1293</span>
<span class=normal>1294</span>
<span class=normal>1295</span>
<span class=normal>1296</span>
<span class=normal>1297</span>
<span class=normal>1298</span>
<span class=normal>1299</span>
<span class=normal>1300</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>polyConstraint</span><span class=p>(</span><span class=n>components</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return the list of *components* with the constraints applied.</span>

<span class=sd>    A wrapper around Maya&#39;s `polySelectConstraint` to retrieve its results as</span>
<span class=sd>    a list without altering selections. For a list of possible constraints</span>
<span class=sd>    see `maya.cmds.polySelectConstraint` documentation.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        components (list): List of components of polygon meshes</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: The list of components filtered by the given constraints.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>kwargs</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;mode&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>

    <span class=k>with</span> <span class=n>no_undo</span><span class=p>(</span><span class=n>flush</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
        <span class=c1># Reverting selection to the original selection using</span>
        <span class=c1># `maya.cmds.select` can be slow in rare cases where previously</span>
        <span class=c1># `maya.cmds.polySelectConstraint` had set constrain to &quot;All and Next&quot;</span>
        <span class=c1># and the &quot;Random&quot; setting was activated. To work around this we</span>
        <span class=c1># revert to the original selection using the Maya API. This is safe</span>
        <span class=c1># since we&#39;re not generating any undo change anyway.</span>
        <span class=k>with</span> <span class=n>tool</span><span class=p>(</span><span class=s2>&quot;selectSuperContext&quot;</span><span class=p>):</span>
            <span class=c1># Selection can be very slow when in a manipulator mode.</span>
            <span class=c1># So we force the selection context which is fast.</span>
            <span class=k>with</span> <span class=n>maintained_selection_api</span><span class=p>():</span>
                <span class=c1># Apply constraint using mode=2 (current and next) so</span>
                <span class=c1># it applies to the selection made before it; because just</span>
                <span class=c1># a `maya.cmds.select()` call will not trigger the constraint.</span>
                <span class=k>with</span> <span class=n>reset_polySelectConstraint</span><span class=p>():</span>
                    <span class=n>cmds</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>components</span><span class=p>,</span> <span class=n>r</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>noExpand</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                    <span class=n>cmds</span><span class=o>.</span><span class=n>polySelectConstraint</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
                    <span class=n>result</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>selection</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                    <span class=n>cmds</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>clear</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
                    <span class=k>return</span> <span class=n>result</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.prompt_reset_context class="doc doc-heading"> <code class="highlight language-python"><span class=n>prompt_reset_context</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Prompt the user what context settings to reset. This prompt is used on saving to a different task to allow the scene to get matched to the new context.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2814</span>
<span class=normal>2815</span>
<span class=normal>2816</span>
<span class=normal>2817</span>
<span class=normal>2818</span>
<span class=normal>2819</span>
<span class=normal>2820</span>
<span class=normal>2821</span>
<span class=normal>2822</span>
<span class=normal>2823</span>
<span class=normal>2824</span>
<span class=normal>2825</span>
<span class=normal>2826</span>
<span class=normal>2827</span>
<span class=normal>2828</span>
<span class=normal>2829</span>
<span class=normal>2830</span>
<span class=normal>2831</span>
<span class=normal>2832</span>
<span class=normal>2833</span>
<span class=normal>2834</span>
<span class=normal>2835</span>
<span class=normal>2836</span>
<span class=normal>2837</span>
<span class=normal>2838</span>
<span class=normal>2839</span>
<span class=normal>2840</span>
<span class=normal>2841</span>
<span class=normal>2842</span>
<span class=normal>2843</span>
<span class=normal>2844</span>
<span class=normal>2845</span>
<span class=normal>2846</span>
<span class=normal>2847</span>
<span class=normal>2848</span>
<span class=normal>2849</span>
<span class=normal>2850</span>
<span class=normal>2851</span>
<span class=normal>2852</span>
<span class=normal>2853</span>
<span class=normal>2854</span>
<span class=normal>2855</span>
<span class=normal>2856</span>
<span class=normal>2857</span>
<span class=normal>2858</span>
<span class=normal>2859</span>
<span class=normal>2860</span>
<span class=normal>2861</span>
<span class=normal>2862</span>
<span class=normal>2863</span>
<span class=normal>2864</span>
<span class=normal>2865</span>
<span class=normal>2866</span>
<span class=normal>2867</span>
<span class=normal>2868</span>
<span class=normal>2869</span>
<span class=normal>2870</span>
<span class=normal>2871</span>
<span class=normal>2872</span>
<span class=normal>2873</span>
<span class=normal>2874</span>
<span class=normal>2875</span>
<span class=normal>2876</span>
<span class=normal>2877</span>
<span class=normal>2878</span>
<span class=normal>2879</span>
<span class=normal>2880</span>
<span class=normal>2881</span>
<span class=normal>2882</span>
<span class=normal>2883</span>
<span class=normal>2884</span>
<span class=normal>2885</span>
<span class=normal>2886</span>
<span class=normal>2887</span>
<span class=normal>2888</span>
<span class=normal>2889</span>
<span class=normal>2890</span>
<span class=normal>2891</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>prompt_reset_context</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Prompt the user what context settings to reset.</span>
<span class=sd>    This prompt is used on saving to a different task to allow the scene to</span>
<span class=sd>    get matched to the new context.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># TODO: Cleanup this prototyped mess of imports and odd dialog</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>ayon_core.tools.attribute_defs.dialog</span><span class=w> </span><span class=kn>import</span> <span class=p>(</span>
        <span class=n>AttributeDefinitionsDialog</span>
    <span class=p>)</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>ayon_core.style</span><span class=w> </span><span class=kn>import</span> <span class=n>load_stylesheet</span>
    <span class=kn>from</span><span class=w> </span><span class=nn>ayon_core.lib</span><span class=w> </span><span class=kn>import</span> <span class=n>BoolDef</span><span class=p>,</span> <span class=n>UILabelDef</span>

    <span class=n>definitions</span> <span class=o>=</span> <span class=p>[</span>
        <span class=n>UILabelDef</span><span class=p>(</span>
            <span class=n>label</span><span class=o>=</span><span class=p>(</span>
                <span class=s2>&quot;You are saving your workfile into a different folder or task.&quot;</span>
                <span class=s2>&quot;</span><span class=se>\n\n</span><span class=s2>&quot;</span>
                <span class=s2>&quot;Would you like to update some settings to the new context?</span><span class=se>\n</span><span class=s2>&quot;</span>
            <span class=p>)</span>
        <span class=p>),</span>
        <span class=n>BoolDef</span><span class=p>(</span>
            <span class=s2>&quot;fps&quot;</span><span class=p>,</span>
            <span class=n>label</span><span class=o>=</span><span class=s2>&quot;FPS&quot;</span><span class=p>,</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;Reset workfile FPS&quot;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=n>BoolDef</span><span class=p>(</span>
            <span class=s2>&quot;frame_range&quot;</span><span class=p>,</span>
            <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Frame Range&quot;</span><span class=p>,</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;Reset workfile start and end frame ranges&quot;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=n>BoolDef</span><span class=p>(</span>
            <span class=s2>&quot;resolution&quot;</span><span class=p>,</span>
            <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Resolution&quot;</span><span class=p>,</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;Reset workfile resolution&quot;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=n>BoolDef</span><span class=p>(</span>
            <span class=s2>&quot;colorspace&quot;</span><span class=p>,</span>
            <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Colorspace&quot;</span><span class=p>,</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;Reset workfile resolution&quot;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=n>BoolDef</span><span class=p>(</span>
            <span class=s2>&quot;scene_units&quot;</span><span class=p>,</span>
            <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Scene Units&quot;</span><span class=p>,</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;Reset Workfile Linear and Angular Scale Unit&quot;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
        <span class=n>BoolDef</span><span class=p>(</span>
            <span class=s2>&quot;instances&quot;</span><span class=p>,</span>
            <span class=n>label</span><span class=o>=</span><span class=s2>&quot;Publish instances&quot;</span><span class=p>,</span>
            <span class=n>tooltip</span><span class=o>=</span><span class=s2>&quot;Update all publish instance&#39;s folder and task to match &quot;</span>
                    <span class=s2>&quot;the new folder and task&quot;</span><span class=p>,</span>
            <span class=n>default</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>),</span>
    <span class=p>]</span>

    <span class=n>dialog</span> <span class=o>=</span> <span class=n>AttributeDefinitionsDialog</span><span class=p>(</span><span class=n>definitions</span><span class=p>)</span>
    <span class=n>dialog</span><span class=o>.</span><span class=n>setWindowTitle</span><span class=p>(</span><span class=s2>&quot;Saving to different context.&quot;</span><span class=p>)</span>
    <span class=n>dialog</span><span class=o>.</span><span class=n>setStyleSheet</span><span class=p>(</span><span class=n>load_stylesheet</span><span class=p>())</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>dialog</span><span class=o>.</span><span class=n>exec_</span><span class=p>():</span>
        <span class=k>return</span> <span class=kc>None</span>

    <span class=n>options</span> <span class=o>=</span> <span class=n>dialog</span><span class=o>.</span><span class=n>get_values</span><span class=p>()</span>
    <span class=k>with</span> <span class=n>suspended_refresh</span><span class=p>():</span>
        <span class=n>set_context_settings</span><span class=p>(</span>
            <span class=n>fps</span><span class=o>=</span><span class=n>options</span><span class=p>[</span><span class=s2>&quot;fps&quot;</span><span class=p>],</span>
            <span class=n>resolution</span><span class=o>=</span><span class=n>options</span><span class=p>[</span><span class=s2>&quot;resolution&quot;</span><span class=p>],</span>
            <span class=n>frame_range</span><span class=o>=</span><span class=n>options</span><span class=p>[</span><span class=s2>&quot;frame_range&quot;</span><span class=p>],</span>
            <span class=n>colorspace</span><span class=o>=</span><span class=n>options</span><span class=p>[</span><span class=s2>&quot;colorspace&quot;</span><span class=p>],</span>
            <span class=n>scene_units</span><span class=o>=</span><span class=n>options</span><span class=p>[</span><span class=s2>&quot;scene_units&quot;</span><span class=p>]</span>
        <span class=p>)</span>
        <span class=k>if</span> <span class=n>options</span><span class=p>[</span><span class=s2>&quot;instances&quot;</span><span class=p>]:</span>
            <span class=n>update_content_on_context_change</span><span class=p>()</span>

    <span class=n>dialog</span><span class=o>.</span><span class=n>deleteLater</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.read class="doc doc-heading"> <code class="highlight language-python"><span class=n>read</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return user-defined attributes from <code>node</code></p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>545</span>
<span class=normal>546</span>
<span class=normal>547</span>
<span class=normal>548</span>
<span class=normal>549</span>
<span class=normal>550</span>
<span class=normal>551</span>
<span class=normal>552</span>
<span class=normal>553</span>
<span class=normal>554</span>
<span class=normal>555</span>
<span class=normal>556</span>
<span class=normal>557</span>
<span class=normal>558</span>
<span class=normal>559</span>
<span class=normal>560</span>
<span class=normal>561</span>
<span class=normal>562</span>
<span class=normal>563</span>
<span class=normal>564</span>
<span class=normal>565</span>
<span class=normal>566</span>
<span class=normal>567</span>
<span class=normal>568</span>
<span class=normal>569</span>
<span class=normal>570</span>
<span class=normal>571</span>
<span class=normal>572</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>read</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return user-defined attributes from `node`&quot;&quot;&quot;</span>

    <span class=n>data</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>

    <span class=k>for</span> <span class=n>attr</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listAttr</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>userDefined</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>list</span><span class=p>():</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=n>node</span> <span class=o>+</span> <span class=s2>&quot;.&quot;</span> <span class=o>+</span> <span class=n>attr</span><span class=p>,</span> <span class=n>asString</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

        <span class=k>except</span> <span class=ne>RuntimeError</span><span class=p>:</span>
            <span class=c1># For Message type attribute or others that have connections,</span>
            <span class=c1># take source node name as value.</span>
            <span class=n>source</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>listConnections</span><span class=p>(</span><span class=n>node</span> <span class=o>+</span> <span class=s2>&quot;.&quot;</span> <span class=o>+</span> <span class=n>attr</span><span class=p>,</span>
                                          <span class=n>source</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                          <span class=n>destination</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
            <span class=n>source</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span> <span class=ow>or</span> <span class=p>[</span><span class=kc>None</span><span class=p>]</span>
            <span class=n>value</span> <span class=o>=</span> <span class=n>source</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>

        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
            <span class=c1># Some attributes cannot be read directly,</span>
            <span class=c1># such as mesh and color attributes. These</span>
            <span class=c1># are considered non-essential to this</span>
            <span class=c1># particular publishing pipeline.</span>
            <span class=n>value</span> <span class=o>=</span> <span class=kc>None</span>

        <span class=n>data</span><span class=p>[</span><span class=n>attr</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>

    <span class=k>return</span> <span class=n>data</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.reload_all_udim_tile_previews class="doc doc-heading"> <code class="highlight language-python"><span class=n>reload_all_udim_tile_previews</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Regenerate all UDIM tile preview in texture file</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reload_all_udim_tile_previews</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Regenerate all UDIM tile preview in texture file&quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>texture_file</span> <span class=ow>in</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=nb>type</span><span class=o>=</span><span class=s2>&quot;file&quot;</span><span class=p>):</span>
        <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.uvTilingMode&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>texture_file</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>ogs</span><span class=p>(</span><span class=n>regenerateUVTilePreview</span><span class=o>=</span><span class=n>texture_file</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.remove_other_uv_sets class="doc doc-heading"> <code class="highlight language-python"><span class=n>remove_other_uv_sets</span><span class=p>(</span><span class=n>mesh</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Remove all other UV sets than the current UV set.</p> <p>Keep only current UV set and ensure it's the renamed to default 'map1'.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2326</span>
<span class=normal>2327</span>
<span class=normal>2328</span>
<span class=normal>2329</span>
<span class=normal>2330</span>
<span class=normal>2331</span>
<span class=normal>2332</span>
<span class=normal>2333</span>
<span class=normal>2334</span>
<span class=normal>2335</span>
<span class=normal>2336</span>
<span class=normal>2337</span>
<span class=normal>2338</span>
<span class=normal>2339</span>
<span class=normal>2340</span>
<span class=normal>2341</span>
<span class=normal>2342</span>
<span class=normal>2343</span>
<span class=normal>2344</span>
<span class=normal>2345</span>
<span class=normal>2346</span>
<span class=normal>2347</span>
<span class=normal>2348</span>
<span class=normal>2349</span>
<span class=normal>2350</span>
<span class=normal>2351</span>
<span class=normal>2352</span>
<span class=normal>2353</span>
<span class=normal>2354</span>
<span class=normal>2355</span>
<span class=normal>2356</span>
<span class=normal>2357</span>
<span class=normal>2358</span>
<span class=normal>2359</span>
<span class=normal>2360</span>
<span class=normal>2361</span>
<span class=normal>2362</span>
<span class=normal>2363</span>
<span class=normal>2364</span>
<span class=normal>2365</span>
<span class=normal>2366</span>
<span class=normal>2367</span>
<span class=normal>2368</span>
<span class=normal>2369</span>
<span class=normal>2370</span>
<span class=normal>2371</span>
<span class=normal>2372</span>
<span class=normal>2373</span>
<span class=normal>2374</span>
<span class=normal>2375</span>
<span class=normal>2376</span>
<span class=normal>2377</span>
<span class=normal>2378</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>remove_other_uv_sets</span><span class=p>(</span><span class=n>mesh</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Remove all other UV sets than the current UV set.</span>

<span class=sd>    Keep only current UV set and ensure it&#39;s the renamed to default &#39;map1&#39;.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>uvSets</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>polyUVSet</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>allUVSets</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>current</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>polyUVSet</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>currentUVSet</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>

    <span class=c1># Copy over to map1</span>
    <span class=k>if</span> <span class=n>current</span> <span class=o>!=</span> <span class=s1>&#39;map1&#39;</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>polyUVSet</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>uvSet</span><span class=o>=</span><span class=n>current</span><span class=p>,</span> <span class=n>newUVSet</span><span class=o>=</span><span class=s1>&#39;map1&#39;</span><span class=p>,</span> <span class=n>copy</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>polyUVSet</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>currentUVSet</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>uvSet</span><span class=o>=</span><span class=s1>&#39;map1&#39;</span><span class=p>)</span>
        <span class=n>current</span> <span class=o>=</span> <span class=s1>&#39;map1&#39;</span>

    <span class=c1># Delete all non-current UV sets</span>
    <span class=n>deleteUVSets</span> <span class=o>=</span> <span class=p>[</span><span class=n>uvSet</span> <span class=k>for</span> <span class=n>uvSet</span> <span class=ow>in</span> <span class=n>uvSets</span> <span class=k>if</span> <span class=n>uvSet</span> <span class=o>!=</span> <span class=n>current</span><span class=p>]</span>
    <span class=n>uvSet</span> <span class=o>=</span> <span class=kc>None</span>

    <span class=c1># Maya Bug (tested in 2015/2016):</span>
    <span class=c1># In some cases the API&#39;s MFnMesh will report less UV sets than</span>
    <span class=c1># maya.cmds.polyUVSet. This seems to happen when the deletion of UV sets</span>
    <span class=c1># has not triggered a cleanup of the UVSet array attribute on the mesh</span>
    <span class=c1># node. It will still have extra entries in the attribute, though it will</span>
    <span class=c1># not show up in API or UI. Nevertheless it does show up in</span>
    <span class=c1># maya.cmds.polyUVSet. To ensure we clean up the array we&#39;ll force delete</span>
    <span class=c1># the extra remaining &#39;indices&#39; that we don&#39;t want.</span>

    <span class=c1># TODO: Implement a better fix</span>
    <span class=c1># The best way to fix would be to get the UVSet indices from api with</span>
    <span class=c1># MFnMesh (to ensure we keep correct ones) and then only force delete the</span>
    <span class=c1># other entries in the array attribute on the node. But for now we&#39;re</span>
    <span class=c1># deleting all entries except first one. Note that the first entry could</span>
    <span class=c1># never be removed (the default &#39;map1&#39; always exists and is supposed to</span>
    <span class=c1># be undeletable.)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>uvSet</span> <span class=ow>in</span> <span class=n>deleteUVSets</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>polyUVSet</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>delete</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>uvSet</span><span class=o>=</span><span class=n>uvSet</span><span class=p>)</span>
    <span class=k>except</span> <span class=ne>RuntimeError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s1>&#39;Error uvSet: </span><span class=si>%s</span><span class=s1> - </span><span class=si>%s</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>uvSet</span><span class=p>,</span> <span class=n>exc</span><span class=p>)</span>
        <span class=n>indices</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s1>&#39;</span><span class=si>{0}</span><span class=s1>.uvSet&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>mesh</span><span class=p>),</span>
                               <span class=n>multiIndices</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>indices</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&quot;No uv set found indices for: </span><span class=si>%s</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>mesh</span><span class=p>)</span>
            <span class=k>return</span>

        <span class=c1># Delete from end to avoid shifting indices</span>
        <span class=c1># and remove the indices in the attribute</span>
        <span class=n>indices</span> <span class=o>=</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>indices</span><span class=p>[</span><span class=mi>1</span><span class=p>:])</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>indices</span><span class=p>:</span>
            <span class=n>attr</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=si>{0}</span><span class=s1>.uvSet[</span><span class=si>{1}</span><span class=s1>]&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>mesh</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>removeMultiInstance</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>b</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.render_capture_preset class="doc doc-heading"> <code class="highlight language-python"><span class=n>render_capture_preset</span><span class=p>(</span><span class=n>preset</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Capture playblast with a preset.</p> <p>To generate the preset use <code>generate_capture_preset</code>.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>preset</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>preset options</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>Output path of <code>capture.capture</code></p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span>
<span class=normal>228</span>
<span class=normal>229</span>
<span class=normal>230</span>
<span class=normal>231</span>
<span class=normal>232</span>
<span class=normal>233</span>
<span class=normal>234</span>
<span class=normal>235</span>
<span class=normal>236</span>
<span class=normal>237</span>
<span class=normal>238</span>
<span class=normal>239</span>
<span class=normal>240</span>
<span class=normal>241</span>
<span class=normal>242</span>
<span class=normal>243</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>render_capture_preset</span><span class=p>(</span><span class=n>preset</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Capture playblast with a preset.</span>

<span class=sd>    To generate the preset use `generate_capture_preset`.</span>

<span class=sd>    Args:</span>
<span class=sd>        preset (dict): preset options</span>

<span class=sd>    Returns:</span>
<span class=sd>        str: Output path of `capture.capture`</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Force a refresh at the start of the timeline</span>
    <span class=c1># TODO (Question): Why do we need to do this? What bug does it solve?</span>
    <span class=c1>#   Is this for simulations?</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>refresh</span><span class=p>(</span><span class=n>force</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>refresh_frame_int</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>minTime</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>refresh_frame_int</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>refresh_frame_int</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span>
        <span class=s2>&quot;Using preset: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>preset</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>sort_keys</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=p>)</span>
    <span class=p>)</span>
    <span class=n>preset</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>preset</span><span class=p>)</span>
    <span class=c1># not supported by `capture` so we pop it off of the preset</span>
    <span class=n>reload_textures</span> <span class=o>=</span> <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;viewport_options&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;loadTextures&quot;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>
    <span class=n>panel</span> <span class=o>=</span> <span class=n>preset</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&quot;panel&quot;</span><span class=p>)</span>
    <span class=k>with</span> <span class=n>contextlib</span><span class=o>.</span><span class=n>ExitStack</span><span class=p>()</span> <span class=k>as</span> <span class=n>stack</span><span class=p>:</span>
        <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>maintained_time</span><span class=p>())</span>
        <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>panel_camera</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;camera&quot;</span><span class=p>]))</span>
        <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>viewport_default_options</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>preset</span><span class=p>))</span>
        <span class=k>if</span> <span class=n>reload_textures</span><span class=p>:</span>
            <span class=c1># Force immediate texture loading when to ensure</span>
            <span class=c1># all textures have loaded before the playblast starts</span>
            <span class=n>stack</span><span class=o>.</span><span class=n>enter_context</span><span class=p>(</span><span class=n>material_loading_mode</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=s2>&quot;immediate&quot;</span><span class=p>))</span>
            <span class=c1># Regenerate all UDIM tiles previews</span>
            <span class=n>reload_all_udim_tile_previews</span><span class=p>()</span>
        <span class=n>path</span> <span class=o>=</span> <span class=n>capture</span><span class=o>.</span><span class=n>capture</span><span class=p>(</span><span class=n>log</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>log</span><span class=p>,</span> <span class=o>**</span><span class=n>preset</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>path</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.renderlayer class="doc doc-heading"> <code class="highlight language-python"><span class=n>renderlayer</span><span class=p>(</span><span class=n>layer</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set the renderlayer during the context</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>layer</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of layer to switch to.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>932</span>
<span class=normal>933</span>
<span class=normal>934</span>
<span class=normal>935</span>
<span class=normal>936</span>
<span class=normal>937</span>
<span class=normal>938</span>
<span class=normal>939</span>
<span class=normal>940</span>
<span class=normal>941</span>
<span class=normal>942</span>
<span class=normal>943</span>
<span class=normal>944</span>
<span class=normal>945</span>
<span class=normal>946</span>
<span class=normal>947</span>
<span class=normal>948</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>renderlayer</span><span class=p>(</span><span class=n>layer</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the renderlayer during the context</span>

<span class=sd>    Arguments:</span>
<span class=sd>        layer (str): Name of layer to switch to.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>editRenderLayerGlobals</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                           <span class=n>currentRenderLayer</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>editRenderLayerGlobals</span><span class=p>(</span><span class=n>currentRenderLayer</span><span class=o>=</span><span class=n>layer</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>editRenderLayerGlobals</span><span class=p>(</span><span class=n>currentRenderLayer</span><span class=o>=</span><span class=n>original</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.reset_frame_range class="doc doc-heading"> <code class="highlight language-python"><span class=n>reset_frame_range</span><span class=p>(</span><span class=n>playback</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>render</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>fps</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set frame range to current folder.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>playback</code> </td> <td> <code>(<span title=bool>bool</span>, <span title=Optional>Optional</span>)</code> </td> <td> <div class=doc-md-description> <p>Whether to set the maya timeline playback frame range. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>render</code> </td> <td> <code>(<span title=bool>bool</span>, <span title=Optional>Optional</span>)</code> </td> <td> <div class=doc-md-description> <p>Whether to set the maya render frame range. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>fps</code> </td> <td> <code>(<span title=bool>bool</span>, <span title=Optional>Optional</span>)</code> </td> <td> <div class=doc-md-description> <p>Whether to set scene FPS. Defaults to True.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>task_entity</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Task entity to use. If not provided, the current task entity is used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> <tr class=doc-section-item> <td> <code>project_settings</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Project settings to use. If not provided, the current project settings are used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2685</span>
<span class=normal>2686</span>
<span class=normal>2687</span>
<span class=normal>2688</span>
<span class=normal>2689</span>
<span class=normal>2690</span>
<span class=normal>2691</span>
<span class=normal>2692</span>
<span class=normal>2693</span>
<span class=normal>2694</span>
<span class=normal>2695</span>
<span class=normal>2696</span>
<span class=normal>2697</span>
<span class=normal>2698</span>
<span class=normal>2699</span>
<span class=normal>2700</span>
<span class=normal>2701</span>
<span class=normal>2702</span>
<span class=normal>2703</span>
<span class=normal>2704</span>
<span class=normal>2705</span>
<span class=normal>2706</span>
<span class=normal>2707</span>
<span class=normal>2708</span>
<span class=normal>2709</span>
<span class=normal>2710</span>
<span class=normal>2711</span>
<span class=normal>2712</span>
<span class=normal>2713</span>
<span class=normal>2714</span>
<span class=normal>2715</span>
<span class=normal>2716</span>
<span class=normal>2717</span>
<span class=normal>2718</span>
<span class=normal>2719</span>
<span class=normal>2720</span>
<span class=normal>2721</span>
<span class=normal>2722</span>
<span class=normal>2723</span>
<span class=normal>2724</span>
<span class=normal>2725</span>
<span class=normal>2726</span>
<span class=normal>2727</span>
<span class=normal>2728</span>
<span class=normal>2729</span>
<span class=normal>2730</span>
<span class=normal>2731</span>
<span class=normal>2732</span>
<span class=normal>2733</span>
<span class=normal>2734</span>
<span class=normal>2735</span>
<span class=normal>2736</span>
<span class=normal>2737</span>
<span class=normal>2738</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reset_frame_range</span><span class=p>(</span>
    <span class=n>playback</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>render</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>fps</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
    <span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
    <span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set frame range to current folder.</span>

<span class=sd>    Args:</span>
<span class=sd>        playback (bool, Optional): Whether to set the maya timeline playback</span>
<span class=sd>            frame range. Defaults to True.</span>
<span class=sd>        render (bool, Optional): Whether to set the maya render frame range.</span>
<span class=sd>            Defaults to True.</span>
<span class=sd>        fps (bool, Optional): Whether to set scene FPS. Defaults to True.</span>
<span class=sd>        task_entity (dict, optional): Task entity to use.</span>
<span class=sd>            If not provided, the current task entity is used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>
<span class=sd>        project_settings (dict, optional): Project settings to use.</span>
<span class=sd>            If not provided, the current project settings are used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>fps</span><span class=p>:</span>
        <span class=n>set_scene_fps</span><span class=p>(</span><span class=n>get_fps_for_current_context</span><span class=p>(</span><span class=n>task_entity</span><span class=p>))</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>playback</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>render</span><span class=p>:</span>
        <span class=k>return</span>

    <span class=n>frame_range</span> <span class=o>=</span> <span class=n>get_frame_range</span><span class=p>(</span>
        <span class=n>include_animation_range</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>project_settings</span><span class=o>=</span><span class=n>project_settings</span><span class=p>,</span>
        <span class=n>task_entity</span><span class=o>=</span><span class=n>task_entity</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>frame_range</span><span class=p>:</span>
        <span class=c1># No frame range data found for folder</span>
        <span class=k>return</span>

    <span class=n>frame_start</span> <span class=o>=</span> <span class=n>frame_range</span><span class=p>[</span><span class=s2>&quot;frameStart&quot;</span><span class=p>]</span>
    <span class=n>frame_end</span> <span class=o>=</span> <span class=n>frame_range</span><span class=p>[</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>]</span>
    <span class=n>animation_start</span> <span class=o>=</span> <span class=n>frame_range</span><span class=p>[</span><span class=s2>&quot;animationStart&quot;</span><span class=p>]</span>
    <span class=n>animation_end</span> <span class=o>=</span> <span class=n>frame_range</span><span class=p>[</span><span class=s2>&quot;animationEnd&quot;</span><span class=p>]</span>

    <span class=k>if</span> <span class=n>playback</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span>
            <span class=n>minTime</span><span class=o>=</span><span class=n>frame_start</span><span class=p>,</span>
            <span class=n>maxTime</span><span class=o>=</span><span class=n>frame_end</span><span class=p>,</span>
            <span class=n>animationStartTime</span><span class=o>=</span><span class=n>animation_start</span><span class=p>,</span>
            <span class=n>animationEndTime</span><span class=o>=</span><span class=n>animation_end</span>
        <span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>frame_start</span><span class=p>)</span>

    <span class=k>if</span> <span class=n>render</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=s2>&quot;defaultRenderGlobals.startFrame&quot;</span><span class=p>,</span> <span class=n>animation_start</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=s2>&quot;defaultRenderGlobals.endFrame&quot;</span><span class=p>,</span> <span class=n>animation_end</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.reset_polySelectConstraint class="doc doc-heading"> <code class="highlight language-python"><span class=n>reset_polySelectConstraint</span><span class=p>(</span><span class=n>reset</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Context during which the given polyConstraint settings are disabled.</p> <p>The original settings are restored after the context.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1303</span>
<span class=normal>1304</span>
<span class=normal>1305</span>
<span class=normal>1306</span>
<span class=normal>1307</span>
<span class=normal>1308</span>
<span class=normal>1309</span>
<span class=normal>1310</span>
<span class=normal>1311</span>
<span class=normal>1312</span>
<span class=normal>1313</span>
<span class=normal>1314</span>
<span class=normal>1315</span>
<span class=normal>1316</span>
<span class=normal>1317</span>
<span class=normal>1318</span>
<span class=normal>1319</span>
<span class=normal>1320</span>
<span class=normal>1321</span>
<span class=normal>1322</span>
<span class=normal>1323</span>
<span class=normal>1324</span>
<span class=normal>1325</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>reset_polySelectConstraint</span><span class=p>(</span><span class=n>reset</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Context during which the given polyConstraint settings are disabled.</span>

<span class=sd>    The original settings are restored after the context.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>polySelectConstraint</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stateString</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>reset</span><span class=p>:</span>
            <span class=c1># Ensure command is available in mel</span>
            <span class=c1># This can happen when running standalone</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s2>&quot;exists resetPolySelectConstraint&quot;</span><span class=p>):</span>
                <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s2>&quot;source polygonConstraint&quot;</span><span class=p>)</span>

            <span class=c1># Reset all parameters</span>
            <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s2>&quot;resetPolySelectConstraint;&quot;</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>polySelectConstraint</span><span class=p>(</span><span class=n>disable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=n>original</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.reset_scene_resolution class="doc doc-heading"> <code class="highlight language-python"><span class=n>reset_scene_resolution</span><span class=p>(</span><span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Apply the scene resolution from the project definition</p> <p>The scene resolution will be retrieved from the task entity.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>task_entity</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Task entity to use. If not provided, the current task entity is used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2741</span>
<span class=normal>2742</span>
<span class=normal>2743</span>
<span class=normal>2744</span>
<span class=normal>2745</span>
<span class=normal>2746</span>
<span class=normal>2747</span>
<span class=normal>2748</span>
<span class=normal>2749</span>
<span class=normal>2750</span>
<span class=normal>2751</span>
<span class=normal>2752</span>
<span class=normal>2753</span>
<span class=normal>2754</span>
<span class=normal>2755</span>
<span class=normal>2756</span>
<span class=normal>2757</span>
<span class=normal>2758</span>
<span class=normal>2759</span>
<span class=normal>2760</span>
<span class=normal>2761</span>
<span class=normal>2762</span>
<span class=normal>2763</span>
<span class=normal>2764</span>
<span class=normal>2765</span>
<span class=normal>2766</span>
<span class=normal>2767</span>
<span class=normal>2768</span>
<span class=normal>2769</span>
<span class=normal>2770</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>reset_scene_resolution</span><span class=p>(</span><span class=n>task_entity</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Apply the scene resolution  from the project definition</span>

<span class=sd>    The scene resolution will be retrieved from the task entity.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        task_entity (dict, optional): Task entity to use.</span>
<span class=sd>            If not provided, the current task entity is used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>task_entity</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>task_entity</span> <span class=o>=</span> <span class=n>get_current_task_entity</span><span class=p>(</span>
            <span class=n>fields</span><span class=o>=</span><span class=p>{</span>
                <span class=s2>&quot;attrib.resolutionWidth&quot;</span><span class=p>,</span>
                <span class=s2>&quot;attrib.resolutionHeight&quot;</span><span class=p>,</span>
                <span class=s2>&quot;attrib.pixelAspect&quot;</span><span class=p>,</span>
            <span class=p>}</span>
        <span class=p>)</span>

    <span class=n>task_attributes</span> <span class=o>=</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>]</span>

    <span class=c1># Set resolution</span>
    <span class=n>width</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;resolutionWidth&quot;</span><span class=p>,</span> <span class=mi>1920</span><span class=p>)</span>
    <span class=n>height</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;resolutionHeight&quot;</span><span class=p>,</span> <span class=mi>1080</span><span class=p>)</span>
    <span class=n>pixel_aspect</span> <span class=o>=</span> <span class=n>task_attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;pixelAspect&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>

    <span class=n>set_scene_resolution</span><span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>,</span> <span class=n>pixel_aspect</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.search_textures class="doc doc-heading"> <code class="highlight language-python"><span class=n>search_textures</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Search all texture files on disk.</p> <p>This also parses to full sequences for those with dynamic patterns like <udim> and %04d in the filename.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>filepath</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The full path to the file, including any dynamic patterns like <udim> or %04d</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>list</code></td> <td> </td> <td> <div class=doc-md-description> <p>The files found on disk</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4501</span>
<span class=normal>4502</span>
<span class=normal>4503</span>
<span class=normal>4504</span>
<span class=normal>4505</span>
<span class=normal>4506</span>
<span class=normal>4507</span>
<span class=normal>4508</span>
<span class=normal>4509</span>
<span class=normal>4510</span>
<span class=normal>4511</span>
<span class=normal>4512</span>
<span class=normal>4513</span>
<span class=normal>4514</span>
<span class=normal>4515</span>
<span class=normal>4516</span>
<span class=normal>4517</span>
<span class=normal>4518</span>
<span class=normal>4519</span>
<span class=normal>4520</span>
<span class=normal>4521</span>
<span class=normal>4522</span>
<span class=normal>4523</span>
<span class=normal>4524</span>
<span class=normal>4525</span>
<span class=normal>4526</span>
<span class=normal>4527</span>
<span class=normal>4528</span>
<span class=normal>4529</span>
<span class=normal>4530</span>
<span class=normal>4531</span>
<span class=normal>4532</span>
<span class=normal>4533</span>
<span class=normal>4534</span>
<span class=normal>4535</span>
<span class=normal>4536</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>search_textures</span><span class=p>(</span><span class=n>filepath</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Search all texture files on disk.</span>

<span class=sd>    This also parses to full sequences for those with dynamic patterns</span>
<span class=sd>    like &lt;UDIM&gt; and %04d in the filename.</span>

<span class=sd>    Args:</span>
<span class=sd>        filepath (str): The full path to the file, including any</span>
<span class=sd>            dynamic patterns like &lt;UDIM&gt; or %04d</span>

<span class=sd>    Returns:</span>
<span class=sd>        list: The files found on disk</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>filename</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>

    <span class=c1># Collect full sequence if it matches a sequence pattern</span>
    <span class=c1># For UDIM based textures (tiles)</span>
    <span class=k>if</span> <span class=s2>&quot;&lt;UDIM&gt;&quot;</span> <span class=ow>in</span> <span class=n>filename</span><span class=p>:</span>
        <span class=n>sequences</span> <span class=o>=</span> <span class=n>get_sequence</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span>
                                 <span class=n>pattern</span><span class=o>=</span><span class=s2>&quot;&lt;UDIM&gt;&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>sequences</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>sequences</span>

    <span class=c1># Frame/time - Based textures (animated masks f.e)</span>
    <span class=k>elif</span> <span class=s2>&quot;</span><span class=si>%04d</span><span class=s2>&quot;</span> <span class=ow>in</span> <span class=n>filename</span><span class=p>:</span>
        <span class=n>sequences</span> <span class=o>=</span> <span class=n>get_sequence</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span>
                                 <span class=n>pattern</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>%04d</span><span class=s2>&quot;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>sequences</span><span class=p>:</span>
            <span class=k>return</span> <span class=n>sequences</span>

    <span class=c1># Assuming it is a fixed name (single file)</span>
    <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>filepath</span><span class=p>):</span>
        <span class=k>return</span> <span class=p>[</span><span class=n>filepath</span><span class=p>]</span>

    <span class=k>return</span> <span class=p>[]</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_attribute class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_attribute</span><span class=p>(</span><span class=n>attribute</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Adjust attributes based on the value from the attribute data</p> <p>If an attribute does not exists on the target it will be added with the dataType being controlled by the value type.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>attribute</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name of the attribute to change</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value</code> </td> <td> </td> <td> <div class=doc-md-description> <p>the value to change to attribute to</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name of the node</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1752</span>
<span class=normal>1753</span>
<span class=normal>1754</span>
<span class=normal>1755</span>
<span class=normal>1756</span>
<span class=normal>1757</span>
<span class=normal>1758</span>
<span class=normal>1759</span>
<span class=normal>1760</span>
<span class=normal>1761</span>
<span class=normal>1762</span>
<span class=normal>1763</span>
<span class=normal>1764</span>
<span class=normal>1765</span>
<span class=normal>1766</span>
<span class=normal>1767</span>
<span class=normal>1768</span>
<span class=normal>1769</span>
<span class=normal>1770</span>
<span class=normal>1771</span>
<span class=normal>1772</span>
<span class=normal>1773</span>
<span class=normal>1774</span>
<span class=normal>1775</span>
<span class=normal>1776</span>
<span class=normal>1777</span>
<span class=normal>1778</span>
<span class=normal>1779</span>
<span class=normal>1780</span>
<span class=normal>1781</span>
<span class=normal>1782</span>
<span class=normal>1783</span>
<span class=normal>1784</span>
<span class=normal>1785</span>
<span class=normal>1786</span>
<span class=normal>1787</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_attribute</span><span class=p>(</span><span class=n>attribute</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Adjust attributes based on the value from the attribute data</span>

<span class=sd>    If an attribute does not exists on the target it will be added with</span>
<span class=sd>    the dataType being controlled by the value type.</span>

<span class=sd>    Args:</span>
<span class=sd>        attribute (str): name of the attribute to change</span>
<span class=sd>        value: the value to change to attribute to</span>
<span class=sd>        node (str): name of the node</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>value_type</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
    <span class=n>kwargs</span> <span class=o>=</span> <span class=n>ATTRIBUTE_DICT</span><span class=p>[</span><span class=n>value_type</span><span class=p>]</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=n>attribute</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
        <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Creating attribute &#39;</span><span class=si>{}</span><span class=s2>&#39; on &quot;</span>
                  <span class=s2>&quot;&#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>attribute</span><span class=p>,</span> <span class=n>node</span><span class=p>))</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>addAttr</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>longName</span><span class=o>=</span><span class=n>attribute</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>

    <span class=n>node_attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>attribute</span><span class=p>)</span>
    <span class=n>enum_type</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=n>attribute</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>enum</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>enum_type</span> <span class=ow>and</span> <span class=n>value_type</span> <span class=o>==</span> <span class=s2>&quot;str&quot;</span><span class=p>:</span>
        <span class=n>enum_string_values</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span>
            <span class=n>attribute</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>listEnum</span><span class=o>=</span><span class=kc>True</span>
        <span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span>
            <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>attribute</span><span class=p>),</span> <span class=n>enum_string_values</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
        <span class=p>)</span>
    <span class=k>elif</span> <span class=s2>&quot;dataType&quot;</span> <span class=ow>in</span> <span class=n>kwargs</span><span class=p>:</span>
        <span class=n>attr_type</span> <span class=o>=</span> <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;dataType&quot;</span><span class=p>]</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>node_attr</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=n>attr_type</span><span class=p>)</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>node_attr</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_colorspace class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_colorspace</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set Colorspace from project settings.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>project_settings</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Project settings to use. If not provided, the current project settings are used. This is mostly used for optimization purposes.</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3507</span>
<span class=normal>3508</span>
<span class=normal>3509</span>
<span class=normal>3510</span>
<span class=normal>3511</span>
<span class=normal>3512</span>
<span class=normal>3513</span>
<span class=normal>3514</span>
<span class=normal>3515</span>
<span class=normal>3516</span>
<span class=normal>3517</span>
<span class=normal>3518</span>
<span class=normal>3519</span>
<span class=normal>3520</span>
<span class=normal>3521</span>
<span class=normal>3522</span>
<span class=normal>3523</span>
<span class=normal>3524</span>
<span class=normal>3525</span>
<span class=normal>3526</span>
<span class=normal>3527</span>
<span class=normal>3528</span>
<span class=normal>3529</span>
<span class=normal>3530</span>
<span class=normal>3531</span>
<span class=normal>3532</span>
<span class=normal>3533</span>
<span class=normal>3534</span>
<span class=normal>3535</span>
<span class=normal>3536</span>
<span class=normal>3537</span>
<span class=normal>3538</span>
<span class=normal>3539</span>
<span class=normal>3540</span>
<span class=normal>3541</span>
<span class=normal>3542</span>
<span class=normal>3543</span>
<span class=normal>3544</span>
<span class=normal>3545</span>
<span class=normal>3546</span>
<span class=normal>3547</span>
<span class=normal>3548</span>
<span class=normal>3549</span>
<span class=normal>3550</span>
<span class=normal>3551</span>
<span class=normal>3552</span>
<span class=normal>3553</span>
<span class=normal>3554</span>
<span class=normal>3555</span>
<span class=normal>3556</span>
<span class=normal>3557</span>
<span class=normal>3558</span>
<span class=normal>3559</span>
<span class=normal>3560</span>
<span class=normal>3561</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_colorspace</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set Colorspace from project settings.</span>

<span class=sd>    Arguments:</span>
<span class=sd>        project_settings (dict, optional): Project settings to use.</span>
<span class=sd>            If not provided, the current project settings are used.</span>
<span class=sd>            This is mostly used for optimization purposes.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>project_settings</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
        <span class=n>project_settings</span> <span class=o>=</span> <span class=n>get_project_settings</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
    <span class=n>imageio</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=n>project_settings</span><span class=p>[</span><span class=s2>&quot;maya&quot;</span><span class=p>][</span><span class=s2>&quot;imageio&quot;</span><span class=p>]</span>

    <span class=k>if</span> <span class=ow>not</span> <span class=n>imageio</span><span class=p>[</span><span class=s2>&quot;workfile&quot;</span><span class=p>][</span><span class=s2>&quot;enabled&quot;</span><span class=p>]:</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
            <span class=s2>&quot;AYON Maya Color Management settings for workfile are disabled.&quot;</span>
        <span class=p>)</span>
        <span class=k>return</span>

    <span class=c1># set color spaces for rendering space and view transforms</span>
    <span class=k>def</span><span class=w> </span><span class=nf>_colormanage</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
<span class=w>        </span><span class=sd>&quot;&quot;&quot;Wrapper around `cmds.colorManagementPrefs`.</span>

<span class=sd>        This logs errors instead of raising an error so color management</span>
<span class=sd>        settings get applied as much as possible.</span>

<span class=sd>        &quot;&quot;&quot;</span>
        <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&quot;Must receive one keyword argument&quot;</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span><span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
            <span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&quot;Setting Color Management Preference: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>kwargs</span><span class=p>))</span>
        <span class=k>except</span> <span class=ne>RuntimeError</span> <span class=k>as</span> <span class=n>exc</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=n>exc</span><span class=p>)</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Setting Maya colorspace..&quot;</span><span class=p>)</span>

    <span class=c1># enable color management</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span><span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>cmEnabled</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span><span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>ocioRulesEnabled</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=n>is_ocio_set</span> <span class=o>=</span> <span class=nb>bool</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;OCIO&quot;</span><span class=p>))</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>is_ocio_set</span><span class=p>:</span>
        <span class=c1># Set the Maya 2022+ default OCIO v2 config file path</span>
        <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Setting default Maya OCIO v2 config&quot;</span><span class=p>)</span>
        <span class=c1># Note: Setting &quot;&quot; as value also sets this default however</span>
        <span class=c1># introduces a bug where launching a file on startup will prompt</span>
        <span class=c1># to save the empty scene before it, so we set using the path.</span>
        <span class=c1># This value has been the same for 2022, 2023 and 2024.</span>
        <span class=n>path</span> <span class=o>=</span> <span class=s2>&quot;&lt;MAYA_RESOURCES&gt;/OCIO-configs/Maya2022-default/config.ocio&quot;</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>colorManagementPrefs</span><span class=p>(</span><span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>configFilePath</span><span class=o>=</span><span class=n>path</span><span class=p>)</span>

    <span class=c1># set rendering space and view transform</span>
    <span class=n>_colormanage</span><span class=p>(</span><span class=n>renderingSpaceName</span><span class=o>=</span><span class=n>imageio</span><span class=p>[</span><span class=s2>&quot;workfile&quot;</span><span class=p>][</span><span class=s2>&quot;renderSpace&quot;</span><span class=p>])</span>
    <span class=n>_colormanage</span><span class=p>(</span><span class=n>viewName</span><span class=o>=</span><span class=n>imageio</span><span class=p>[</span><span class=s2>&quot;workfile&quot;</span><span class=p>][</span><span class=s2>&quot;viewName&quot;</span><span class=p>])</span>
    <span class=n>_colormanage</span><span class=p>(</span><span class=n>displayName</span><span class=o>=</span><span class=n>imageio</span><span class=p>[</span><span class=s2>&quot;workfile&quot;</span><span class=p>][</span><span class=s2>&quot;displayName&quot;</span><span class=p>])</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_context_settings class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_context_settings</span><span class=p>(</span><span class=n>fps</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>resolution</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>frame_range</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>colorspace</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>scene_units</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Apply the project settings from the project definition</p> <p>Settings can be overwritten by an asset if the asset.data contains any information regarding those settings.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>fps</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to set the scene FPS.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>resolution</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to set the render resolution.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>frame_range</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to reset the time slide frame ranges.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>colorspace</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to reset the colorspace.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>scene_units</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether to reset the scene units.</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2773</span>
<span class=normal>2774</span>
<span class=normal>2775</span>
<span class=normal>2776</span>
<span class=normal>2777</span>
<span class=normal>2778</span>
<span class=normal>2779</span>
<span class=normal>2780</span>
<span class=normal>2781</span>
<span class=normal>2782</span>
<span class=normal>2783</span>
<span class=normal>2784</span>
<span class=normal>2785</span>
<span class=normal>2786</span>
<span class=normal>2787</span>
<span class=normal>2788</span>
<span class=normal>2789</span>
<span class=normal>2790</span>
<span class=normal>2791</span>
<span class=normal>2792</span>
<span class=normal>2793</span>
<span class=normal>2794</span>
<span class=normal>2795</span>
<span class=normal>2796</span>
<span class=normal>2797</span>
<span class=normal>2798</span>
<span class=normal>2799</span>
<span class=normal>2800</span>
<span class=normal>2801</span>
<span class=normal>2802</span>
<span class=normal>2803</span>
<span class=normal>2804</span>
<span class=normal>2805</span>
<span class=normal>2806</span>
<span class=normal>2807</span>
<span class=normal>2808</span>
<span class=normal>2809</span>
<span class=normal>2810</span>
<span class=normal>2811</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_context_settings</span><span class=p>(</span>
        <span class=n>fps</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>resolution</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>frame_range</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>colorspace</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=n>scene_units</span><span class=o>=</span><span class=kc>True</span>
<span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Apply the project settings from the project definition</span>

<span class=sd>    Settings can be overwritten by an asset if the asset.data contains</span>
<span class=sd>    any information regarding those settings.</span>

<span class=sd>    Args:</span>
<span class=sd>        fps (bool): Whether to set the scene FPS.</span>
<span class=sd>        resolution (bool): Whether to set the render resolution.</span>
<span class=sd>        frame_range (bool): Whether to reset the time slide frame ranges.</span>
<span class=sd>        colorspace (bool): Whether to reset the colorspace.</span>
<span class=sd>        scene_units (bool): Whether to reset the scene units.</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>project_name</span> <span class=o>=</span> <span class=n>get_current_project_name</span><span class=p>()</span>
    <span class=n>project_settings</span> <span class=o>=</span> <span class=n>get_project_settings</span><span class=p>(</span><span class=n>project_name</span><span class=p>)</span>
    <span class=n>task_entity</span> <span class=o>=</span> <span class=n>get_current_task_entity</span><span class=p>()</span>
    <span class=n>reset_frame_range</span><span class=p>(</span>
        <span class=n>fps</span><span class=o>=</span><span class=n>fps</span><span class=p>,</span>
        <span class=n>playback</span><span class=o>=</span><span class=n>frame_range</span><span class=p>,</span>
        <span class=n>render</span><span class=o>=</span><span class=n>frame_range</span><span class=p>,</span>
        <span class=n>project_settings</span><span class=o>=</span><span class=n>project_settings</span><span class=p>,</span>
        <span class=n>task_entity</span><span class=o>=</span><span class=n>task_entity</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=n>resolution</span><span class=p>:</span>
        <span class=n>reset_scene_resolution</span><span class=p>(</span><span class=n>task_entity</span><span class=o>=</span><span class=n>task_entity</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>colorspace</span><span class=p>:</span>
        <span class=n>set_colorspace</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=n>project_settings</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>scene_units</span><span class=p>:</span>
        <span class=n>set_scene_units</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=n>project_settings</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_id class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_id</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>unique_id</span><span class=p>,</span> <span class=n>overwrite</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Add cbId to <code>node</code> unless one already exists.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the node to add the "cbId" on</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>unique_id</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The unique node id to assign. This should be generated by <code>generate_ids</code>.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>overwrite</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>When True overrides the current value even if <code>node</code> already has an id. Defaults to False.</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1660</span>
<span class=normal>1661</span>
<span class=normal>1662</span>
<span class=normal>1663</span>
<span class=normal>1664</span>
<span class=normal>1665</span>
<span class=normal>1666</span>
<span class=normal>1667</span>
<span class=normal>1668</span>
<span class=normal>1669</span>
<span class=normal>1670</span>
<span class=normal>1671</span>
<span class=normal>1672</span>
<span class=normal>1673</span>
<span class=normal>1674</span>
<span class=normal>1675</span>
<span class=normal>1676</span>
<span class=normal>1677</span>
<span class=normal>1678</span>
<span class=normal>1679</span>
<span class=normal>1680</span>
<span class=normal>1681</span>
<span class=normal>1682</span>
<span class=normal>1683</span>
<span class=normal>1684</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_id</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>unique_id</span><span class=p>,</span> <span class=n>overwrite</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Add cbId to `node` unless one already exists.</span>

<span class=sd>    Args:</span>
<span class=sd>        node (str): the node to add the &quot;cbId&quot; on</span>
<span class=sd>        unique_id (str): The unique node id to assign.</span>
<span class=sd>            This should be generated by `generate_ids`.</span>
<span class=sd>        overwrite (bool, optional): When True overrides the current value even</span>
<span class=sd>            if `node` already has an id. Defaults to False.</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>exists</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>attributeQuery</span><span class=p>(</span><span class=s2>&quot;cbId&quot;</span><span class=p>,</span> <span class=n>node</span><span class=o>=</span><span class=n>node</span><span class=p>,</span> <span class=n>exists</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># Add the attribute if it does not exist yet</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>exists</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>addAttr</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>longName</span><span class=o>=</span><span class=s2>&quot;cbId&quot;</span><span class=p>,</span> <span class=n>dataType</span><span class=o>=</span><span class=s2>&quot;string&quot;</span><span class=p>)</span>

    <span class=c1># Set the value</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>exists</span> <span class=ow>or</span> <span class=n>overwrite</span><span class=p>:</span>
        <span class=n>attr</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{0}</span><span class=s2>.cbId&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=n>attr</span><span class=p>,</span> <span class=n>unique_id</span><span class=p>,</span> <span class=nb>type</span><span class=o>=</span><span class=s2>&quot;string&quot;</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_scene_fps class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_scene_fps</span><span class=p>(</span><span class=n>fps</span><span class=p>,</span> <span class=n>update</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set FPS from project configuration</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>fps</code> </td> <td> <code>(<span title=int>int</span>, <span title=float>float</span>)</code> </td> <td> <div class=doc-md-description> <p>desired FPS</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>update</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>toggle update animation, default is True</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2478</span>
<span class=normal>2479</span>
<span class=normal>2480</span>
<span class=normal>2481</span>
<span class=normal>2482</span>
<span class=normal>2483</span>
<span class=normal>2484</span>
<span class=normal>2485</span>
<span class=normal>2486</span>
<span class=normal>2487</span>
<span class=normal>2488</span>
<span class=normal>2489</span>
<span class=normal>2490</span>
<span class=normal>2491</span>
<span class=normal>2492</span>
<span class=normal>2493</span>
<span class=normal>2494</span>
<span class=normal>2495</span>
<span class=normal>2496</span>
<span class=normal>2497</span>
<span class=normal>2498</span>
<span class=normal>2499</span>
<span class=normal>2500</span>
<span class=normal>2501</span>
<span class=normal>2502</span>
<span class=normal>2503</span>
<span class=normal>2504</span>
<span class=normal>2505</span>
<span class=normal>2506</span>
<span class=normal>2507</span>
<span class=normal>2508</span>
<span class=normal>2509</span>
<span class=normal>2510</span>
<span class=normal>2511</span>
<span class=normal>2512</span>
<span class=normal>2513</span>
<span class=normal>2514</span>
<span class=normal>2515</span>
<span class=normal>2516</span>
<span class=normal>2517</span>
<span class=normal>2518</span>
<span class=normal>2519</span>
<span class=normal>2520</span>
<span class=normal>2521</span>
<span class=normal>2522</span>
<span class=normal>2523</span>
<span class=normal>2524</span>
<span class=normal>2525</span>
<span class=normal>2526</span>
<span class=normal>2527</span>
<span class=normal>2528</span>
<span class=normal>2529</span>
<span class=normal>2530</span>
<span class=normal>2531</span>
<span class=normal>2532</span>
<span class=normal>2533</span>
<span class=normal>2534</span>
<span class=normal>2535</span>
<span class=normal>2536</span>
<span class=normal>2537</span>
<span class=normal>2538</span>
<span class=normal>2539</span>
<span class=normal>2540</span>
<span class=normal>2541</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_scene_fps</span><span class=p>(</span><span class=n>fps</span><span class=p>,</span> <span class=n>update</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set FPS from project configuration</span>

<span class=sd>    Args:</span>
<span class=sd>        fps (int, float): desired FPS</span>
<span class=sd>        update(bool): toggle update animation, default is True</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>fps_mapping</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s1>&#39;2&#39;</span><span class=p>:</span> <span class=s1>&#39;2fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;3&#39;</span><span class=p>:</span> <span class=s1>&#39;3fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;4&#39;</span><span class=p>:</span> <span class=s1>&#39;4fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;5&#39;</span><span class=p>:</span> <span class=s1>&#39;5fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;6&#39;</span><span class=p>:</span> <span class=s1>&#39;6fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;8&#39;</span><span class=p>:</span> <span class=s1>&#39;8fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;10&#39;</span><span class=p>:</span> <span class=s1>&#39;10fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;12&#39;</span><span class=p>:</span> <span class=s1>&#39;12fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;15&#39;</span><span class=p>:</span> <span class=s1>&#39;game&#39;</span><span class=p>,</span>
        <span class=s1>&#39;16&#39;</span><span class=p>:</span> <span class=s1>&#39;16fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;24&#39;</span><span class=p>:</span> <span class=s1>&#39;film&#39;</span><span class=p>,</span>
        <span class=s1>&#39;25&#39;</span><span class=p>:</span> <span class=s1>&#39;pal&#39;</span><span class=p>,</span>
        <span class=s1>&#39;30&#39;</span><span class=p>:</span> <span class=s1>&#39;ntsc&#39;</span><span class=p>,</span>
        <span class=s1>&#39;48&#39;</span><span class=p>:</span> <span class=s1>&#39;show&#39;</span><span class=p>,</span>
        <span class=s1>&#39;50&#39;</span><span class=p>:</span> <span class=s1>&#39;palf&#39;</span><span class=p>,</span>
        <span class=s1>&#39;60&#39;</span><span class=p>:</span> <span class=s1>&#39;ntscf&#39;</span><span class=p>,</span>
        <span class=s1>&#39;23.976023976023978&#39;</span><span class=p>:</span> <span class=s1>&#39;23.976fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;29.97002997002997&#39;</span><span class=p>:</span> <span class=s1>&#39;29.97fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;47.952047952047955&#39;</span><span class=p>:</span> <span class=s1>&#39;47.952fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;59.94005994005994&#39;</span><span class=p>:</span> <span class=s1>&#39;59.94fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;44100&#39;</span><span class=p>:</span> <span class=s1>&#39;44100fps&#39;</span><span class=p>,</span>
        <span class=s1>&#39;48000&#39;</span><span class=p>:</span> <span class=s1>&#39;48000fps&#39;</span>
    <span class=p>}</span>

    <span class=n>unit</span> <span class=o>=</span> <span class=n>fps_mapping</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>convert_to_maya_fps</span><span class=p>(</span><span class=n>fps</span><span class=p>)),</span> <span class=kc>None</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>unit</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Unsupported FPS value: `</span><span class=si>%s</span><span class=s2>`&quot;</span> <span class=o>%</span> <span class=n>fps</span><span class=p>)</span>

    <span class=c1># Get time slider current state</span>
    <span class=n>start_frame</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>minTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>end_frame</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>maxTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># Get animation data</span>
    <span class=n>animation_start</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>animationStartTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>animation_end</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>animationEndTime</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=n>current_frame</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Setting scene FPS to: &#39;</span><span class=si>{}</span><span class=s2>&#39;&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>unit</span><span class=p>))</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>currentUnit</span><span class=p>(</span><span class=n>time</span><span class=o>=</span><span class=n>unit</span><span class=p>,</span> <span class=n>updateAnimation</span><span class=o>=</span><span class=n>update</span><span class=p>)</span>

    <span class=c1># Set time slider data back to previous state</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>playbackOptions</span><span class=p>(</span><span class=n>minTime</span><span class=o>=</span><span class=n>start_frame</span><span class=p>,</span>
                         <span class=n>maxTime</span><span class=o>=</span><span class=n>end_frame</span><span class=p>,</span>
                         <span class=n>animationStartTime</span><span class=o>=</span><span class=n>animation_start</span><span class=p>,</span>
                         <span class=n>animationEndTime</span><span class=o>=</span><span class=n>animation_end</span><span class=p>)</span>

    <span class=n>cmds</span><span class=o>.</span><span class=n>currentTime</span><span class=p>(</span><span class=n>current_frame</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>update</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>

    <span class=c1># Force file stated to &#39;modified&#39;</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>file</span><span class=p>(</span><span class=n>modified</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_scene_resolution class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_scene_resolution</span><span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>,</span> <span class=n>pixel_aspect</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set the render resolution</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>width</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>resolution width</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>height</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>resolution height</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>pixel_aspect</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>pixel aspect ratio</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>None</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2544</span>
<span class=normal>2545</span>
<span class=normal>2546</span>
<span class=normal>2547</span>
<span class=normal>2548</span>
<span class=normal>2549</span>
<span class=normal>2550</span>
<span class=normal>2551</span>
<span class=normal>2552</span>
<span class=normal>2553</span>
<span class=normal>2554</span>
<span class=normal>2555</span>
<span class=normal>2556</span>
<span class=normal>2557</span>
<span class=normal>2558</span>
<span class=normal>2559</span>
<span class=normal>2560</span>
<span class=normal>2561</span>
<span class=normal>2562</span>
<span class=normal>2563</span>
<span class=normal>2564</span>
<span class=normal>2565</span>
<span class=normal>2566</span>
<span class=normal>2567</span>
<span class=normal>2568</span>
<span class=normal>2569</span>
<span class=normal>2570</span>
<span class=normal>2571</span>
<span class=normal>2572</span>
<span class=normal>2573</span>
<span class=normal>2574</span>
<span class=normal>2575</span>
<span class=normal>2576</span>
<span class=normal>2577</span>
<span class=normal>2578</span>
<span class=normal>2579</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_scene_resolution</span><span class=p>(</span><span class=n>width</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>height</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>pixel_aspect</span><span class=p>:</span> <span class=nb>float</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the render resolution</span>

<span class=sd>    Args:</span>
<span class=sd>        width (int): resolution width</span>
<span class=sd>        height (int): resolution height</span>
<span class=sd>        pixel_aspect (float): pixel aspect ratio</span>

<span class=sd>    Returns:</span>
<span class=sd>        None</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>control_node</span> <span class=o>=</span> <span class=s2>&quot;defaultResolution&quot;</span>
    <span class=n>current_renderer</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>getAttr</span><span class=p>(</span><span class=s2>&quot;defaultRenderGlobals.currentRenderer&quot;</span><span class=p>)</span>
    <span class=n>aspect_ratio_attr</span> <span class=o>=</span> <span class=s2>&quot;deviceAspectRatio&quot;</span>

    <span class=c1># Give VRay a helping hand as it is slightly different from the rest</span>
    <span class=k>if</span> <span class=n>current_renderer</span> <span class=o>==</span> <span class=s2>&quot;vray&quot;</span><span class=p>:</span>
        <span class=n>aspect_ratio_attr</span> <span class=o>=</span> <span class=s2>&quot;aspectRatio&quot;</span>
        <span class=n>vray_node</span> <span class=o>=</span> <span class=s2>&quot;vraySettings&quot;</span>
        <span class=k>if</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objExists</span><span class=p>(</span><span class=n>vray_node</span><span class=p>):</span>
            <span class=n>control_node</span> <span class=o>=</span> <span class=n>vray_node</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;Can&#39;t set VRay resolution because there is no node &quot;</span>
                      <span class=s2>&quot;named: `</span><span class=si>%s</span><span class=s2>`&quot;</span> <span class=o>%</span> <span class=n>vray_node</span><span class=p>)</span>

    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&quot;Setting scene resolution to: </span><span class=si>%s</span><span class=s2> x </span><span class=si>%s</span><span class=s2>&quot;</span> <span class=o>%</span> <span class=p>(</span><span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>))</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>control_node</span><span class=si>}</span><span class=s2>.width&quot;</span><span class=p>,</span> <span class=n>width</span><span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>control_node</span><span class=si>}</span><span class=s2>.height&quot;</span><span class=p>,</span> <span class=n>height</span><span class=p>)</span>

    <span class=n>device_aspect_ratio</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=p>(</span>
            <span class=p>(</span><span class=nb>float</span><span class=p>(</span><span class=n>width</span><span class=p>)</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>height</span><span class=p>))</span> <span class=o>*</span> <span class=nb>float</span><span class=p>(</span><span class=n>pixel_aspect</span><span class=p>)</span>
    <span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>control_node</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>aspect_ratio_attr</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>device_aspect_ratio</span><span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>setAttr</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>control_node</span><span class=si>}</span><span class=s2>.pixelAspect&quot;</span><span class=p>,</span> <span class=n>pixel_aspect</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.set_scene_units class="doc doc-heading"> <code class="highlight language-python"><span class=n>set_scene_units</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set the Maya scene units</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4703</span>
<span class=normal>4704</span>
<span class=normal>4705</span>
<span class=normal>4706</span>
<span class=normal>4707</span>
<span class=normal>4708</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>set_scene_units</span><span class=p>(</span><span class=n>project_settings</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set the Maya scene units&quot;&quot;&quot;</span>
    <span class=n>linear_unit</span><span class=p>,</span> <span class=n>angular_unit</span> <span class=o>=</span> <span class=n>get_scene_units_settings</span><span class=p>(</span>
        <span class=n>project_settings</span><span class=o>=</span><span class=n>project_settings</span>
    <span class=p>)</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>currentUnit</span><span class=p>(</span><span class=n>linear</span><span class=o>=</span><span class=n>linear_unit</span><span class=p>,</span> <span class=n>angle</span><span class=o>=</span><span class=n>angular_unit</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.shader class="doc doc-heading"> <code class="highlight language-python"><span class=n>shader</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>shadingEngine</span><span class=o>=</span><span class=s1>&#39;initialShadingGroup&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Assign a shader to nodes during the context</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1098</span>
<span class=normal>1099</span>
<span class=normal>1100</span>
<span class=normal>1101</span>
<span class=normal>1102</span>
<span class=normal>1103</span>
<span class=normal>1104</span>
<span class=normal>1105</span>
<span class=normal>1106</span>
<span class=normal>1107</span>
<span class=normal>1108</span>
<span class=normal>1109</span>
<span class=normal>1110</span>
<span class=normal>1111</span>
<span class=normal>1112</span>
<span class=normal>1113</span>
<span class=normal>1114</span>
<span class=normal>1115</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>shader</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>shadingEngine</span><span class=o>=</span><span class=s2>&quot;initialShadingGroup&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Assign a shader to nodes during the context&quot;&quot;&quot;</span>

    <span class=n>shapes</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ls</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>dag</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>objectsOnly</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>shapes</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>long</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>original</span> <span class=o>=</span> <span class=n>get_shader_assignments_from_shapes</span><span class=p>(</span><span class=n>shapes</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=c1># Assign override shader</span>
        <span class=k>if</span> <span class=n>shapes</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>shapes</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>forceElement</span><span class=o>=</span><span class=n>shadingEngine</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>

        <span class=c1># Assign original shaders</span>
        <span class=k>for</span> <span class=n>sg</span><span class=p>,</span> <span class=n>members</span> <span class=ow>in</span> <span class=n>original</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=n>members</span><span class=p>:</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>sets</span><span class=p>(</span><span class=n>members</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>forceElement</span><span class=o>=</span><span class=n>sg</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.strip_namespace class="doc doc-heading"> <code class="highlight language-python"><span class=n>strip_namespace</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>namespace</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Strip given namespace from node path.</p> <p>The namespace will only be stripped from names if it starts with that namespace. If the namespace occurs within another namespace it's not removed.</p> <p><span class=doc-section-title>Examples:</span></p> <div class=highlight><pre><span></span><code><span class=gp>&gt;&gt;&gt; </span><span class=n>strip_namespace</span><span class=p>(</span><span class=s2>&quot;namespace:node&quot;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s2>&quot;namespace:&quot;</span><span class=p>)</span>
<span class=go>&quot;node&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>strip_namespace</span><span class=p>(</span><span class=s2>&quot;hello:world:node&quot;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s2>&quot;hello:world&quot;</span><span class=p>)</span>
<span class=go>&quot;node&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>strip_namespace</span><span class=p>(</span><span class=s2>&quot;hello:world:node&quot;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s2>&quot;hello&quot;</span><span class=p>)</span>
<span class=go>&quot;world:node&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>strip_namespace</span><span class=p>(</span><span class=s2>&quot;hello:world:node&quot;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s2>&quot;world&quot;</span><span class=p>)</span>
<span class=go>&quot;hello:world:node&quot;</span>
<span class=gp>&gt;&gt;&gt; </span><span class=n>strip_namespace</span><span class=p>(</span><span class=s2>&quot;ns:group|ns:node&quot;</span><span class=p>,</span> <span class=n>namespace</span><span class=o>=</span><span class=s2>&quot;ns&quot;</span><span class=p>)</span>
<span class=go>&quot;group|node&quot;</span>
</code></pre></div> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>str</code></td> <td> </td> <td> <div class=doc-md-description> <p>Node name without given starting namespace.</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>402</span>
<span class=normal>403</span>
<span class=normal>404</span>
<span class=normal>405</span>
<span class=normal>406</span>
<span class=normal>407</span>
<span class=normal>408</span>
<span class=normal>409</span>
<span class=normal>410</span>
<span class=normal>411</span>
<span class=normal>412</span>
<span class=normal>413</span>
<span class=normal>414</span>
<span class=normal>415</span>
<span class=normal>416</span>
<span class=normal>417</span>
<span class=normal>418</span>
<span class=normal>419</span>
<span class=normal>420</span>
<span class=normal>421</span>
<span class=normal>422</span>
<span class=normal>423</span>
<span class=normal>424</span>
<span class=normal>425</span>
<span class=normal>426</span>
<span class=normal>427</span>
<span class=normal>428</span>
<span class=normal>429</span>
<span class=normal>430</span>
<span class=normal>431</span>
<span class=normal>432</span>
<span class=normal>433</span>
<span class=normal>434</span>
<span class=normal>435</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>strip_namespace</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>namespace</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Strip given namespace from node path.</span>

<span class=sd>    The namespace will only be stripped from names</span>
<span class=sd>    if it starts with that namespace. If the namespace</span>
<span class=sd>    occurs within another namespace it&#39;s not removed.</span>

<span class=sd>    Examples:</span>
<span class=sd>        &gt;&gt;&gt; strip_namespace(&quot;namespace:node&quot;, namespace=&quot;namespace:&quot;)</span>
<span class=sd>        &quot;node&quot;</span>
<span class=sd>        &gt;&gt;&gt; strip_namespace(&quot;hello:world:node&quot;, namespace=&quot;hello:world&quot;)</span>
<span class=sd>        &quot;node&quot;</span>
<span class=sd>        &gt;&gt;&gt; strip_namespace(&quot;hello:world:node&quot;, namespace=&quot;hello&quot;)</span>
<span class=sd>        &quot;world:node&quot;</span>
<span class=sd>        &gt;&gt;&gt; strip_namespace(&quot;hello:world:node&quot;, namespace=&quot;world&quot;)</span>
<span class=sd>        &quot;hello:world:node&quot;</span>
<span class=sd>        &gt;&gt;&gt; strip_namespace(&quot;ns:group|ns:node&quot;, namespace=&quot;ns&quot;)</span>
<span class=sd>        &quot;group|node&quot;</span>

<span class=sd>    Returns:</span>
<span class=sd>        str: Node name without given starting namespace.</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=c1># Ensure namespace ends with `:`</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>namespace</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>):</span>
        <span class=n>namespace</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>:&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>namespace</span><span class=p>)</span>

    <span class=c1># The long path for a node can also have the namespace</span>
    <span class=c1># in its parents so we need to remove it from each</span>
    <span class=k>return</span> <span class=s2>&quot;|&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
        <span class=n>name</span><span class=p>[</span><span class=nb>len</span><span class=p>(</span><span class=n>namespace</span><span class=p>):]</span> <span class=k>if</span> <span class=n>name</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=n>namespace</span><span class=p>)</span> <span class=k>else</span> <span class=n>name</span>
        <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>node</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;|&quot;</span><span class=p>)</span>
    <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.suspended_refresh class="doc doc-heading"> <code class="highlight language-python"><span class=n>suspended_refresh</span><span class=p>(</span><span class=n>suspend</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Suspend viewport refreshes</p> <p>cmds.ogs(pause=True) is a toggle so we can't pass False.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>suspended_refresh</span><span class=p>(</span><span class=n>suspend</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Suspend viewport refreshes</span>

<span class=sd>    cmds.ogs(pause=True) is a toggle so we can&#39;t pass False.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>if</span> <span class=n>IS_HEADLESS</span><span class=p>:</span>
        <span class=k>yield</span>
        <span class=k>return</span>

    <span class=n>original_state</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>ogs</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>pause</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>suspend</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>original_state</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>ogs</span><span class=p>(</span><span class=n>pause</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>suspend</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>original_state</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>ogs</span><span class=p>(</span><span class=n>pause</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.tool class="doc doc-heading"> <code class="highlight language-python"><span class=n>tool</span><span class=p>(</span><span class=n>context</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Set a tool context during the context manager.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1251</span>
<span class=normal>1252</span>
<span class=normal>1253</span>
<span class=normal>1254</span>
<span class=normal>1255</span>
<span class=normal>1256</span>
<span class=normal>1257</span>
<span class=normal>1258</span>
<span class=normal>1259</span>
<span class=normal>1260</span>
<span class=normal>1261</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>tool</span><span class=p>(</span><span class=n>context</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Set a tool context during the context manager.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>original</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>currentCtx</span><span class=p>()</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setToolTo</span><span class=p>(</span><span class=n>context</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>setToolTo</span><span class=p>(</span><span class=n>original</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.undo_chunk class="doc doc-heading"> <code class="highlight language-python"><span class=n>undo_chunk</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Open a undo chunk during context.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>859</span>
<span class=normal>860</span>
<span class=normal>861</span>
<span class=normal>862</span>
<span class=normal>863</span>
<span class=normal>864</span>
<span class=normal>865</span>
<span class=normal>866</span>
<span class=normal>867</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>undo_chunk</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Open a undo chunk during context.&quot;&quot;&quot;</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>undoInfo</span><span class=p>(</span><span class=n>openChunk</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>undoInfo</span><span class=p>(</span><span class=n>closeChunk</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.unique_namespace class="doc doc-heading"> <code class="highlight language-python"><span class=n>unique_namespace</span><span class=p>(</span><span class=n>namespace</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%02d</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>prefix</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return unique namespace</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>namespace</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Name of namespace to consider</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>format</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Formatting of the given iteration number</p> </div> </td> <td> <code>&#39;%02d&#39;</code> </td> </tr> <tr class=doc-section-item> <td> <code>suffix</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>Only consider namespaces with this suffix.</p> </div> </td> <td> <code>&#39;&#39;</code> </td> </tr> </tbody> </table> <blockquote> <blockquote> <blockquote> <p>unique_namespace("bar")</p> </blockquote> </blockquote> </blockquote> <h3 id=client.ayon_maya.api.lib.unique_namespace--bar01>bar01</h3> <blockquote> <blockquote> <blockquote> <p>unique_namespace(":hello")</p> </blockquote> </blockquote> </blockquote> <h3 id=client.ayon_maya.api.lib.unique_namespace--hello01>:hello01</h3> <blockquote> <blockquote> <blockquote> <p>unique_namespace("bar:", suffix="_NS")</p> </blockquote> </blockquote> </blockquote> <h3 id=client.ayon_maya.api.lib.unique_namespace--bar01_ns>bar01_NS:</h3> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>476</span>
<span class=normal>477</span>
<span class=normal>478</span>
<span class=normal>479</span>
<span class=normal>480</span>
<span class=normal>481</span>
<span class=normal>482</span>
<span class=normal>483</span>
<span class=normal>484</span>
<span class=normal>485</span>
<span class=normal>486</span>
<span class=normal>487</span>
<span class=normal>488</span>
<span class=normal>489</span>
<span class=normal>490</span>
<span class=normal>491</span>
<span class=normal>492</span>
<span class=normal>493</span>
<span class=normal>494</span>
<span class=normal>495</span>
<span class=normal>496</span>
<span class=normal>497</span>
<span class=normal>498</span>
<span class=normal>499</span>
<span class=normal>500</span>
<span class=normal>501</span>
<span class=normal>502</span>
<span class=normal>503</span>
<span class=normal>504</span>
<span class=normal>505</span>
<span class=normal>506</span>
<span class=normal>507</span>
<span class=normal>508</span>
<span class=normal>509</span>
<span class=normal>510</span>
<span class=normal>511</span>
<span class=normal>512</span>
<span class=normal>513</span>
<span class=normal>514</span>
<span class=normal>515</span>
<span class=normal>516</span>
<span class=normal>517</span>
<span class=normal>518</span>
<span class=normal>519</span>
<span class=normal>520</span>
<span class=normal>521</span>
<span class=normal>522</span>
<span class=normal>523</span>
<span class=normal>524</span>
<span class=normal>525</span>
<span class=normal>526</span>
<span class=normal>527</span>
<span class=normal>528</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>unique_namespace</span><span class=p>(</span><span class=n>namespace</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&quot;</span><span class=si>%02d</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>prefix</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>,</span> <span class=n>suffix</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Return unique namespace</span>

<span class=sd>    Arguments:</span>
<span class=sd>        namespace (str): Name of namespace to consider</span>
<span class=sd>        format (str, optional): Formatting of the given iteration number</span>
<span class=sd>        suffix (str, optional): Only consider namespaces with this suffix.</span>

<span class=sd>    &gt;&gt;&gt; unique_namespace(&quot;bar&quot;)</span>
<span class=sd>    # bar01</span>
<span class=sd>    &gt;&gt;&gt; unique_namespace(&quot;:hello&quot;)</span>
<span class=sd>    # :hello01</span>
<span class=sd>    &gt;&gt;&gt; unique_namespace(&quot;bar:&quot;, suffix=&quot;_NS&quot;)</span>
<span class=sd>    # bar01_NS:</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=k>def</span><span class=w> </span><span class=nf>current_namespace</span><span class=p>():</span>
        <span class=n>current</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>namespaceInfo</span><span class=p>(</span><span class=n>currentNamespace</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
                                     <span class=n>absoluteName</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
        <span class=c1># When inside a namespace Maya adds no trailing :</span>
        <span class=k>if</span> <span class=ow>not</span> <span class=n>current</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>):</span>
            <span class=n>current</span> <span class=o>+=</span> <span class=s2>&quot;:&quot;</span>
        <span class=k>return</span> <span class=n>current</span>

    <span class=c1># Always check against the absolute namespace root</span>
    <span class=c1># There&#39;s no clash with :x if we&#39;re defining namespace :a:x</span>
    <span class=n>ROOT</span> <span class=o>=</span> <span class=s2>&quot;:&quot;</span> <span class=k>if</span> <span class=n>namespace</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)</span> <span class=k>else</span> <span class=n>current_namespace</span><span class=p>()</span>

    <span class=c1># Strip trailing `:` tokens since we might want to add a suffix</span>
    <span class=n>start</span> <span class=o>=</span> <span class=s2>&quot;:&quot;</span> <span class=k>if</span> <span class=n>namespace</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
    <span class=n>end</span> <span class=o>=</span> <span class=s2>&quot;:&quot;</span> <span class=k>if</span> <span class=n>namespace</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
    <span class=n>namespace</span> <span class=o>=</span> <span class=n>namespace</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)</span>
    <span class=k>if</span> <span class=s2>&quot;:&quot;</span> <span class=ow>in</span> <span class=n>namespace</span><span class=p>:</span>
        <span class=c1># Split off any nesting that we don&#39;t uniqify anyway.</span>
        <span class=n>parents</span><span class=p>,</span> <span class=n>namespace</span> <span class=o>=</span> <span class=n>namespace</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
        <span class=n>start</span> <span class=o>+=</span> <span class=n>parents</span> <span class=o>+</span> <span class=s2>&quot;:&quot;</span>
        <span class=n>ROOT</span> <span class=o>+=</span> <span class=n>start</span>

    <span class=k>def</span><span class=w> </span><span class=nf>exists</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
        <span class=c1># Check for clash with nodes and namespaces</span>
        <span class=n>fullpath</span> <span class=o>=</span> <span class=n>ROOT</span> <span class=o>+</span> <span class=n>n</span>
        <span class=k>return</span> <span class=n>cmds</span><span class=o>.</span><span class=n>objExists</span><span class=p>(</span><span class=n>fullpath</span><span class=p>)</span> <span class=ow>or</span> <span class=n>cmds</span><span class=o>.</span><span class=n>namespace</span><span class=p>(</span><span class=n>exists</span><span class=o>=</span><span class=n>fullpath</span><span class=p>)</span>

    <span class=n>iteration</span> <span class=o>=</span> <span class=mi>1</span>
    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
        <span class=n>nr_namespace</span> <span class=o>=</span> <span class=n>namespace</span> <span class=o>+</span> <span class=nb>format</span> <span class=o>%</span> <span class=n>iteration</span>
        <span class=n>unique</span> <span class=o>=</span> <span class=n>prefix</span> <span class=o>+</span> <span class=n>nr_namespace</span> <span class=o>+</span> <span class=n>suffix</span>

        <span class=k>if</span> <span class=ow>not</span> <span class=n>exists</span><span class=p>(</span><span class=n>unique</span><span class=p>):</span>
            <span class=k>return</span> <span class=n>start</span> <span class=o>+</span> <span class=n>unique</span> <span class=o>+</span> <span class=n>end</span>

        <span class=n>iteration</span> <span class=o>+=</span> <span class=mi>1</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.unlocked class="doc doc-heading"> <code class="highlight language-python"><span class=n>unlocked</span><span class=p>(</span><span class=n>node</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Unlock a node for the duration of the context.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The name of the node to unlock.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>unlocked</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Unlock a node for the duration of the context.</span>

<span class=sd>    Args:</span>
<span class=sd>        node (str): The name of the node to unlock.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>has_locked</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>lockNode</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>lock</span><span class=o>=</span><span class=kc>True</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>cmds</span><span class=o>.</span><span class=n>lockNode</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>lock</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>

    <span class=k>try</span><span class=p>:</span>
        <span class=k>yield</span>

    <span class=k>finally</span><span class=p>:</span>
        <span class=n>cmds</span><span class=o>.</span><span class=n>lockNode</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>lock</span><span class=o>=</span><span class=n>has_locked</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.update_content_on_context_change class="doc doc-heading"> <code class="highlight language-python"><span class=n>update_content_on_context_change</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>This will update scene content to match new folder on context change</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3380</span>
<span class=normal>3381</span>
<span class=normal>3382</span>
<span class=normal>3383</span>
<span class=normal>3384</span>
<span class=normal>3385</span>
<span class=normal>3386</span>
<span class=normal>3387</span>
<span class=normal>3388</span>
<span class=normal>3389</span>
<span class=normal>3390</span>
<span class=normal>3391</span>
<span class=normal>3392</span>
<span class=normal>3393</span>
<span class=normal>3394</span>
<span class=normal>3395</span>
<span class=normal>3396</span>
<span class=normal>3397</span>
<span class=normal>3398</span>
<span class=normal>3399</span>
<span class=normal>3400</span>
<span class=normal>3401</span>
<span class=normal>3402</span>
<span class=normal>3403</span>
<span class=normal>3404</span>
<span class=normal>3405</span>
<span class=normal>3406</span>
<span class=normal>3407</span>
<span class=normal>3408</span>
<span class=normal>3409</span>
<span class=normal>3410</span>
<span class=normal>3411</span>
<span class=normal>3412</span>
<span class=normal>3413</span>
<span class=normal>3414</span>
<span class=normal>3415</span>
<span class=normal>3416</span>
<span class=normal>3417</span>
<span class=normal>3418</span>
<span class=normal>3419</span>
<span class=normal>3420</span>
<span class=normal>3421</span>
<span class=normal>3422</span>
<span class=normal>3423</span>
<span class=normal>3424</span>
<span class=normal>3425</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>update_content_on_context_change</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    This will update scene content to match new folder on context change</span>
<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>host</span> <span class=o>=</span> <span class=n>registered_host</span><span class=p>()</span>
    <span class=n>create_context</span> <span class=o>=</span> <span class=n>CreateContext</span><span class=p>(</span><span class=n>host</span><span class=p>,</span> <span class=n>discover_publish_plugins</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
    <span class=n>task_entity</span> <span class=o>=</span> <span class=n>create_context</span><span class=o>.</span><span class=n>get_current_task_entity</span><span class=p>()</span>

    <span class=n>instance_values</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;folderPath&quot;</span><span class=p>:</span> <span class=n>create_context</span><span class=o>.</span><span class=n>get_current_folder_path</span><span class=p>(),</span>
        <span class=s2>&quot;task&quot;</span><span class=p>:</span> <span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;name&quot;</span><span class=p>],</span>
    <span class=p>}</span>
    <span class=n>creator_attribute_values</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;frameStart&quot;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;frameStart&quot;</span><span class=p>]),</span>
        <span class=s2>&quot;frameEnd&quot;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;frameEnd&quot;</span><span class=p>]),</span>
        <span class=s2>&quot;handleStart&quot;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;handleStart&quot;</span><span class=p>]),</span>
        <span class=s2>&quot;handleEnd&quot;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>task_entity</span><span class=p>[</span><span class=s2>&quot;attrib&quot;</span><span class=p>][</span><span class=s2>&quot;handleEnd&quot;</span><span class=p>]),</span>
    <span class=p>}</span>

    <span class=n>has_changes</span> <span class=o>=</span> <span class=kc>False</span>
    <span class=k>for</span> <span class=n>instance</span> <span class=ow>in</span> <span class=n>create_context</span><span class=o>.</span><span class=n>instances</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>instance_values</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>instance</span> <span class=ow>or</span> <span class=n>instance</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>==</span> <span class=n>value</span><span class=p>:</span>
                <span class=k>continue</span>

            <span class=c1># Update instance value</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Updating </span><span class=si>{</span><span class=n>instance</span><span class=o>.</span><span class=n>product_name</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2> to: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=n>instance</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
            <span class=n>has_changes</span> <span class=o>=</span> <span class=kc>True</span>

        <span class=n>creator_attributes</span> <span class=o>=</span> <span class=n>instance</span><span class=o>.</span><span class=n>creator_attributes</span>
        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>creator_attribute_values</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
            <span class=k>if</span> <span class=p>(</span>
                    <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>creator_attributes</span>
                    <span class=ow>or</span> <span class=n>creator_attributes</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>==</span> <span class=n>value</span>
            <span class=p>):</span>
                <span class=k>continue</span>

            <span class=c1># Update instance creator attribute value</span>
            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Updating </span><span class=si>{</span><span class=n>instance</span><span class=o>.</span><span class=n>product_name</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2> to: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
            <span class=n>creator_attributes</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
            <span class=n>has_changes</span> <span class=o>=</span> <span class=kc>True</span>

    <span class=k>if</span> <span class=n>has_changes</span><span class=p>:</span>
        <span class=n>create_context</span><span class=o>.</span><span class=n>save_changes</span><span class=p>()</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.validate_fps class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_fps</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Validate current scene FPS and show pop-up when it is incorrect</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>bool</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>2895</span>
<span class=normal>2896</span>
<span class=normal>2897</span>
<span class=normal>2898</span>
<span class=normal>2899</span>
<span class=normal>2900</span>
<span class=normal>2901</span>
<span class=normal>2902</span>
<span class=normal>2903</span>
<span class=normal>2904</span>
<span class=normal>2905</span>
<span class=normal>2906</span>
<span class=normal>2907</span>
<span class=normal>2908</span>
<span class=normal>2909</span>
<span class=normal>2910</span>
<span class=normal>2911</span>
<span class=normal>2912</span>
<span class=normal>2913</span>
<span class=normal>2914</span>
<span class=normal>2915</span>
<span class=normal>2916</span>
<span class=normal>2917</span>
<span class=normal>2918</span>
<span class=normal>2919</span>
<span class=normal>2920</span>
<span class=normal>2921</span>
<span class=normal>2922</span>
<span class=normal>2923</span>
<span class=normal>2924</span>
<span class=normal>2925</span>
<span class=normal>2926</span>
<span class=normal>2927</span>
<span class=normal>2928</span>
<span class=normal>2929</span>
<span class=normal>2930</span>
<span class=normal>2931</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>validate_fps</span><span class=p>():</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate current scene FPS and show pop-up when it is incorrect</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool</span>

<span class=sd>    &quot;&quot;&quot;</span>

    <span class=n>expected_fps</span> <span class=o>=</span> <span class=n>get_fps_for_current_context</span><span class=p>()</span>
    <span class=n>current_fps</span> <span class=o>=</span> <span class=n>mel</span><span class=o>.</span><span class=n>eval</span><span class=p>(</span><span class=s2>&quot;currentTimeUnitToFPS()&quot;</span><span class=p>)</span>

    <span class=n>fps_match</span> <span class=o>=</span> <span class=n>current_fps</span> <span class=o>==</span> <span class=n>expected_fps</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>fps_match</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>IS_HEADLESS</span><span class=p>:</span>
        <span class=kn>from</span><span class=w> </span><span class=nn>ayon_core.tools.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>PopupUpdateKeys</span>

        <span class=n>parent</span> <span class=o>=</span> <span class=n>get_main_window</span><span class=p>()</span>

        <span class=n>dialog</span> <span class=o>=</span> <span class=n>PopupUpdateKeys</span><span class=p>(</span><span class=n>parent</span><span class=o>=</span><span class=n>parent</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>setModal</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>setWindowTitle</span><span class=p>(</span><span class=s2>&quot;Maya scene does not match project FPS&quot;</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>set_message</span><span class=p>(</span>
            <span class=s2>&quot;Scene </span><span class=si>{}</span><span class=s2> FPS does not match project </span><span class=si>{}</span><span class=s2> FPS&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
                <span class=n>current_fps</span><span class=p>,</span> <span class=n>expected_fps</span>
            <span class=p>)</span>
        <span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>set_button_text</span><span class=p>(</span><span class=s2>&quot;Fix&quot;</span><span class=p>)</span>

        <span class=c1># Set new text for button (add optional argument for the popup?)</span>
        <span class=k>def</span><span class=w> </span><span class=nf>on_click</span><span class=p>(</span><span class=n>update</span><span class=p>):</span>
            <span class=n>set_scene_fps</span><span class=p>(</span><span class=n>expected_fps</span><span class=p>,</span> <span class=n>update</span><span class=p>)</span>

        <span class=n>dialog</span><span class=o>.</span><span class=n>on_clicked_state</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>on_click</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>

        <span class=k>return</span> <span class=kc>False</span>

    <span class=k>return</span> <span class=n>fps_match</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.validate_scene_units class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_scene_units</span><span class=p>()</span></code> </h2> <div class="doc doc-contents "> <p>Validate whether scene units match AYON settings</p> <p>If not headless and it does not match, a pop-up dialog is shown to the user with a choice to fix it automatically.</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td><code>bool</code></td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>Whether Maya scene units matches preferences from AYON settings</p> </div> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>4711</span>
<span class=normal>4712</span>
<span class=normal>4713</span>
<span class=normal>4714</span>
<span class=normal>4715</span>
<span class=normal>4716</span>
<span class=normal>4717</span>
<span class=normal>4718</span>
<span class=normal>4719</span>
<span class=normal>4720</span>
<span class=normal>4721</span>
<span class=normal>4722</span>
<span class=normal>4723</span>
<span class=normal>4724</span>
<span class=normal>4725</span>
<span class=normal>4726</span>
<span class=normal>4727</span>
<span class=normal>4728</span>
<span class=normal>4729</span>
<span class=normal>4730</span>
<span class=normal>4731</span>
<span class=normal>4732</span>
<span class=normal>4733</span>
<span class=normal>4734</span>
<span class=normal>4735</span>
<span class=normal>4736</span>
<span class=normal>4737</span>
<span class=normal>4738</span>
<span class=normal>4739</span>
<span class=normal>4740</span>
<span class=normal>4741</span>
<span class=normal>4742</span>
<span class=normal>4743</span>
<span class=normal>4744</span>
<span class=normal>4745</span>
<span class=normal>4746</span>
<span class=normal>4747</span>
<span class=normal>4748</span>
<span class=normal>4749</span>
<span class=normal>4750</span>
<span class=normal>4751</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>validate_scene_units</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Validate whether scene units match AYON settings</span>

<span class=sd>    If not headless and it does not match, a pop-up dialog is</span>
<span class=sd>    shown to the user with a choice to fix it automatically.</span>

<span class=sd>    Returns:</span>
<span class=sd>        bool: Whether Maya scene units matches preferences from AYON settings</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>linear_unit</span><span class=p>,</span> <span class=n>angular_unit</span> <span class=o>=</span> <span class=n>get_scene_units_settings</span><span class=p>()</span>
    <span class=n>current_linear_unit</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>currentUnit</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>linear</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>current_angular_unit</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>currentUnit</span><span class=p>(</span><span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>angle</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
    <span class=n>unit_match</span> <span class=o>=</span> <span class=p>(</span>
        <span class=n>current_linear_unit</span> <span class=o>==</span> <span class=n>linear_unit</span> <span class=ow>and</span>
        <span class=n>current_angular_unit</span> <span class=o>==</span> <span class=n>angular_unit</span>
    <span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>unit_match</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>IS_HEADLESS</span><span class=p>:</span>
        <span class=kn>from</span><span class=w> </span><span class=nn>ayon_core.tools.utils</span><span class=w> </span><span class=kn>import</span> <span class=n>PopupUpdateKeys</span>

        <span class=n>parent</span> <span class=o>=</span> <span class=n>get_main_window</span><span class=p>()</span>

        <span class=n>dialog</span> <span class=o>=</span> <span class=n>PopupUpdateKeys</span><span class=p>(</span><span class=n>parent</span><span class=o>=</span><span class=n>parent</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>setModal</span><span class=p>(</span><span class=kc>True</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>setWindowTitle</span><span class=p>(</span><span class=s2>&quot;Maya scene does not match project scene units&quot;</span><span class=p>)</span>
        <span class=n>message</span> <span class=o>=</span> <span class=p>(</span>
            <span class=sa>f</span><span class=s2>&quot;Scene units (</span><span class=si>{</span><span class=n>current_linear_unit</span><span class=si>}</span><span class=s2>,&quot;</span>
            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>current_angular_unit</span><span class=si>}</span><span class=s2>) does not match &quot;</span>
            <span class=sa>f</span><span class=s2>&quot;project scene units (</span><span class=si>{</span><span class=n>linear_unit</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>angular_unit</span><span class=si>}</span><span class=s2>)&quot;</span>
        <span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>set_message</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>set_button_text</span><span class=p>(</span><span class=s2>&quot;Fix&quot;</span><span class=p>)</span>

        <span class=c1># Set new text for button (add optional argument for the popup?)</span>
        <span class=k>def</span><span class=w> </span><span class=nf>on_click</span><span class=p>():</span>
            <span class=n>set_scene_units</span><span class=p>()</span>

        <span class=n>dialog</span><span class=o>.</span><span class=n>on_clicked_state</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>on_click</span><span class=p>)</span>
        <span class=n>dialog</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>

        <span class=k>return</span> <span class=kc>False</span>
    <span class=k>return</span> <span class=n>unit_match</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.viewport_default_options class="doc doc-heading"> <code class="highlight language-python"><span class=n>viewport_default_options</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>preset</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Context manager used by <code>render_capture_preset</code>.</p> <p>We need to explicitly enable some viewport changes so the viewport is refreshed ahead of playblasting.</p> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>345</span>
<span class=normal>346</span>
<span class=normal>347</span>
<span class=normal>348</span>
<span class=normal>349</span>
<span class=normal>350</span>
<span class=normal>351</span>
<span class=normal>352</span>
<span class=normal>353</span>
<span class=normal>354</span>
<span class=normal>355</span>
<span class=normal>356</span>
<span class=normal>357</span>
<span class=normal>358</span>
<span class=normal>359</span>
<span class=normal>360</span>
<span class=normal>361</span>
<span class=normal>362</span>
<span class=normal>363</span>
<span class=normal>364</span>
<span class=normal>365</span>
<span class=normal>366</span>
<span class=normal>367</span>
<span class=normal>368</span>
<span class=normal>369</span>
<span class=normal>370</span>
<span class=normal>371</span>
<span class=normal>372</span>
<span class=normal>373</span>
<span class=normal>374</span>
<span class=normal>375</span>
<span class=normal>376</span>
<span class=normal>377</span>
<span class=normal>378</span>
<span class=normal>379</span></pre></div></td><td class=code><div><pre><span></span><code><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
<span class=k>def</span><span class=w> </span><span class=nf>viewport_default_options</span><span class=p>(</span><span class=n>panel</span><span class=p>,</span> <span class=n>preset</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Context manager used by `render_capture_preset`.</span>

<span class=sd>    We need to explicitly enable some viewport changes so the viewport is</span>
<span class=sd>    refreshed ahead of playblasting.</span>

<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># TODO: Clarify in the docstring WHY we need to set it ahead of</span>
    <span class=c1>#  playblasting. What issues does it solve?</span>
    <span class=n>viewport_defaults</span> <span class=o>=</span> <span class=p>{}</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>keys</span> <span class=o>=</span> <span class=p>[</span>
            <span class=s2>&quot;useDefaultMaterial&quot;</span><span class=p>,</span>
            <span class=s2>&quot;wireframeOnShaded&quot;</span><span class=p>,</span>
            <span class=s2>&quot;xray&quot;</span><span class=p>,</span>
            <span class=s2>&quot;jointXray&quot;</span><span class=p>,</span>
            <span class=s2>&quot;backfaceCulling&quot;</span><span class=p>,</span>
            <span class=s2>&quot;textures&quot;</span>
        <span class=p>]</span>
        <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>keys</span><span class=p>:</span>
            <span class=n>viewport_defaults</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>cmds</span><span class=o>.</span><span class=n>modelEditor</span><span class=p>(</span>
                <span class=n>panel</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
            <span class=p>)</span>
            <span class=k>if</span> <span class=n>preset</span><span class=p>[</span><span class=s2>&quot;viewport_options&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>):</span>
                <span class=n>cmds</span><span class=o>.</span><span class=n>modelEditor</span><span class=p>(</span>
                    <span class=n>panel</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=p>{</span><span class=n>key</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
                <span class=p>)</span>
        <span class=k>yield</span>
    <span class=k>finally</span><span class=p>:</span>
        <span class=c1># Restoring viewport options.</span>
        <span class=k>if</span> <span class=n>viewport_defaults</span><span class=p>:</span>
            <span class=n>cmds</span><span class=o>.</span><span class=n>modelEditor</span><span class=p>(</span>
                <span class=n>panel</span><span class=p>,</span> <span class=n>edit</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=o>**</span><span class=n>viewport_defaults</span>
            <span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=client.ayon_maya.api.lib.write_xgen_file class="doc doc-heading"> <code class="highlight language-python"><span class=n>write_xgen_file</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>filepath</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Overwrites data in .xgen files.</p> <p>Quite naive approach to mainly overwrite "xgDataPath" and "xgProjectPath".</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=dict>dict</span></code> </td> <td> <div class=doc-md-description> <p>Dictionary of key, value. Key matches with xgen file.</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>For example</code> </td> <td> </td> <td> <div class=doc-md-description> <p>{"xgDataPath": "some/path"}</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>filepath</code> </td> <td> <code><span title=string>string</span></code> </td> <td> <div class=doc-md-description> <p>Absolute path of .xgen file.</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=mkdocstrings-source> <summary>Source code in <code>client/ayon_maya/api/lib.py</code></summary> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>3935</span>
<span class=normal>3936</span>
<span class=normal>3937</span>
<span class=normal>3938</span>
<span class=normal>3939</span>
<span class=normal>3940</span>
<span class=normal>3941</span>
<span class=normal>3942</span>
<span class=normal>3943</span>
<span class=normal>3944</span>
<span class=normal>3945</span>
<span class=normal>3946</span>
<span class=normal>3947</span>
<span class=normal>3948</span>
<span class=normal>3949</span>
<span class=normal>3950</span>
<span class=normal>3951</span>
<span class=normal>3952</span>
<span class=normal>3953</span>
<span class=normal>3954</span>
<span class=normal>3955</span>
<span class=normal>3956</span>
<span class=normal>3957</span>
<span class=normal>3958</span>
<span class=normal>3959</span>
<span class=normal>3960</span>
<span class=normal>3961</span>
<span class=normal>3962</span>
<span class=normal>3963</span></pre></div></td><td class=code><div><pre><span></span><code><span class=k>def</span><span class=w> </span><span class=nf>write_xgen_file</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>filepath</span><span class=p>):</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Overwrites data in .xgen files.</span>

<span class=sd>    Quite naive approach to mainly overwrite &quot;xgDataPath&quot; and &quot;xgProjectPath&quot;.</span>

<span class=sd>    Args:</span>
<span class=sd>        data (dict): Dictionary of key, value. Key matches with xgen file.</span>
<span class=sd>        For example:</span>
<span class=sd>            {&quot;xgDataPath&quot;: &quot;some/path&quot;}</span>
<span class=sd>        filepath (string): Absolute path of .xgen file.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=c1># Generate regex lookup for line to key basically</span>
    <span class=c1># match any of the keys in `\t{key}\t\t`</span>
    <span class=n>keys</span> <span class=o>=</span> <span class=s2>&quot;|&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>escape</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>data</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
    <span class=n>re_keys</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s2>&quot;^</span><span class=se>\t</span><span class=s2>(</span><span class=si>{}</span><span class=s2>)</span><span class=se>\t\t</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>keys</span><span class=p>))</span>

    <span class=n>lines</span> <span class=o>=</span> <span class=p>[]</span>
    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
            <span class=n>match</span> <span class=o>=</span> <span class=n>re_keys</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
            <span class=k>if</span> <span class=n>match</span><span class=p>:</span>
                <span class=n>key</span> <span class=o>=</span> <span class=n>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
                <span class=n>value</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
                <span class=n>line</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\t</span><span class=si>{}</span><span class=se>\t\t</span><span class=si>{}</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>

            <span class=n>lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>

    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filepath</span><span class=p>,</span> <span class=s2>&quot;w&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
        <span class=n>f</span><span class=o>.</span><span class=n>writelines</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span>
</code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../../../..", "features": ["navigation.sections", "navigation.path", "navigation.prune"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>